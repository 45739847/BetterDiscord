!function(e){var t={};function s(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=9)}([function(e,t){e.exports=require("electron")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("request")},function(e,t){e.exports=require("module")},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("rimraf")},function(e,t){e.exports=require("yauzl")},function(e,t){e.exports=require("mkdirp")},function(e,t,s){"use strict";s.r(t);var n={};s.r(n),s.d(n,"CustomCSS",(function(){return jt})),s.d(n,"WindowPrefs",(function(){return Ft})),s.d(n,"ClassNormalizer",(function(){return It})),s.d(n,"PublicServers",(function(){return es})),s.d(n,"VoiceDisconnect",(function(){return ts})),s.d(n,"TwentyFourHour",(function(){return ss})),s.d(n,"ColoredText",(function(){return ns})),s.d(n,"DarkMode",(function(){return is})),s.d(n,"HideGIFButton",(function(){return rs})),s.d(n,"HideGiftButton",(function(){return os})),s.d(n,"MinimalMode",(function(){return as})),s.d(n,"VoiceMode",(function(){return ls})),s.d(n,"EmoteModule",(function(){return wt})),s.d(n,"EmoteMenu",(function(){return vs})),s.d(n,"CopySelector",(function(){return ws})),s.d(n,"Debugger",(function(){return Cs})),s.d(n,"ReactDevTools",(function(){return Ms}));var i={local:!1,localPath:"",minified:!0,version:"0.6.0",branch:"stable",repo:"rauenzi",minSupportedVersion:"0.3.0",bdVersion:"1.0.0"},r=[{type:"category",id:"general",name:"General",collapsible:!0,settings:[{type:"switch",id:"download",value:!0},{type:"switch",id:"emoteMenu",value:!0},{type:"switch",id:"hideEmojiMenu",value:!1,enableWith:"emoteMenu"},{type:"switch",id:"showNames",value:!0},{type:"switch",id:"modifiers",value:!0},{type:"switch",id:"animateOnHover",value:!1}]},{type:"category",id:"categories",name:"Categories",collapsible:!0,settings:[{type:"switch",id:"twitchglobal",value:!0},{type:"switch",id:"twitchsubscriber",value:!1},{type:"switch",id:"frankerfacez",value:!0},{type:"switch",id:"bttv",value:!0}]}],o=[{type:"category",id:"general",collapsible:!0,settings:[{type:"switch",id:"emotes",value:!0},{type:"switch",id:"publicServers",value:!0},{type:"switch",id:"voiceDisconnect",value:!1},{type:"switch",id:"classNormalizer",value:!1},{type:"switch",id:"showToasts",value:!0}]},{type:"category",id:"appearance",collapsible:!0,settings:[{type:"switch",id:"twentyFourHour",value:!1},{type:"switch",id:"hideGiftButton",value:!1},{type:"switch",id:"hideGIFButton",value:!1},{type:"switch",id:"voiceMode",value:!1},{type:"switch",id:"minimalMode",value:!1},{type:"switch",id:"hideChannels",value:!1,enableWith:"minimalMode"},{type:"switch",id:"darkMode",value:!1},{type:"switch",id:"coloredText",value:!1}]},{type:"category",id:"addons",collapsible:!0,shown:!1,settings:[{type:"switch",id:"addonErrors",value:!0},{type:"switch",id:"autoReload",value:!0},{type:"dropdown",id:"editAction",value:"detached",options:[{value:"detached"},{value:"system"}]}]},{type:"category",id:"customcss",collapsible:!0,shown:!1,settings:[{type:"switch",id:"customcss",value:!0},{type:"switch",id:"liveUpdate",value:!1},{type:"dropdown",id:"openAction",value:"settings",options:[{value:"settings"},{value:"detached"},{value:"system"}]}]},{type:"category",id:"developer",collapsible:!0,shown:!1,settings:[{type:"switch",id:"debuggerHotkey",value:!1},{type:"switch",id:"copySelector",value:!1},{type:"switch",id:"reactDevTools",value:!1}]},{type:"category",id:"window",collapsible:!0,shown:!1,settings:[{type:"switch",id:"transparency",value:!1},{type:"switch",id:"frame",value:!1,hidden:!0}]}],a={Panels:{plugins:"Plugins",themes:"Themes",customcss:"Custom CSS"},Collections:{settings:{name:"Settings",general:{name:"General",emotes:{name:"Emote System",note:"Enables BD's emote system"},publicServers:{name:"Public Servers",note:"Display public servers button"},voiceDisconnect:{name:"Voice Disconnect",note:"Disconnect from voice server when closing Discord"},classNormalizer:{name:"Normalize Classes",note:"Adds stable classes to elements to help themes. (e.g. adds .da-channels to .channels-Ie2l6A)"},showToasts:{name:"Show Toasts",note:"Shows a small notification for important information"}},appearance:{name:"Appearance",voiceMode:{name:"Voice Mode",note:"Hides everything that isn't voice chat"},minimalMode:{name:"Minimal Mode",note:"Hide elements and reduce the size of elements"},twentyFourHour:{name:"24-Hour Timestamps",note:"Converts 12-hour timestamps to 24-hour format"},hideChannels:{name:"Hide Channels",note:"Hides channels when in minimal mode"},darkMode:{name:"Dark Mode",note:"Make certain elements dark by default"},coloredText:{name:"Colored Text",note:"Make text colour the same as role color"},hideGIFButton:{name:"Hide GIF Button",note:"Hides the GIF picker button in the textarea"},hideGiftButton:{name:"Hide Gift Button",note:"Hides the Nitro Gift button in the textarea"}},addons:{name:"Addon Manager",addonErrors:{name:"Show Addon Errors",note:"Shows a modal with plugin/theme errors"},autoReload:{name:"Automatic Loading",note:"Automatically loads, reloads, and unloads plugins and themes"},editAction:{name:"Edit Action",note:"Where plugins & themes appear when editing",options:{detached:"Detached Window",system:"System Editor"}}},customcss:{name:"Custom CSS",customcss:{name:"Custom CSS",note:"Enables the Custom CSS tab"},liveUpdate:{name:"Live Update",note:"Updates the css as you type"},startDetached:{name:"Start Detached",note:"Clicking the Custom CSS tab opens the editor in a separate window"},nativeOpen:{name:"Open in Native Editor",note:"Clicking the Custom CSS tab opens your custom css in your native editor"},openAction:{name:"Editor Location",note:"Where Custom CSS should open by default",options:{settings:"Settings Menu",detached:"Detached Window",system:"System Editor"}}},developer:{name:"Developer Settings",debuggerHotkey:{name:"Debugger Hotkey",note:"Allows activating debugger when pressing F8"},copySelector:{name:"Copy Selector",note:'Adds a "Copy Selector" option to context menus when developer mode is active'},reactDevTools:{name:"React Developer Tools",note:"Injects your local installation of React Developer Tools into Discord"}},window:{name:"Window Preferences",transparency:{name:"Enable Transparency",note:"Enables the main window to be see-through (requires restart)"},frame:{name:"Window Frame",note:"Adds the native os window frame to the main window"}}},emotes:{name:"Emotes",general:{name:"General",download:{name:"Download Emotes",note:"Download emotes whenever they are out of date"},emoteMenu:{name:"Emote Menu",note:"Show Twitch/Favourite emotes in emote menu"},hideEmojiMenu:{name:"Hide Emoji Menu",note:"Hides Discord's emoji menu when using emote menu"},autoCaps:{name:"Emote Autocapitalization",note:"Autocapitalize emote commands"},showNames:{name:"Show Names",note:"Show emote names on hover"},modifiers:{name:"Show Emote Modifiers",note:"Enable emote mods (flip, spin, pulse, spin2, spin3, 1spin, 2spin, 3spin, tr, bl, br, shake, shake2, shake3, flap)"},animateOnHover:{name:"Animate On Hover",note:"Only animate the emote modifiers on hover"}},categories:{name:"Categories",twitchglobal:{name:"Twitch Globals",note:"Show Twitch global emotes"},twitchsubscriber:{name:"Twitch Subscribers",note:"Show Twitch subscriber emotes"},frankerfacez:{name:"FrankerFaceZ",note:"Show emotes from FFZ"},bttv:{name:"BetterTTV",note:"Show emotes from BTTV"}}}},Addons:{title:"{{name}} v{{version}} by {{author}}",openFolder:"Open {{type}} Folder",reload:"Reload",addonSettings:"Settings",website:"Website",source:"Source",invite:"Support Server",donate:"Donate",patreon:"Patreon",name:"Name",author:"Author",version:"Version",added:"Date Added",modified:"Date Modified",search:"Search {{type}}",editAddon:"Edit",deleteAddon:"Delete",confirmDelete:"Are you sure you want to delete {{name}}?",confirmationText:"You have unsaved changes to {{name}}. Closing this window will lose all those changes.",enabled:"{{name}} has been enabled.",disabled:"{{name}} has been disabled.",couldNotEnable:"{{name}} could not be enabled.",couldNotDisable:"{{name}} could not be disabled.",couldNotStart:"{{name}} could not be started.",couldNotStop:"{{name}} could not be stopped.",settingsError:"Could not open settings for {{name}}",methodError:"{{method}} could not be fired.",unknownAuthor:"Unknown Author",noDescription:"Description not provided.",alreadyExists:"There is already a {{type}} with name {{name}}",alreadWatching:"Already watching  addons.",metaError:"META could not be parsed.",missingNameData:"META missing name data.",metaNotFound:"META was not found.",compileError:"Could not be compiled.",wasUnloaded:"{{name}} was unloaded.",blankSlateHeader:"You don't have any {{type}}!",blankSlateMessage:"Grab some from [this website]({{link}}) and add them to your {{type}} folder."},CustomCSS:{confirmationText:"You have unsaved changes to your Custom CSS. Closing this window will lose all those changes.",update:"Update",save:"Save",openNative:"Open in System Editor",openDetached:"Detach Window",settings:"Editor Settings",editorTitle:"Custom CSS Editor"},Developer:{copySelector:"Copy Selector"},Emotes:{loading:"Loading emotes in the background do not reload.",loaded:"All emotes successfully loaded.",clearEmotes:"Clear Emote Data",favoriteAction:"Favorite!"},PublicServers:{button:"public",join:"Join",joining:"Joining",joined:"Joined",loading:"Loading",loadMore:"Load More",notConnected:"Not Connected",connectionRequired:"You must connect your account in order to join servers.",connectionError:"Connection Error",connectionErrorMessage:"There was an error connecting to DiscordServers.com, it's possible their website/api is down. Please try again later.",pagination:"Page {{page}} of {{count}}",search:"Search",connect:"Connect",reconnect:"Reconnect",categories:"Categories",keywords:"Keywords",connection:"Connected as: {{username}}#{{discriminator}}",results:"Showing {{start}}-{{end}} of {{total}} results in {{category}}",query:"for {{query}}"},Modals:{confirmAction:"Are You Sure?",okay:"Okay",done:"Done",cancel:"Cancel",nevermind:"Nevermind",close:"Close",name:"Name",message:"Message",error:"Error",addonErrors:"Addon Errors",restartRequired:"Restart Required",restartNow:"Restart Now",restartLater:"Restart Later",additionalInfo:"Additional Info"},ReactDevTools:{notFound:"Extension Not Found",notFoundDetails:"Unable to find the React Developer Tools extension on your PC. Please install the extension on your local Chrome installation."},Sorting:{sortBy:"Sort By",order:"Order",ascending:"Ascending",descending:"Descending"},Startup:{notSupported:"Not Supported",versionMismatch:"BetterDiscord Injector v{{injector}} is not supported by the latest remote (v{{remote}}).\n\nPlease download the latest version from [GitHub](https://github.com/rauenzi/BetterDiscordApp/releases/latest)",incompatibleApp:"BetterDiscord does not work with {{app}}. Please uninstall one of them.",updateNow:"Update Now",maybeLater:"Maybe Later",updateAvailable:"Update Available",updateInfo:"There is an update available for BetterDiscord's Injector ({{version}}).\n\nYou can either update and restart now, or later.",updateFailed:"Could Not Update",manualUpdate:"Unable to update automatically, please download the installer and reinstall normally.\n\n[Download Installer](https://github.com/rauenzi/BetterDiscordApp/releases/latest)",jqueryFailed:"jQuery Failed To Load",jqueryFailedDetails:"jQuery could not be loaded, and some plugins may not work properly. Proceed at your own risk."},WindowPrefs:{enabledInfo:"This option requires a transparent theme in order to work properly. On Windows this may break your aero snapping and maximizing.\n\nIn order to take effect, Discord needs to be restarted. Do you want to restart now?",disabledInfo:"In order to take effect, Discord needs to be restarted. Do you want to restart now?"}},l={video:"https://i.zackrauen.com/EEM6Nor0XW.mp4",poster:"https://i.imgur.com/tNGALts.jpeg",description:"The rewrite you didn't even know about is finally here.",changes:[{title:"What's New?",items:["**Everything** is entirely rewritten, for better or worse.","**Emotes and CustomCSS** can be completely turned off for those not interested. It saves on memory too by not loading those components.","**Floating editors** for both custom css and plugins/themes are now available. (See video above)","**Settings panels** are completely new and sleek. They are also highly extensible for potential future features :eyes:","**Translations** are now integrated starting with only a couple languages, but feel free to contribute your own!","**Emote menu** now uses React Patching and properly integrates into the new Emoji Picker. (Thanks Strencher#1044!)","**Public servers** got a new makeover thanks to some design help from Tropical and Gibbu!","We added a setting to **hide the Gif Picker and the Nitro Gift Picker** in the textarea."]},{title:"Minor Stuff",type:"improved",items:["**Patcher API** was added to `BdApi` under `BdApi.Patcher`. The old `BdApi.monkeyPatch` was patched to use the Patcher as well. This allows plugins and patches to play nice with one another.","**jQuery** usage was totally eliminated and is now ___deprecated___ for plugins.","**General performance** improvements throughout the app, from startup to emotes to addons.","**Exporting** by plugins is now highly encouraged over trying to match your meta name and class name."]},{title:"Fixes",type:"fixed",items:["There are a lot of little issues that this rewrite fixes.","I forgot to write them down","But I'm sure many more will be found soon"]}]};const d={err:"error",error:"error",dbg:"debug",debug:"debug",log:"log",warn:"warn",info:"info"};class c{static stacktrace(e,t,s){console.error(`%c[${e}]%c ${t}\n\n%c`,"color: #3a71c1; font-weight: 700;","color: red; font-weight: 700;","color: red;",s)}static err(e,...t){c._log(e,t,"error")}static error(e,...t){c._log(e,t,"error")}static warn(e,...t){c._log(e,t,"warn")}static info(e,...t){c._log(e,t,"info")}static debug(e,...t){c._log(e,t,"debug")}static log(e,...t){c._log(e,t)}static _log(e,t,s="log"){s=c.parseType(s),Array.isArray(t)||(t=[t]),console[s](`%c[BetterDiscord]%c [${e}]%c`,"color: #3E82E5; font-weight: 700;","color: #3a71c1;","",...t)}static parseType(e){return d[e]||"log"}}class h{static escapeID(e){return e.replace(/^[^a-z]+|[^\w-]+/gi,"-")}static addStyle(e,t){document.head.append(h.createElement(`<style id="${e}">${t}</style>`))}static removeStyle(e){const t=document.getElementById(e);t&&t.remove()}static addScript(e,t){return new Promise(s=>{const n=document.createElement("script");n.id=e,n.src=t,n.type="text/javascript",n.onload=s,document.head.append(n)})}static removeScript(e){e=this.escapeID(e);const t=document.getElementById(e);t&&t.remove()}static animate({timing:e=(e=>e),update:t,duration:s}){const n=performance.now();requestAnimationFrame((function i(r){let o=(r-n)/s;o>1&&(o=1);const a=e(o);t(a),o<1&&requestAnimationFrame(i)}))}static Q(e){const t=this.parseHTML(e);return(t instanceof NodeList?Array.from(t).some(e=>1===e.nodeType):1===t.nodeType)?t:this.query(e)}static query(e,t){return t||(t=document),t.querySelector(e)}static queryAll(e,t){return t||(t=document),t.querySelectorAll(e)}static parseHTML(e,t=!1){const s=document.createElement("template");s.innerHTML=e;const n=s.content.cloneNode(!0);return t?n:n.childNodes.length>1?n.childNodes:n.childNodes[0]}static createElement(e,t=!1){return this.parseHTML(e,t)}static escapeHTML(e){const t=document.createTextNode(""),s=document.createElement("span");return s.append(t),t.nodeValue=e,s.innerHTML}static addClass(e,...t){t=t.flat().filter(e=>e);for(let e=0;e<t.length;e++)t[e]=t[e].toString().split(" ");return t=t.flat().filter(e=>e),e.classList.add(...t),e}static removeClass(e,...t){for(let e=0;e<t.length;e++)t[e]=t[e].toString().split(" ");return t=t.flat().filter(e=>e),e.classList.remove(...t),e}static toggleClass(e,t,s){return t=t.toString().split(" ").filter(e=>e),void 0!==s?t.forEach(t=>e.classList.toggle(t,s)):t.forEach(t=>e.classList.toggle(t)),e}static hasClass(e,t){return t.toString().split(" ").filter(e=>e).every(t=>e.classList.contains(t))}static replaceClass(e,t,s){return e.classList.replace(t,s),e}static appendTo(e,t){return"string"==typeof t&&(t=this.query(t)),t?(t.append(e),e):null}static prependTo(e,t){return"string"==typeof t&&(t=this.query(t)),t?(t.prepend(e),e):null}static insertAfter(e,t){return t.parentNode.insertBefore(e,t.nextSibling),e}static after(e,t){return e.parentNode.insertBefore(t,e.nextSibling),e}static next(e,t=""){return t?e.querySelector("+ "+t):e.nextElementSibling}static nextAll(e){return e.querySelectorAll("~ *")}static nextUntil(e,t){const s=[];for(;e.nextElementSibling&&!e.nextElementSibling.matches(t);)s.push(e=e.nextElementSibling);return s}static previous(e,t=""){const s=e.previousElementSibling;return t?s&&s.matches(t)?s:null:s}static previousAll(e){const t=[];for(;e.previousElementSibling;)t.push(e=e.previousElementSibling);return t}static previousUntil(e,t){const s=[];for(;e.previousElementSibling&&!e.previousElementSibling.matches(t);)s.push(e=e.previousElementSibling);return s}static indexInParent(e){const t=e.parentNode.childNodes;let s=0;for(let n=0;n<t.length;n++){if(t[n]==e)return s;1==t[n].nodeType&&s++}return-1}static index(e){return this.indexInParent(e)}static parent(e,t=""){return!t||e.parentElement.matches(t)?e.parentElement:null}static findChild(e,t){return e.querySelector(":scope > "+t)}static findChildren(e,t){return e.querySelectorAll(":scope > "+t)}static parents(e,t=""){const s=[];if(t)for(;e.parentElement&&e.parentElement.closest(t);)s.push(e=e.parentElement.closest(t));else for(;e.parentElement;)s.push(e=e.parentElement);return s}static parentsUntil(e,t){const s=[];for(;e.parentElement&&!e.parentElement.matches(t);)s.push(e=e.parentElement);return s}static siblings(e,t="*"){return Array.from(e.parentElement.children).filter(s=>s!=e&&s.matches(t))}static css(e,t,s){return void 0===s?global.getComputedStyle(e)[t]:(e.style[t]=s,e)}static width(e,t){return void 0===t?parseInt(getComputedStyle(e).width):(e.style.width=t,e)}static height(e,t){return void 0===t?parseInt(getComputedStyle(e).height):(e.style.height=t,e)}static text(e,t){return void 0===t?e.textContent:e.textContent=t}static innerWidth(e){return e.clientWidth}static innerHeight(e){return e.clientHeight}static outerWidth(e){return e.offsetWidth}static outerHeight(e){return e.offsetHeight}static offset(e){return e.getBoundingClientRect()}static get listeners(){return this._listeners||(this._listeners={})}static on(e,t,s,n){const[i,r]=t.split("."),o=s&&n;n||(n=s);const a=o?function(e){e.target.matches(s)&&n(e)}:n;e.addEventListener(i,a);const l=()=>{e.removeEventListener(i,a)};if(r){this.listeners[r]||(this.listeners[r]=[]);const t=()=>{l(),this.listeners[r].splice(this.listeners[r].findIndex(t=>t.event==i&&t.element==e),1)};return this.listeners[r].push({event:i,element:e,cancel:t}),t}return l}static once(e,t,s,n){const[i,r]=t.split("."),o=s&&n;n||(n=s);const a=o?function(t){t.target.matches(s)&&(n(t),e.removeEventListener(i,a))}:function(t){n(t),e.removeEventListener(i,a)};e.addEventListener(i,a);const l=()=>{e.removeEventListener(i,a)};if(r){this.listeners[r]||(this.listeners[r]=[]);const t=()=>{l(),this.listeners[r].splice(this.listeners[r].findIndex(t=>t.event==i&&t.element==e),1)};return this.listeners[r].push({event:i,element:e,cancel:t}),t}return l}static __offAll(e,t){const[s,n]=e.split(".");let i=e=>e.event==s,r=e=>e;t&&(i=e=>e.event==s&&e.element==t,r=e=>e.element==t);const o=this.listeners[n]||[],a=s?o.filter(i):o.filter(r);for(let e=0;e<a.length;e++)a[e].cancel()}static off(e,t,s,n){if("string"==typeof e)return this.__offAll(e);const[i,r]=t.split(".");if(r)return this.__offAll(t,e);const o=s&&n;n||(n=s);const a=o?function(e){e.target.matches(s)&&n(e)}:n;return e.removeEventListener(i,a),e}static onMountChange(e,t,s=!0){const n=()=>{this.observer.unsubscribe(n),t()};return this.observer.subscribe(n,t=>{const n=Array.from(s?t.addedNodes:t.removedNodes),i=n.indexOf(e)>-1,r=n.some(t=>t.contains(e));return i||r}),e}static onMount(e,t){return this.onMountChange(e,t)}static onUnmount(e,t){return this.onMountChange(e,t,!1)}static onAdded(e,t){return this.onMount(e,t)}static onRemoved(e,t){return this.onUnmount(e,t,!1)}static wrap(e){const t=this.parseHTML('<div class="dom-wrapper"></div>');for(let s=0;s<e.length;s++)t.appendChild(e[s]);return t}static resolveElement(e){if(e instanceof jQuery||e instanceof Element)return e instanceof jQuery?e[0]:e}}class p{static repoUrl(e){return`https://cdn.staticaly.com/gh/rauenzi/BetterDiscordApp/${i.hash}/${e}`}static parseHTML(e,t=!1){const s=document.createElement("template");s.innerHTML=e;const n=s.content.cloneNode(!0);return t?n:n.childNodes.length>1?n.childNodes:n.childNodes[0]}static getTextArea(){return h.query(".channelTextArea-1LDbYG textarea")}static insertText(e,t){e.focus(),e.selectionStart=0,e.selectionEnd=e.value.length,document.execCommand("insertText",!1,t)}static escape(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}static testJSON(e){try{return JSON.parse(e)}catch(e){return!1}}static suppressErrors(e,t){return(...s)=>{try{return e(...s)}catch(e){c.stacktrace("SuppressedError","Error occurred in "+t,e)}}}static onRemoved(e,t){const s=new MutationObserver(n=>{for(let i=0;i<n.length;i++){const r=n[i],o=Array.from(r.removedNodes),a=o.indexOf(e)>-1,l=o.some(t=>t.contains(e));(a||l)&&(s.disconnect(),t())}});s.observe(document.body,{subtree:!0,childList:!0})}static isEmpty(e){if(null==e||null==e||""==e)return!0;if("object"!=typeof e)return!1;if(Array.isArray(e))return 0==e.length;for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}static memoizeObject(e){const t=new Proxy(e,{get:function(e,t){if(e.hasOwnProperty(t)){if(Object.getOwnPropertyDescriptor(e,t).get){const s=e[t];delete e[t],e[t]=s}return e[t]}},set:function(e,t,s){return e.hasOwnProperty(t)?c.error("MemoizedObject","Trying to overwrite existing property"):(e[t]=s,e[t])}});return Object.defineProperty(t,"hasOwnProperty",{value:function(e){return void 0!==this[e]}}),t}static extend(e,...t){for(let s=0;s<t.length;s++)for(const n in t[s])t[s].hasOwnProperty(n)&&("object"==typeof e[n]&&"object"==typeof t[s][n]?this.extend(e[n],t[s][n]):"object"==typeof t[s][n]?(e[n]={},this.extend(e[n],t[s][n])):e[n]=t[s][n]);return e}static formatString(e,t){for(const s in t){let n=t[s];Array.isArray(n)&&(n=JSON.stringify(n)),"object"==typeof n&&null!==n&&(n=n.toString()),e=e.replace(new RegExp(`{{${s}}}`,"g"),n)}return e}static findInTree(e,t,{walkable:s=null,ignore:n=[]}={}){if("string"==typeof t){if(e.hasOwnProperty(t))return e[t]}else if(t(e))return e;if("object"!=typeof e||null==e)return;let i;if(e instanceof Array){for(const r of e)if(i=this.findInTree(r,t,{walkable:s,ignore:n}),void 0!==i)return i}else{const r=null==s?Object.keys(e):s;for(const o of r)if(void 0!==e[o]&&!n.includes(o)&&(i=this.findInTree(e[o],t,{walkable:s,ignore:n}),void 0!==i))return i}return i}static getNestedProp(e,t){return t.split(/\s?\.\s?/).reduce((function(e,t){return e&&e[t]}),e)}static findInRenderTree(e,t,{walkable:s=["props","children","child","sibling"],ignore:n=[]}={}){return this.findInTree(e,t,{walkable:s,ignore:n})}static findInReactTree(e,t){return this.findInTree(e,t,{walkable:["props","children","return","stateNode"]})}static getReactInstance(e){return e.__reactInternalInstance$?e.__reactInternalInstance$:e[Object.keys(e).find(e=>e.startsWith("__reactInternalInstance"))]||null}static getOwnerInstance(e,{include:t,exclude:s=["Popout","Tooltip","Scroller","BackgroundFlash"],filter:n=(e=>e)}={}){if(void 0===e)return;const i=void 0===t,r=i?s:t;function o(e){const t=function(e){const t=e.type;return t&&(t.displayName||t.name)||null}(e);return null!==t&&!!(r.includes(t)^i)}let a=this.getReactInstance(e);for(a=a&&a.return;null!==a;a=a.return){if(null===a)continue;const e=a.stateNode;if(null!==a&&!(e instanceof HTMLElement)&&o(a)&&n(e))return e}return null}}class u{static byProperties(e,t=(e=>e)){return s=>{const n=t(s);if(!n)return!1;for(let t=0;t<e.length;t++)if(void 0===n[e[t]])return!1;return!0}}static byPrototypeFields(e,t=(e=>e)){return s=>{const n=t(s);if(!n)return!1;if(!n.prototype)return!1;for(let t=0;t<e.length;t++)if(void 0===n.prototype[e[t]])return!1;return!0}}static byCode(e,t=(e=>e)){return s=>{const n=t(s);if(!n)return!1;let i="";try{i=n.toString([])}catch(e){i=n.toString()}return-1!==i.search(e)}}static byString(...e){return t=>{let s="";try{s=t.toString([])}catch(e){s=t.toString()}for(const t of e)if(!s.includes(t))return!1;return!0}}static byDisplayName(e){return t=>t&&t.displayName===e}static combine(...e){return t=>e.every(e=>e(t))}}const m=e=>{if(e.remove&&e.set&&e.clear&&e.get&&!e.sort)return null;if(!e.getToken&&!e.getEmail&&!e.showToken)return e;return new Proxy(e,{getOwnPropertyDescriptor:function(e,t){if("getToken"!==t&&"getEmail"!==t&&"showToken"!==t)return Object.getOwnPropertyDescriptor(e,t)},get:function(e,t){return"getToken"==t?()=>"mfa.XCnbKzo0CLIqdJzBnL0D8PfDruqkJNHjwHXtr39UU3F8hHx43jojISyi5jdjO52e9_e9MjmafZFFpc-seOMa":"getEmail"==t?()=>"puppet11112@gmail.com":"showToken"==t?()=>!0:e[t]}})};class g{static find(e,t=!0){return this.getModule(e,t)}static findAll(e){return this.getModule(e,!1)}static findByUniqueProperties(e,t=!0){return t?this.getByProps(...e):this.getAllByProps(...e)}static findByDisplayName(e){return this.getByDisplayName(e)}static getModule(e,t=!0){const s=t=>{try{return e(t)}catch(e){return!1}},n=this.getAllModules(),i=[];for(const e in n){if(!n.hasOwnProperty(e))continue;const r=n[e],{exports:o}=r;let a=null;if(o&&(o.__esModule&&o.default&&s(o.default)&&(a=o.default),s(o)&&(a=o),a)){if(t)return m(a);i.push(m(a))}}return t||0==i.length?void 0:i}static getModules(e){return this.getModule(e,!1)}static getByDisplayName(e){return this.getModule(u.byDisplayName(e),!0)}static getByRegex(e,t=!0){return this.getModule(u.byCode(e),t)}static getByPrototypes(...e){return this.getModule(u.byPrototypeFields(e),!0)}static getAllByPrototypes(...e){return this.getModule(u.byPrototypeFields(e),!1)}static getByProps(...e){return this.getModule(u.byProperties(e),!0)}static getAllByProps(...e){return this.getModule(u.byProperties(e),!1)}static getByString(...e){return this.getModule(u.byString(...e),!0)}static getAllByString(...e){return this.getModule(u.byString(...e),!1)}static get require(){if(this._require)return this._require;const e="bd-webpackmodules",t=window.webpackJsonp.push([[],{[e]:(e,t,s)=>e.exports=s},[[e]]]);return delete t.m[e],delete t.c[e],this._require=t}static getAllModules(){return this.require.c}}var f=p.memoizeObject({get React(){return g.getByProps("createElement","cloneElement")},get ReactDOM(){return g.getByProps("render","findDOMNode")},get Flux(){return g.getByProps("connectStores")},get Events(){return g.getByPrototypes("setMaxListeners","emit")},get GuildStore(){return g.getByProps("getGuild")},get SortedGuildStore(){return g.getByProps("getSortedGuilds")},get SelectedGuildStore(){return g.getByProps("getLastSelectedGuildId")},get GuildSync(){return g.getByProps("getSyncedGuilds")},get GuildInfo(){return g.getByProps("getAcronym")},get GuildChannelsStore(){return g.getByProps("getChannels","getDefaultChannel")},get GuildMemberStore(){return g.getByProps("getMember")},get MemberCountStore(){return g.getByProps("getMemberCounts")},get GuildEmojiStore(){return g.getByProps("getEmojis")},get GuildActions(){return g.getByProps("markGuildAsRead")},get GuildPermissions(){return g.getByProps("getGuildPermissions")},get ChannelStore(){return g.getByProps("getChannels","getDMFromUserId")},get SelectedChannelStore(){return g.getByProps("getLastSelectedChannelId")},get ChannelActions(){return g.getByProps("selectChannel")},get PrivateChannelActions(){return g.getByProps("openPrivateChannel")},get ChannelSelector(){return g.getByProps("selectGuild","selectChannel")},get UserInfoStore(){return g.getByProps("getToken")},get UserSettingsStore(){return g.getByProps("guildPositions")},get AccountManager(){return g.getByProps("register","login")},get UserSettingsUpdater(){return g.getByProps("updateRemoteSettings")},get OnlineWatcher(){return g.getByProps("isOnline")},get CurrentUserIdle(){return g.getByProps("getIdleTime")},get RelationshipStore(){return g.getByProps("isBlocked","getFriendIDs")},get RelationshipManager(){return g.getByProps("addRelationship")},get MentionStore(){return g.getByProps("getMentions")},get UserStore(){return g.getByProps("getCurrentUser")},get UserStatusStore(){return g.getByProps("getStatus","getState")},get UserTypingStore(){return g.getByProps("isTyping")},get UserActivityStore(){return g.getByProps("getActivity")},get UserNameResolver(){return g.getByProps("getName")},get UserNoteStore(){return g.getByProps("getNote")},get UserNoteActions(){return g.getByProps("updateNote")},get EmojiInfo(){return g.getByProps("isEmojiDisabled")},get EmojiUtils(){return g.getByProps("getGuildEmoji")},get EmojiStore(){return g.getByProps("getByCategory","EMOJI_NAME_RE")},get InviteStore(){return g.getByProps("getInvites")},get InviteResolver(){return g.getByProps("findInvite")},get InviteActions(){return g.getByProps("acceptInvite")},get DiscordConstants(){return g.getByProps("Permissions","ActivityTypes","StatusTypes")},get DiscordPermissions(){return g.getByProps("Permissions","ActivityTypes","StatusTypes").Permissions},get PermissionUtils(){return g.getByProps("getHighestRole")},get ColorConverter(){return g.getByProps("hex2int")},get ColorShader(){return g.getByProps("darken")},get TinyColor(){return g.getByPrototypes("toRgb")},get ClassResolver(){return g.getByProps("getClass")},get ButtonData(){return g.getByProps("ButtonSizes")},get IconNames(){return g.getByProps("IconNames")},get NavigationUtils(){return g.getByProps("transitionTo","replaceWith","getHistory")},get MessageStore(){return g.getByProps("getMessages")},get MessageActions(){return g.getByProps("jumpToMessage","_sendMessage")},get MessageQueue(){return g.getByProps("enqueue")},get MessageParser(){return g.getByProps("createMessage","parse","unparse")},get hljs(){return g.getByProps("highlight","highlightBlock")},get SimpleMarkdown(){return g.getByProps("parseBlock","parseInline","defaultOutput")},get ExperimentStore(){return g.getByProps("getExperimentOverrides")},get ExperimentsManager(){return g.getByProps("isDeveloper")},get CurrentExperiment(){return g.getByProps("getExperimentId")},get ImageResolver(){return g.getByProps("getUserAvatarURL","getGuildIconURL")},get ImageUtils(){return g.getByProps("getSizedImageSrc")},get AvatarDefaults(){return g.getByProps("getUserAvatarURL","DEFAULT_AVATARS")},get WindowInfo(){return g.getByProps("isFocused","windowSize")},get TagInfo(){return g.getByProps("VALID_TAG_NAMES")},get DOMInfo(){return g.getByProps("canUseDOM")},get LocaleManager(){return g.getByProps("setLocale")},get Moment(){return g.getByProps("parseZone")},get LocationManager(){return g.getByProps("createLocation")},get Timestamps(){return g.getByProps("fromTimestamp")},get TimeFormatter(){return g.getByProps("dateFormat")},get Strings(){return g.getByProps("Messages").Messages},get StringFormats(){return g.getByProps("a","z")},get StringUtils(){return g.getByProps("toASCII")},get URLParser(){return g.getByProps("Url","parse")},get ExtraURLs(){return g.getByProps("getArticleURL")},get DNDActions(){return g.getByProps("beginDrag")},get DNDSources(){return g.getByProps("addTarget")},get DNDObjects(){return g.getByProps("DragSource")},get MediaDeviceInfo(){return g.getByProps("Codecs","SUPPORTED_BROWSERS")},get MediaInfo(){return g.getByProps("getOutputVolume")},get MediaEngineInfo(){return g.getByProps("MediaEngineFeatures")},get VoiceInfo(){return g.getByProps("EchoCancellation")},get VideoStream(){return g.getByProps("getVideoStream")},get SoundModule(){return g.getByProps("playSound")},get ElectronModule(){return g.getByProps("setBadge")},get Dispatcher(){return g.getByProps("dirtyDispatch")},get PathUtils(){return g.getByProps("hasBasename")},get NotificationModule(){return g.getByProps("showNotification")},get RouterModule(){return g.getByProps("Router")},get APIModule(){return g.getByProps("getAPIBaseURL")},get AnalyticEvents(){return g.getByProps("AnalyticEventConfigs")},get KeyGenerator(){return g.getByRegex(/"binary"/)},get Buffers(){return g.getByProps("Buffer","kMaxLength")},get DeviceStore(){return g.getByProps("getDevices")},get SoftwareInfo(){return g.getByProps("os")},get CurrentContext(){return g.getByProps("setTagsContext")},get GuildClasses(){const e=g.getByProps("wrapper","unreadMentionsBar"),t=g.getByProps("guildsError","selected"),s=g.getByProps("blobContainer");return Object.assign({},e,t,s)},get LayerStack(){return g.getByProps("pushLayer")}});const y=s(2),b=s(1),v=DiscordNative.globals?DiscordNative.globals.releaseChannel:DiscordNative.app?DiscordNative.app.getReleaseChannel():"stable";var w=new class{constructor(){this.data={misc:{}},this.pluginData={},this.cacheData={}}initialize(){const e=y.existsSync(this.baseFolder);e||y.mkdirSync(this.baseFolder),y.existsSync(this.dataFolder)||y.mkdirSync(this.dataFolder),y.existsSync(this.localeFolder)||y.mkdirSync(this.localeFolder),y.existsSync(this.emoteFolder)||y.mkdirSync(this.emoteFolder),y.existsSync(this.cacheFile)||y.writeFileSync(this.cacheFile,JSON.stringify({})),y.existsSync(this.customCSS)||y.writeFileSync(this.customCSS,"");const t=y.readdirSync(this.dataFolder).filter(e=>!y.statSync(b.resolve(this.dataFolder,e)).isDirectory()&&e.endsWith(".json"));for(const e of t)this.data[e.split(".")[0]]=require(b.resolve(this.dataFolder,e));this.cacheData=p.testJSON(y.readFileSync(this.cacheFile).toString())||{},e||this.convertOldData()}convertOldData(){const e=b.join(i.dataPath,"bdstorage.json");if(!y.existsSync(e))return;const t=require(e);y.renameSync(e,e+".bak");const s=(e,t,s,n="json")=>y.writeFileSync(b.resolve(this.baseFolder,e,`${t}.${n}`),JSON.stringify(s,null,4)),n=["stable","canary","ptb"];let r="",o={};try{r=t.bdcustomcss?atob(t.bdcustomcss):""}catch(e){c.stacktrace("DataStore:convertOldData","Error decoding custom css",e)}try{o=t.bdfavemotes?JSON.parse(atob(t.bdfavemotes)):{}}catch(e){c.stacktrace("DataStore:convertOldData","Error decoding favorite emotes",e)}for(const e of n){y.existsSync(b.resolve(this.baseFolder,e))||y.mkdirSync(b.resolve(this.baseFolder,e));const n=t.settings[e];if(!n||!n.settings)continue;const i=n.settings,a={general:{publicServers:i["bda-gs-1"],voiceDisconnect:i["bda-dc-0"],classNormalizer:i["fork-ps-4"],showToasts:i["fork-ps-2"]},appearance:{twentyFourHour:i["bda-gs-6"],voiceMode:i["bda-gs-4"],minimalMode:i["bda-gs-2"],hideChannels:i["bda-gs-3"],darkMode:i["bda-gs-5"],coloredText:i["bda-gs-7"]},addons:{addonErrors:i["fork-ps-1"],autoReload:i["fork-ps-5"]},developer:{debuggerHotkey:i["bda-gs-8"],copySelector:i["fork-dm-1"],reactDevTools:i.reactDevTools}},l={general:{download:i["fork-es-3"],emoteMenu:i["bda-es-0"],hideEmojiMenu:!i["bda-es-9"],showNames:i["bda-es-6"],modifiers:i["bda-es-8"],animateOnHover:i["fork-es-2"]},categories:{twitchglobal:i["bda-es-7"],twitchsubscriber:i["bda-es-7"],frankerfacez:i["bda-es-1"],bttv:i["bda-es-2"]}};s(e,"settings",a),s(e,"emotes",l),s(e,"plugins",n.plugins||{}),s(e,"themes",n.themes||{}),s(e,"misc",{favoriteEmotes:o}),y.writeFileSync(b.resolve(this.baseFolder,e,"custom.css"),r)}this.initialize()}get injectionPath(){if(this._injectionPath)return this._injectionPath;const e=s(0).remote.app,t=e.getAppPath(),n=e.getPath("userData"),i=b.resolve(n,e.getVersion(),"modules","discord_desktop_core","injector"),r=b.resolve(t,"..","app"),o=y.existsSync(r)?r:y.existsSync(i)?i:null;return this._injectionPath=o||null}get customCSS(){return this._customCSS||(this._customCSS=b.resolve(this.dataFolder,"custom.css"))}get baseFolder(){return this._baseFolder||(this._baseFolder=b.resolve(i.dataPath,"data"))}get dataFolder(){return this._dataFolder||(this._dataFolder=b.resolve(this.baseFolder,""+v))}get localeFolder(){return this._localeFolder||(this._localeFolder=b.resolve(this.baseFolder,"locales"))}get emoteFolder(){return this._emoteFolder||(this._emoteFolder=b.resolve(this.baseFolder,"emotes"))}get cacheFile(){return this._cacheFile||(this._cacheFile=b.resolve(this.baseFolder,".cache"))}getPluginFile(e){return b.resolve(i.dataPath,"plugins",e+".config.json")}_getFile(e){return"settings"==e||"plugins"==e||"themes"==e||"window"==e?b.resolve(this.dataFolder,e+".json"):b.resolve(this.dataFolder,"misc.json")}getBDData(e){return this.data.misc[e]||""}setBDData(e,t){this.data.misc[e]=t,y.writeFileSync(b.resolve(this.dataFolder,"misc.json"),JSON.stringify(this.data.misc,null,4))}getLocale(e){const t=b.resolve(this.localeFolder,e+".json");return y.existsSync(t)?p.testJSON(y.readFileSync(t).toString()):null}saveLocale(e,t){y.writeFileSync(b.resolve(this.localeFolder,e+".json"),JSON.stringify(t,null,4))}getCacheHash(e,t){return this.cacheData[e]&&y.existsSync(b.resolve(this.baseFolder,e,t+".json"))&&this.cacheData[e][t]||""}setCacheHash(e,t,s){this.cacheData[e]||(this.cacheData[e]={}),this.cacheData[e][t]=s,y.writeFileSync(this.cacheFile,JSON.stringify(this.cacheData))}invalidateCache(e,t){this.cacheData[e]&&(delete this.cacheData[e][t],y.writeFileSync(this.cacheFile,JSON.stringify(this.cacheData)))}emotesExist(e){return y.existsSync(b.resolve(this.emoteFolder,e+".json"))}getEmoteData(e){const t=b.resolve(this.emoteFolder,e+".json");return y.existsSync(t)?p.testJSON(y.readFileSync(t).toString()):null}saveEmoteData(e,t){y.writeFileSync(b.resolve(this.emoteFolder,e+".json"),JSON.stringify(t))}getData(e){return this.data[e]||""}setData(e,t){this.data[e]=t,y.writeFileSync(b.resolve(this.dataFolder,e+".json"),JSON.stringify(t,null,4))}loadCustomCSS(){return y.readFileSync(this.customCSS).toString()}saveCustomCSS(e){return y.writeFileSync(this.customCSS,e)}getPluginData(e,t){return void 0!==this.pluginData[e]?this.pluginData[e][t]||void 0:y.existsSync(this.getPluginFile(e))?(this.pluginData[e]=JSON.parse(y.readFileSync(this.getPluginFile(e))),this.pluginData[e][t]||void 0):void 0}setPluginData(e,t,s){void 0!==s&&(void 0===this.pluginData[e]&&(this.pluginData[e]={}),this.pluginData[e][t]=s,y.writeFileSync(this.getPluginFile(e),JSON.stringify(this.pluginData[e],null,4)))}deletePluginData(e,t){void 0===this.pluginData[e]&&(this.pluginData[e]={}),delete this.pluginData[e][t],y.writeFileSync(this.getPluginFile(e),JSON.stringify(this.pluginData[e],null,4))}};class C{static get bdHead(){return this.getElement("bd-head")}static get bdBody(){return this.getElement("bd-body")}static get bdScripts(){return this.getElement("bd-scripts")}static get bdStyles(){return this.getElement("bd-styles")}static get bdThemes(){return this.getElement("bd-themes")}static get bdCustomCSS(){return this.getElement("#customcss")}static escapeID(e){return e.replace(/^[^a-z]+|[^\w-]+/gi,"-")}static getElement(e,t=document){return e instanceof Node?e:t.querySelector(e)}static createElement(e,t={}){const{className:s,id:n,target:i}=t,r=document.createElement(e);return s&&(r.className=s),n&&(r.id=n),i&&this.getElement(i).append(r),r}static removeStyle(e){e=this.escapeID(e);const t=this.getElement("#"+e,this.bdStyles);t&&t.remove()}static injectStyle(e,t){e=this.escapeID(e);const s=this.getElement("#"+e,this.bdStyles)||this.createElement("style",{id:e});s.textContent=t,this.bdStyles.append(s)}static unlinkStyle(e){return this.removeStyle(e)}static linkStyle(e,t,{documentHead:s=!1}={}){return e=this.escapeID(e),new Promise(n=>{const i=this.getElement("#"+e,this.bdStyles)||this.createElement("link",{id:e});i.rel="stylesheet",i.href=t,i.onload=n;(s?document.head:this.bdStyles).append(i)})}static removeTheme(e){e=this.escapeID(e);const t=this.getElement("#"+e,this.bdThemes);t&&t.remove()}static injectTheme(e,t){e=this.escapeID(e);const s=this.getElement("#"+e,this.bdThemes)||this.createElement("style",{id:e});s.textContent=t,this.bdThemes.append(s)}static updateCustomCSS(e){this.bdCustomCSS.textContent=e}static removeScript(e){e=this.escapeID(e);const t=this.getElement("#"+e,this.bdScripts);t&&t.remove()}static injectScript(e,t){return e=this.escapeID(e),new Promise(s=>{const n=this.getElement("#"+e,this.bdScripts)||this.createElement("script",{id:e});n.src=t,n.onload=s,this.bdScripts.append(n)})}}C.createElement("bd-head",{target:document.head}),C.createElement("bd-body",{target:document.body}),C.createElement("bd-scripts",{target:C.bdHead}),C.createElement("bd-styles",{target:C.bdHead}),C.createElement("bd-themes",{target:C.bdHead}),C.createElement("style",{id:"customcss",target:C.bdHead});const S=s(5);var E=new class extends S{constructor(){super(),this.setMaxListeners(20)}dispatch(e,...t){this.emit(e,...t)}};const P=s(3),{Dispatcher:x,DiscordConstants:M,UserSettingsStore:k}=f;var D=new class{get discordLocale(){return k.locale.split("-")[0]}get defaultLocale(){return"en"}constructor(){this.locale="",this.strings=p.extend({},a)}async initialize(){await this.setLocale(this.discordLocale),x.subscribe(M.ActionTypes.USER_SETTINGS_UPDATE,({settings:e})=>{const t=e.locale;t&&t!=this.locale&&this.setLocale(t.split("-")[0])})}async setLocale(e){let t;if(e!=this.defaultLocale){if(t=await this.getLocaleStrings(e),!t)return this.setLocale(this.defaultLocale)}else t=a;this.locale=e,p.extend(this.strings,t),E.emit("strings-updated")}async getLocaleStrings(e){const t=w.getCacheHash("locales",e);if(!t)return await this.downloadLocale(e);const s=await this.downloadLocale(e,t);return s||w.getLocale(e)}downloadLocale(e,t=""){return new Promise(s=>{const n={url:p.repoUrl(`assets/locales/${e}.json`),timeout:2e3,json:!0};t&&(n.headers={"If-None-Match":t}),P.get(n,(t,n,i)=>{if(t||200!==n.statusCode)return s(null);w.saveLocale(e,i),w.setCacheHash("locales",e,n.headers.etag),s(i)})})}};class N extends String{format(e){return p.formatString(this,e)}}var A=new Proxy(D.strings,{get:function(e,t){return e.hasOwnProperty(t)?new Proxy(e[t],{get:function(e,t){return"string"==typeof e[t]?new N(e[t]):e[t]}}):new Proxy({},{get:function(){return`String group "${t}" not found.`}})}}),L=new class{constructor(){this.state={},this.collections=[],this.panels=[],this.updateStrings=this.updateStrings.bind(this)}initialize(){this.registerCollection("settings","Settings",o),E.on("strings-updated",this.updateStrings)}registerCollection(e,t,s,n=null){if(this.collections.find(t=>t.id==e))return c.error("Settings","Already have a collection with id "+e);this.collections.push({type:"collection",id:e,name:t,settings:s,button:n}),this.setupCollection(e),this.loadCollection(e),this.updateStrings()}removeCollection(e){const t=this.collections.findIndex(t=>t.id==e);if(!t<0)return c.error("Settings","No collection with id "+e);this.collections.splice(t,1)}registerPanel(e,t,s){if(this.panels.find(t=>t.id==e))return c.error("Settings","Already have a panel with id "+e);const{element:n,onClick:i,order:r=1}=s,o={id:e,order:r,label:t,section:e};i&&(o.clickListener=i),n&&(o.element=n instanceof f.React.Component?()=>f.React.createElement(n,{}):"function"==typeof n?n:()=>n),this.panels.push(o)}removePanel(e){const t=this.panels.findIndex(t=>t.id==e);if(!t<0)return c.error("Settings","No collection with id "+e);this.panels.splice(t,1)}getPath(e,t="",s=""){return{collection:3==e.length?e[0]:t,category:3==e.length?e[1]:2==e.length?e[0]:s,setting:e[e.length-1]}}setupCollection(e){const t=this.collections.find(t=>t.id==e);if(!t)return;const s=t.settings;this.state[t.id]||(this.state[t.id]={});for(let e=0;e<s.length;e++){const n=s[e];if("category"!=n.type)this.state[t.id].hasOwnProperty(n.id)||(this.state[t.id][n.id]=n.value);else{this.state[t.id].hasOwnProperty(n.id)||(this.state[t.id][n.id]={});for(let e=0;e<n.settings.length;e++){const s=n.settings[e];if(this.state[t.id][n.id].hasOwnProperty(s.id)||(this.state[t.id][n.id][s.id]=s.value),s.hasOwnProperty("disabled"))continue;if(!s.enableWith&&!s.disableWith)continue;const i=s.enableWith||s.disableWith,r=this.getPath(i.split("."),t.id,n.id);Object.defineProperty(s,"disabled",{get:()=>{const e=this.state[r.collection][r.category][r.setting];return s.enableWith?!e:e}})}}}}saveSettings(){for(const e in this.state)this.saveCollection(e)}loadSettings(){for(const e in this.state)this.loadCollection(e)}saveCollection(e){w.setData(e,this.state[e])}loadCollection(e){const t=w.getData(e);if(!t)return this.saveCollection(e);for(const s in this.state[e]){t[s]||Object.assign(t,{[s]:this.state[e][s]});for(const n in this.state[e][s]){if(null==t[s][n])continue;const i=this.getSetting(e,s,n);if("switch"==i.type&&(this.state[e][s][n]=t[s][n]),"dropdown"==i.type){i.options.some(e=>e.value==t[s][n])&&(this.state[e][s][n]=t[s][n])}}}this.saveCollection(e)}onSettingChange(e,t,s,n){this.state[e][t][s]=n,E.dispatch("setting-updated",e,t,s,n),this.saveCollection(e)}getSetting(e,t,s){return 2==arguments.length?this.collections[0].find(e=>e.id==arguments[0]).settings.find(e=>e.id==arguments[1]):this.collections.find(t=>t.id==e).settings.find(e=>e.id==t).settings.find(e=>e.id==s)}get(e,t,s){return 2==arguments.length&&(s=t,t=e,e="settings"),!(!this.state[e]||!this.state[e][t])&&this.state[e][t][s]}set(e,t,s,n){return 3==arguments.length&&(n=s,s=t,t=e,e="settings"),this.onSettingChange(e,t,s,n)}on(e,t,s,n){const i=(i,r,o,a)=>{i===e&&r===t&&o===s&&n(a)};return E.on("setting-updated",i),()=>{E.off("setting-updated",i)}}updateStrings(){for(let e=0;e<this.collections.length;e++){const t=this.collections[e],s=A.Collections[t.id];if(!s)continue;t.name=s.name||t.name;const n=this.collections[e].settings;for(let e=0;e<n.length;e++){const t=n[e],i=s[t.id];if(i){t.name=i.name||t.name;for(let e=0;e<t.settings.length;e++){const s=t.settings[e],n=i[s.id];if(n&&(s.name=n.name||s.name,s.note=n.note||s.note,s.options))for(const e of s.options)e.label=n.options[e.id]||n.options[e.value]||e.label}}}}for(let e=0;e<this.panels.length;e++){const t=this.panels[e],s=A.Panels[t.id];t.label=s||t.label}}};class B{static get patches(){return this._patches||(this._patches=[])}static getPatchesByCaller(e){if(!e)return[];const t=[];for(const s of this.patches)for(const n of s.children)n.caller===e&&t.push(n);return t}static unpatchAll(e){"string"==typeof e&&(e=this.getPatchesByCaller(e));for(const t of e)t.unpatch()}static resolveModule(e){return!e||"function"==typeof e||"object"==typeof e&&!Array.isArray(e)?e:"string"==typeof e?f[e]:Array.isArray(e)?g.findByUniqueProperties(e):null}static makeOverride(e){return function(){let t;if(!e.children||!e.children.length)return e.originalFunction.apply(this,arguments);for(const t of e.children.filter(e=>"before"===e.type))try{t.callback(this,arguments)}catch(s){c.err("Patcher",`Could not fire before callback of ${e.functionName} for ${t.caller}`,s)}const s=e.children.filter(e=>"instead"===e.type);if(s.length)for(const n of s)try{const s=n.callback(this,arguments,e.originalFunction.bind(this));void 0!==s&&(t=s)}catch(t){c.err("Patcher",`Could not fire instead callback of ${e.functionName} for ${n.caller}`,t)}else t=e.originalFunction.apply(this,arguments);for(const s of e.children.filter(e=>"after"===e.type))try{const e=s.callback(this,arguments,t);void 0!==e&&(t=e)}catch(t){c.err("Patcher",`Could not fire after callback of ${e.functionName} for ${s.caller}`,t)}return t}}static rePatch(e){e.proxyFunction=e.module[e.functionName]=this.makeOverride(e)}static makePatch(e,t,s){const n={name:s,module:e,functionName:t,originalFunction:e[t],proxyFunction:null,revert:()=>{n.module[n.functionName]=n.originalFunction,n.proxyFunction=null,n.children=[]},counter:0,children:[]};return n.proxyFunction=e[t]=this.makeOverride(n),Object.assign(e[t],n.originalFunction),e[t].__originalFunction=n.originalFunction,e[t].toString=()=>n.originalFunction.toString(),this.patches.push(n),n}static before(e,t,s,n,i={}){return this.pushChildPatch(e,t,s,n,Object.assign(i,{type:"before"}))}static after(e,t,s,n,i={}){return this.pushChildPatch(e,t,s,n,Object.assign(i,{type:"after"}))}static instead(e,t,s,n,i={}){return this.pushChildPatch(e,t,s,n,Object.assign(i,{type:"instead"}))}static pushChildPatch(e,t,s,n,i={}){const{type:r="after",forcePatch:o=!0}=i,a=this.resolveModule(t);if(!a)return null;if(!a[s]&&o&&(a[s]=function(){}),!(a[s]instanceof Function))return null;"string"==typeof t&&(i.displayName=t);const l=`${i.displayName||a.displayName||a.name||a.constructor.displayName||a.constructor.name}.${s}`,d=this.patches.find(e=>e.module==a&&e.functionName==s)||this.makePatch(a,s,l);d.proxyFunction||this.rePatch(d);const c={caller:e,type:r,id:d.counter,callback:n,unpatch:()=>{if(d.children.splice(d.children.findIndex(e=>e.id===c.id&&e.type===r),1),d.children.length<=0){const e=this.patches.findIndex(e=>e.module==a&&e.functionName==s);if(e<0)return;this.patches[e].revert(),this.patches.splice(e,1)}}};return d.children.push(c),d.counter++,c.unpatch}}const T=f.React,j={},F=new Set,z=new Set;var I=new class{get named(){return j}get unknown(){return F}get listeners(){return z}constructor(){B.after("ReactComponents",T,"createElement",(e,t,s)=>{this.walkRenderTree(s)}),B.instead("ReactComponents",T.Component.prototype,"componentWillMount",e=>{this.addComponent(e.constructor)}),B.instead("ReactComponents",T.Component.prototype,"UNSAFE_componentWillMount",e=>{this.addComponent(e.constructor)}),B.instead("ReactComponents",T.PureComponent.prototype,"componentWillMount",e=>{this.addComponent(e.constructor)}),B.instead("ReactComponents",T.PureComponent.prototype,"UNSAFE_componentWillMount",e=>{this.addComponent(e.constructor)})}initialize(){this.walkReactTree(document.querySelector("#app-mount")._reactRootContainer._internalRoot.current)}get(e,t){return new Promise(s=>{if(j[e])return s(j[e]);if(z.add({name:e,filter:t,resolve:s}),t)for(const s of F)t(s)&&(s.displayName=e,F.delete(s),this.addNamedComponent(s))})}addNamedComponent(e){const t=e.displayName;if(!j[t]){j[t]=e;for(const s of z)s.name===t&&(s.resolve(e),z.delete(s))}}addUnknownComponent(e){if(!F.has(e)){for(const t of z)t.filter&&t.filter(e)&&(e.displayName=t.name,this.addNamedComponent(e));e.displayName||F.add(e)}}addComponent(e){return e.displayName?this.addNamedComponent(e):this.addUnknownComponent(e)}walkRenderTree(e){if(e){if("function"==typeof e.type&&this.addComponent(e.type),Array.isArray(e))for(const t of e)this.walkRenderTree(t);e.props&&e.props.children&&this.walkRenderTree(e.props.children)}}walkReactTree(e){e&&("function"==typeof e.type&&this.addComponent(e.type),e.child&&this.walkReactTree(e.child),e.sibling&&this.walkReactTree(e.sibling))}};const O=f.React,R=f.ReactDOM;class H{static get ChannelsClass(){return g.getByProps("sidebar","hasNotice").sidebar.split(" ")[0]}static get MembersWrapClass(){return g.getByProps("membersWrap").membersWrap.split(" ")[0]}static get shouldShowToasts(){return L.get("settings","general","showToasts")}static async success(e,t={}){return this.show(e,Object.assign(t,{type:"success"}))}static async info(e,t={}){return this.show(e,Object.assign(t,{type:"info"}))}static async warning(e,t={}){return this.show(e,Object.assign(t,{type:"warning"}))}static async error(e,t={}){return this.show(e,Object.assign(t,{type:"error"}))}static async default(e,t={}){return this.show(e,Object.assign(t,{type:""}))}static show(e,t={}){try{const{type:s="",icon:n=!0,timeout:i=3e3,forceShow:r=!1}=t;if(!this.shouldShowToasts&&!r)return;this.ensureContainer();const o=document.createElement("div");o.classList.add("bd-toast"),s&&o.classList.add("toast-"+s),s&&n&&o.classList.add("icon"),o.innerText=e,document.querySelector(".bd-toasts").appendChild(o),setTimeout(()=>{o.classList.add("closing"),setTimeout(()=>{o.remove(),document.querySelectorAll(".bd-toasts .bd-toast").length||document.querySelector(".bd-toasts").remove()},300)},i)}catch(e){c.stacktrace("Toasts","Unable to show toast",e)}}static ensureContainer(){if(document.querySelector(".bd-toasts"))return;const e=document.querySelector(`.${this.ChannelsClass} + div`),t=e?e.querySelector("."+this.MembersWrapClass):null,s=e?e.querySelector("form"):null,n=e?e.getBoundingClientRect().left:310,i=t?t.getBoundingClientRect().left:0,r=i?i-e.getBoundingClientRect().left:e.offsetWidth,o=s?s.offsetHeight:80,a=document.createElement("div");a.classList.add("bd-toasts"),a.style.setProperty("left",n+"px"),a.style.setProperty("width",r+"px"),a.style.setProperty("bottom",o+"px"),C.bdBody.appendChild(a)}}var U=s(0);class _ extends O.Component{constructor(e){super(e),this.state={hasError:!1}}componentDidCatch(){this.setState({hasError:!0})}render(){return this.state.hasError?O.createElement("div",{onClick:()=>U.remote.getCurrentWindow().openDevTools(),className:"react-error"},"There was an unexpected Error. Click to open console for more details."):this.props.children}}const q=_.prototype.render;Object.defineProperty(_.prototype,"render",{enumerable:!1,configurable:!1,set:function(){c.warn("ErrorBoundary","Addon policy for plugins #5 https://github.com/rauenzi/BetterDiscordApp/wiki/Addon-Policies#plugins")},get:()=>q});class G{static get shouldShowAddonErrors(){return L.get("settings","addons","addonErrors")}static get ModalActions(){return g.getByProps("openModal","updateModal")}static get ModalStack(){return g.getByProps("push","update","pop","popWithKey")}static get ModalComponents(){return g.getByProps("ModalRoot")}static get ModalClasses(){return g.getByProps("modal","content")}static get AlertModal(){return g.getByPrototypes("handleCancel","handleSubmit","handleMinorConfirm")}static get FlexElements(){return g.getByProps("Child","Align")}static get FormTitle(){return g.findByDisplayName("FormTitle")}static get TextElement(){return g.getByProps("Sizes","Weights")}static get ConfirmationModal(){return g.findByDisplayName("ConfirmModal")}static get Markdown(){return g.findByDisplayName("Markdown")}static get Buttons(){return g.getByProps("ButtonColors")}static default(e,t){const s=h.createElement(`<div class="bd-modal-wrapper theme-dark">\n                <div class="bd-backdrop backdrop-1wrmKB"></div>\n                <div class="bd-modal modal-1UGdnR">\n                    <div class="bd-modal-inner inner-1JeGVc">\n                        <div class="header header-1R_AjF">\n                            <div class="title">${e}</div>\n                        </div>\n                        <div class="bd-modal-body">\n                            <div class="scroller-wrap fade">\n                                <div class="scroller">\n                                    ${t}\n                                </div>\n                            </div>\n                        </div>\n                        <div class="footer footer-2yfCgX footer-3rDWdC footer-2gL1pp">\n                            <button type="button" class="bd-button">${A.Modals.okay}</button>\n                        </div>\n                    </div>\n                </div>\n            </div>`);s.querySelector(".footer button").addEventListener("click",()=>{s.classList.add("closing"),setTimeout(()=>{s.remove()},300)}),s.querySelector(".bd-backdrop").addEventListener("click",()=>{s.classList.add("closing"),setTimeout(()=>{s.remove()},300)}),document.querySelector("#app-mount").append(s)}static alert(e,t){this.showConfirmationModal(e,t,{cancelText:""})}static showConfirmationModal(e,t,s={}){const n=this.Markdown,i=this.ConfirmationModal,r=this.ModalActions;if(t instanceof N&&(t=t.toString()),!this.ModalActions||!this.ConfirmationModal||!this.Markdown)return this.default(e,t);const o=()=>{},{onConfirm:a=o,onCancel:l=o,confirmText:d=A.Modals.okay,cancelText:c=A.Modals.cancel,danger:h=!1,key:p}=s;return Array.isArray(t)||(t=[t]),t=t.map(e=>"string"==typeof e?O.createElement(n,null,e):e),r.openModal(s=>O.createElement(i,Object.assign({header:e,confirmButtonColor:h?this.Buttons.ButtonColors.RED:this.Buttons.ButtonColors.PRIMARY,confirmText:d,cancelText:c,onConfirm:a,onCancel:l},s),t),{modalKey:p})}static showAddonErrors({plugins:e=[],themes:t=[]}){if(!e||!t||!this.shouldShowAddonErrors)return;if(!e.length&&!t.length)return;const s=h.createElement(`<div class="bd-modal-wrapper theme-dark">\n                        <div class="bd-backdrop backdrop-1wrmKB"></div>\n                        <div class="bd-modal bd-content-modal modal-1UGdnR">\n                            <div class="bd-modal-inner inner-1JeGVc">\n                                <div class="header header-1R_AjF"><div class="title">${A.Modals.addonErrors}</div></div>\n                                <div class="bd-modal-body">\n                                    <div class="tab-bar-container">\n                                        <div class="tab-bar TOP">\n                                            <div class="tab-bar-item">${A.Panels.plugins}</div>\n                                            <div class="tab-bar-item">${A.Panels.themes}</div>\n                                        </div>\n                                    </div>\n                                    <div class="table-header">\n                                        <div class="table-column column-name">${A.Modals.name}</div>\n                                        <div class="table-column column-message">${A.Modals.message}</div>\n                                        <div class="table-column column-error">${A.Modals.error}</div>\n                                    </div>\n                                    <div class="scroller-wrap fade">\n                                        <div class="scroller">\n\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="footer footer-2yfCgX footer-3rDWdC footer-2gL1pp">\n                                    <button type="button" class="bd-button">${A.Modals.okay}</button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>`),n=function(e){const t=h.createElement('<div class="errors">');for(const s of e){const e=h.createElement(`<div class="error">\n                                    <div class="table-column column-name">${s.name?s.name:s.file}</div>\n                                    <div class="table-column column-message">${s.message}</div>\n                                    <div class="table-column column-error"><a class="error-link" href="">${s.error?s.error.message:""}</a></div>\n                                </div>`);t.append(e),s.error&&e.querySelectorAll("a").forEach(e=>e.addEventListener("click",e=>{e.preventDefault(),c.stacktrace("AddonError",`Error details for ${s.name?s.name:s.file}.`,s.error)}))}return t},i=[n(e),n(t)];s.querySelectorAll(".tab-bar-item").forEach(e=>e.addEventListener("click",e=>{e.preventDefault();const t=s.querySelector(".tab-bar-item.selected");t&&h.removeClass(t,"selected"),h.addClass(e.target,"selected");const n=s.querySelector(".scroller");n.innerHTML="",n.append(i[h.index(e.target)])})),s.querySelector(".footer button").addEventListener("click",()=>{h.addClass(s,"closing"),setTimeout(()=>{s.remove()},300)}),s.querySelector(".bd-backdrop").addEventListener("click",()=>{h.addClass(s,"closing"),setTimeout(()=>{s.remove()},300)}),h.query("#app-mount").append(s),e.length?s.querySelector(".tab-bar-item").click():s.querySelectorAll(".tab-bar-item")[1].click()}static showChangelogModal(e={}){const t=g.getByProps("push","update","pop","popWithKey"),s=g.getByProps("fixed","improved"),n=g.findByDisplayName("Text"),r=g.getByProps("Child"),o=g.getByProps("Tags","default"),a=g.getModule(e=>e.defaultProps&&0==e.defaultProps.selectable),l=g.getByProps("defaultRules","parse");if(!(a&&t&&s&&n&&r&&o&&l))return c.warn("Modals","showChangelogModal missing modules");const{image:d="https://repository-images.githubusercontent.com/105473537/957b5480-7c26-11e9-8401-50fa820cbae5",description:h="",changes:p=[],title:u="BetterDiscord",subtitle:m="v"+i.bdVersion,footer:y}=e,b=O.createElement,v=[e.video?b("video",{src:e.video,poster:e.poster,controls:!0,className:s.video}):b("img",{src:d})];h&&v.push(b("p",null,l.parse(h)));for(let e=0;e<p.length;e++){const t=p[e],n=s[t.type]?s[t.type]:s.added,i=0==e?s.marginTop:"";v.push(b("h1",{className:`${n} ${i}`},t.title));const r=b("ul",null,t.items.map(e=>b("li",null,l.parse(e))));v.push(r)}const w=function(){return b(r.Child,{grow:1,shrink:1},b(o.default,{tag:o.Tags.H4},u),b(n,{size:n.Sizes.SMALL,color:n.Colors.STANDARD,className:s.date},m))},C=()=>{const e=g.getModule(e=>"Anchor"==e.displayName),s=g.getByProps("anchorUnderlineOnHover")||{anchor:"anchor-3Z-8Bb",anchorUnderlineOnHover:"anchorUnderlineOnHover-2ESHQB"},i=e=>{e.preventDefault(),e.stopPropagation(),t.pop(),f.InviteActions.acceptInviteAndTransitionToInviteChannel("2HScm8j")},o=e?b(e,{onClick:i},"Join our Discord Server."):b("a",{className:`${s.anchor} ${s.anchorUnderlineOnHover}`,onClick:i},"Join our Discord Server."),a=b(n,{size:n.Sizes.SMALL,color:n.Colors.STANDARD},"Need support? ",o);return b(r.Child,{grow:1,shrink:1},y||a)},S=this.ModalActions,E=g.getByProps("hideOnFullscreen"),P=E.root;P&&(E.root=P+" bd-changelog-modal");const x=S.openModal(e=>O.createElement(a,Object.assign({className:"bd-changelog "+s.container,selectable:!0,onScroll:e=>e,onClose:e=>e,renderHeader:w,renderFooter:C},e),v)),M=S.closeModal;return S.closeModal=function(e){Reflect.apply(M,this,arguments),setTimeout(()=>{P&&e===x&&(E.root=P)},1e3),S.closeModal=M},x}static showAddonSettingsModal(e,t){let s=t;(t instanceof Node||"string"==typeof t)&&(s=class extends O.Component{constructor(e){super(e),this.elementRef=O.createRef(),this.element=t}componentDidMount(){this.element instanceof Node&&this.elementRef.current.appendChild(this.element)}render(){const e={className:"bd-addon-settings-wrap",ref:this.elementRef};return"string"==typeof this.element&&(e.dangerouslySetInnerHTML={__html:this.element}),O.createElement("div",e)}}),"function"==typeof s&&(s=O.createElement(s));const n=this.ModalComponents,i=t=>O.createElement(n.ModalRoot,Object.assign({size:n.ModalSize.MEDIUM,className:"bd-addon-modal"},t),O.createElement(n.ModalHeader,{separator:!1,className:"bd-addon-modal-header"},O.createElement(this.FormTitle,{tag:"h4"},e+" Settings"),O.createElement(this.FlexElements.Child,{grow:0},O.createElement(n.ModalCloseButton,{onClick:t.onClose}))),O.createElement(n.ModalContent,{className:"bd-addon-modal-settings"},O.createElement(_,{},s)),O.createElement(n.ModalFooter,{className:"bd-addon-modal-footer"},O.createElement(this.Buttons.default,{onClick:t.onClose,className:"bd-button"},A.Modals.done)));return this.ModalActions.openModal(e=>O.createElement(i,e))}}class $ extends Error{constructor(e,t,s,n){super(s),this.name=e,this.file=t,this.error=n}}class W extends Error{constructor(e){super(e),this.name="MetaError"}}class V extends O.Component{constructor(e){super(e),this.onClick=this.onClick.bind(this),this.state={checked:this.props.checked||!1}}render(){return O.createElement("div",{className:"checkbox-item"},O.createElement("div",{className:"checkbox-label label-JWQiNe da-label"},this.props.text),O.createElement("div",{className:"checkbox-wrapper checkbox-3kaeSU da-checkbox checkbox-3EVISJ da-checkbox",onClick:this.onClick},O.createElement("div",{className:"checkbox-inner checkboxInner-3yjcPe da-checkboxInner"},O.createElement("input",{className:"checkbox checkboxElement-1qV33p da-checkboxElement",checked:this.state.checked,type:"checkbox"}),O.createElement("span",null)),O.createElement("span",null)))}onClick(){this.props.onChange(!this.state.checked),this.setState({checked:!this.state.checked})}}function Y(){return(Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e}).apply(this,arguments)}const J=g.getByDisplayName("Tooltip"),Z=["abap","abc","actionscript","ada","apache_conf","asciidoc","assembly_x86","autohotkey","batchfile","bro","c_cpp","c9search","cirru","clojure","cobol","coffee","coldfusion","csharp","csound_document","csound_orchestra","csound_score","css","curly","d","dart","diff","dockerfile","dot","drools","dummy","dummysyntax","eiffel","ejs","elixir","elm","erlang","forth","fortran","ftl","gcode","gherkin","gitignore","glsl","gobstones","golang","graphqlschema","groovy","haml","handlebars","haskell","haskell_cabal","haxe","hjson","html","html_elixir","html_ruby","ini","io","jack","jade","java","javascript","json","jsoniq","jsp","jssm","jsx","julia","kotlin","latex","less","liquid","lisp","livescript","logiql","lsl","lua","luapage","lucene","makefile","markdown","mask","matlab","maze","mel","mushcode","mysql","nix","nsis","objectivec","ocaml","pascal","perl","pgsql","php","pig","powershell","praat","prolog","properties","protobuf","python","r","razor","rdoc","red","rhtml","rst","ruby","rust","sass","scad","scala","scheme","scss","sh","sjs","smarty","snippets","soy_template","space","sql","sqlserver","stylus","svg","swift","tcl","tex","text","textile","toml","tsx","twig","typescript","vala","vbscript","velocity","verilog","vhdl","wollok","xml","xquery","yaml","django"],Q=["chrome","clouds","crimson_editor","dawn","dreamweaver","eclipse","github","iplastic","solarized_light","textmate","tomorrow","xcode","kuroir","katzenmilch","sqlserver","ambiance","chaos","clouds_midnight","cobalt","gruvbox","gob","idle_fingers","kr_theme","merbivore","merbivore_soft","mono_industrial","monokai","pastel_on_dark","solarized_dark","terminal","tomorrow_night","tomorrow_night_blue","tomorrow_night_bright","tomorrow_night_eighties","twilight","vibrant_ink"];class X extends O.Component{static get defaultId(){return"bd-editor"}constructor(e){super(e),this.props.theme=this.props.theme.toLowerCase().replace(/ /g,"_"),Q.includes(this.props.theme)||(this.props.theme=X.defaultProps.theme),this.props.language=this.props.language.toLowerCase().replace(/ /g,"_"),Z.includes(this.props.language)||(this.props.language=X.defaultProps.language),this.bindings=[],this.onChange=this.onChange.bind(this)}static get defaultProps(){return{controls:[],theme:"bd-monokai",language:"css",id:this.defaultId,fontSize:14}}static get themes(){return Q}componentDidMount(){this.editor=window.monaco.editor.create(document.getElementById(this.props.id),{value:this.props.value,language:this.props.language,theme:"light"==f.UserSettingsStore.theme?"vs":"vs-dark"}),this.bindings.push(this.editor.onDidChangeModelContent(this.onChange))}componentWillUnmount(){for(const e of this.bindings)e.dispose();this.editor.dispose()}get value(){return this.editor.getValue()}set value(e){this.editor.setValue(e)}onChange(){this.props.onChange&&this.props.onChange(this.value)}showSettings(){return this.editor.keyBinding.$defaultHandler.commands.showSettingsMenu.exec(this.editor)}resize(){return this.editor.layout()}buildControl(e){return"checkbox"==e.type?this.makeCheckbox(e):this.makeButton(e)}makeCheckbox(e){return O.createElement(V,{text:e.label,onChange:e.onChange,checked:e.checked})}makeButton(e){return O.createElement(J,{color:"black",position:"top",text:e.tooltip},t=>O.createElement("button",Y({},t,{className:"btn btn-primary",onClick:t=>{e.onClick(t,this.value)}}),e.label))}render(){this.editor&&this.editor.resize&&this.editor.layout();const e=this.props.controls.filter(e=>"right"!=e.side).map(this.buildControl.bind(this)),t=this.props.controls.filter(e=>"right"==e.side).map(this.buildControl.bind(this));return O.createElement("div",{id:"bd-editor-panel",className:this.props.theme},O.createElement("div",{id:"bd-editor-controls"},O.createElement("div",{className:"controls-section controls-left"},e),O.createElement("div",{className:"controls-section controls-right"},t)),O.createElement("div",{className:"editor-wrapper"},O.createElement("div",{id:this.props.id,className:"editor "+this.props.theme})))}}class K extends O.Component{render(){const e=this.props.size||"24px";return O.createElement("svg",{viewBox:"0 0 24 24",style:{width:e,height:e}},O.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),O.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm2 16H5V5h11.17L19 7.83V19zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3zM6 6h9v4H6z"}))}}class ee extends O.Component{render(){const e=this.props.size||"24px";return O.createElement("svg",{viewBox:"0 0 24 24",fill:"#FFFFFF",style:{width:e,height:e},onClick:this.props.onClick},O.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),O.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}}class te extends O.Component{constructor(e){super(e),this.hasUnsavedChanges=!1,this.onChange=this.onChange.bind(this),this.save=this.save.bind(this),this.openNative=this.openNative.bind(this),this.update=this.update.bind(this),this.controls=[{label:O.createElement(K,{size:"18px"}),tooltip:A.CustomCSS.save,onClick:this.save},{label:O.createElement(ee,{size:"18px"}),tooltip:A.CustomCSS.openNative,onClick:this.openNative}]}update(){this.forceUpdate()}updateEditor(e){this.editor&&(this.editor.value=e)}get value(){return this.editor.session.getValue()}set value(e){this.editor.setValue(e)}showSettings(){return this.editor.keyBinding.$defaultHandler.commands.showSettingsMenu.exec(this.editor)}resize(){return this.editor.resize()}setEditorRef(e){this.editor=e,this.props.editorRef&&void 0!==this.props.editorRef.current?this.props.editorRef.current=e:this.props.editorRef&&(this.props.editorRef=e)}render(){return O.createElement(X,{ref:this.setEditorRef.bind(this),language:this.props.language,id:this.props.id||"bd-addon-editor",controls:this.controls,value:this.props.content,onChange:this.onChange})}onChange(){this.hasUnsavedChanges=!0}save(e,t){this.hasUnsavedChanges=!1,this.props.save&&this.props.save(t)}openNative(){this.props.openNative&&this.props.openNative()}}class se{static get width(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)}static get height(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)}}class ne extends O.Component{render(){return O.createElement("svg",{viewBox:"0 0 12 12",style:{width:"18px",height:"18px"}},O.createElement("g",{className:"background",fill:"none",fillRule:"evenodd"},O.createElement("path",{d:"M0 0h12v12H0"}),O.createElement("path",{className:"fill",fill:"#dcddde",d:"M9.5 3.205L8.795 2.5 6 5.295 3.205 2.5l-.705.705L5.295 6 2.5 8.795l.705.705L6 6.705 8.795 9.5l.705-.705L6.705 6"})))}}class ie extends O.Component{render(){const e=this.props.size||"24px";return O.createElement("svg",{className:this.props.className||"",fill:"#FFFFFF",viewBox:"0 0 24 24",style:{width:e,height:e},onClick:this.props.onClick},O.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),O.createElement("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"}))}}class re extends O.Component{constructor(e){super(e),this.state={modalOpen:!1},this.offX=0,this.offY=0,this.maxX=this.props.maxX||se.width,this.maxY=this.props.maxY||se.height,this.minX=this.props.minX||0,this.minY=this.props.minY||0,this.titlebar=O.createRef(),this.window=O.createRef(),this.close=this.close.bind(this),this.maximize=this.maximize.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragStart=this.onDragStart.bind(this),this.onDragStop=this.onDragStop.bind(this),this.onResizeStart=this.onResizeStart.bind(this)}componentDidMount(){this.window.current.addEventListener("mousedown",this.onResizeStart,!1),this.titlebar.current.addEventListener("mousedown",this.onDragStart,!1),document.addEventListener("mouseup",this.onDragStop,!1)}onResizeStart(){this.currentWidth=this.window.current.offsetWidth,this.currentHeight=this.window.current.offsetHeight}onDragStop(){document.removeEventListener("mousemove",this.onDrag,!0);const e=this.window.current.offsetWidth,t=this.window.current.offsetHeight;if(e!=this.currentWidth||t!=this.currentHeight){this.props.onResize&&this.props.onResize();const s=parseInt(this.window.current.style.left),n=parseInt(this.window.current.style.top);s+e>=this.maxX&&(this.window.current.style.width=this.maxX-s+"px"),n+t>=this.maxY&&(this.window.current.style.height=this.maxY-n+"px")}this.currentWidth=e,this.currentHeight=t}onDragStart(e){const t=this.window.current;this.offY=e.clientY-parseInt(t.offsetTop),this.offX=e.clientX-parseInt(t.offsetLeft),document.addEventListener("mousemove",this.onDrag,!0)}onDrag(e){const t=this.window.current;let s=e.clientY-this.offY;s<=this.minY&&(s=this.minY),s+this.currentHeight>=this.maxY&&(s=this.maxY-this.currentHeight);let n=e.clientX-this.offX;n<=this.minX&&(n=this.minX),n+this.currentWidth>=this.maxX&&(n=this.maxX-this.currentWidth),t.style.top=s+"px",t.style.left=n+"px"}componentWillUnmount(){this.titlebar.current.removeEventListener("mousedown",this.onDragStart,!1),document.removeEventListener("mouseup",this.onDragStop,!1)}render(){const e=this.props.center?se.height/2-this.props.height/2:this.props.top,t=this.props.center?se.width/2-this.props.width/2:this.props.left,s=`floating-window${" "+this.props.className||""}${this.props.resizable?" resizable":""}${this.state.modalOpen?" modal-open":""}`,n={height:this.props.height,width:this.props.width,left:t||0,top:e||0};return O.createElement("div",{id:this.props.id,className:s,ref:this.window,style:n},O.createElement("div",{className:"floating-window-titlebar",ref:this.titlebar},O.createElement("span",{className:"title"},this.props.title),O.createElement("div",{className:"floating-window-buttons"},O.createElement("div",{className:"button maximize-button",onClick:this.maximize},O.createElement(ie,{size:"18px"})),O.createElement("div",{className:"button close-button",onClick:this.close},O.createElement(ne,null)))),O.createElement("div",{className:"floating-window-content"},this.props.children))}maximize(){this.window.current.style.width="100%",this.window.current.style.height="100%",this.props.onResize&&this.props.onResize();const e=this.window.current.offsetWidth,t=this.window.current.offsetHeight,s=parseInt(this.window.current.style.left)+e;parseInt(this.window.current.style.top)+t>this.maxY&&(this.window.current.style.top=this.maxY-t+"px"),s>this.maxX&&(this.window.current.style.left=this.maxX-e+"px");const n=parseInt(this.window.current.style.left),i=parseInt(this.window.current.style.top);if(i<this.minY){const e=this.minY-i;this.window.current.style.top=this.minY+"px",this.window.current.style.height=t-e+"px"}if(n<this.minX){const t=this.minX-n;this.window.current.style.left=this.minX+"px",this.window.current.style.height=e-t+"px"}}async close(){let e=!0;("function"==typeof this.props.confirmClose?this.props.confirmClose():this.props.confirmClose)&&(this.setState({modalOpen:!0}),e=await this.confirmClose(),this.setState({modalOpen:!1})),this.props.close&&e&&this.props.close()}confirmClose(){return new Promise(e=>{G.showConfirmationModal(A.Modals.confirmAction,this.props.confirmationText,{danger:!0,confirmText:A.Modals.close,onConfirm:()=>{e(!0)},onCancel:()=>{e(!1)}})})}}function oe(){return(oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e}).apply(this,arguments)}class ae extends O.Component{constructor(e){super(e),this.state={windows:[]}}get minY(){const e=h.query('#app-mount > div[class*="app-"]');return e?e.offsetTop:0}render(){return this.state.windows.map(e=>O.createElement(re,oe({},e,{close:this.close.bind(this,e.id),minY:this.minY,key:e.id}),e.children))}open(e){this.setState(t=>(t.windows.push(e),{windows:t.windows}))}close(e){this.setState(t=>({windows:t.windows.filter(t=>(t.id==e&&t.onClose&&t.onClose(),t.id!=e))}))}static get id(){return"floating-windows"}static get root(){if(this._root)return this._root;const e=document.createElement("div");return e.id=this.id,document.body.append(e),this._root=e}}var le=ae;const de=g.getByProps("AppReferencePositionLayer");class ce{static initialize(){const e=O.createRef(),t=O.createElement(le,{ref:e}),s=de?O.createElement(de.AppLayerProvider().props.layerContext.Provider,{value:[document.querySelector("#app-mount > .layerContainer-yqaFcK")]},t):t,n=h.createElement('<div id="floating-windows-layer">');C.bdBody.append(n),R.render(s,n),this.ref=e}static open(e){return this.ref||this.initialize(),this.ref.current.open(e)}}const he=f.React,pe=s(1),ue=s(2),me=s(4).Module;me.globalPaths.push(pe.resolve(s(0).remote.app.getAppPath(),"node_modules"));const ge=/[^\S\r\n]*?\r?(?:\r\n|\n)[^\S\r\n]*?\*[^\S\r\n]?/,fe=/^\\@/,ye=function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e};class be{get name(){return""}get moduleExtension(){return""}get extension(){return""}get duplicatePattern(){return/./}get addonFolder(){return""}get language(){return""}get prefix(){return"addon"}get collection(){return"settings"}get category(){return"addons"}get id(){return"autoReload"}emit(e,...t){return E.emit(`${this.prefix}-${e}`,...t)}constructor(){this.timeCache={},this.addonList=[],this.state={},this.windows=new Set}initialize(){return this.originalRequire=me._extensions[this.moduleExtension],me._extensions[this.moduleExtension]=this.getAddonRequire(),L.on(this.collection,this.category,this.id,e=>{e?this.watchAddons():this.unwatchAddons()}),this.loadAllAddons()}initializeAddon(){}getFileModification(e,t){return t}startAddon(){}stopAddon(){}loadState(){const e=w.getData(this.prefix+"s");e&&Object.assign(this.state,e)}saveState(){w.setData(this.prefix+"s",this.state)}watchAddons(){if(this.watcher)return c.err(this.name,`Already watching ${this.prefix} addons.`);c.log(this.name,`Starting to watch ${this.prefix} addons.`),this.watcher=ue.watch(this.addonFolder,{persistent:!1},async(e,t)=>{if(!e||!t)return;const s=pe.resolve(this.addonFolder,t);if(!t.endsWith(this.extension)){const e=t.match(this.duplicatePattern);if(!e)return;const n=e[0],i=t.replace(n,"")+this.extension;if(ue.existsSync(i))return void c.warn("AddonManager",`Duplicate files found: ${t} and ${i}`);ue.renameSync(s,pe.resolve(this.addonFolder,i))}await new Promise(e=>setTimeout(e,100));try{const n=ue.statSync(s);if(!n.isFile())return;if(!n||!n.mtime||!n.mtime.getTime())return;if("number"!=typeof n.mtime.getTime())return;if(this.timeCache[t]==n.mtime.getTime())return;this.timeCache[t]=n.mtime.getTime(),"rename"==e&&this.loadAddon(t,!0),"change"==e&&this.reloadAddon(t,!0)}catch(e){if("ENOENT"!==e.code)return;delete this.timeCache[t],this.unloadAddon(t,!0)}})}unwatchAddons(){if(!this.watcher)return c.error(this.name,`Was not watching ${this.prefix} addons.`);this.watcher.close(),delete this.watcher,c.log(this.name,`No longer watching ${this.prefix} addons.`)}extractMeta(e){const t=e.split("\n")[0];if(t.includes("//META"))return this.parseOldMeta(e);if(t.includes("/**"))return this.parseNewMeta(e);throw new W(A.Addons.metaNotFound)}parseOldMeta(e){const t=e.split("\n")[0],s=t.substring(t.lastIndexOf("//META")+6,t.lastIndexOf("*//")),n=p.testJSON(s);if(!n)throw new W(A.Addons.metaError);if(!n.name)throw new W(A.Addons.missingNameData);return n.format="json",n}parseNewMeta(e){const t=e.split("/**",2)[1].split("*/",1)[0],s={};let n="",i="";for(const e of t.split(ge))if(0!==e.length)if("@"===e.charAt(0)&&" "!==e.charAt(1)){s[n]=i;const t=e.indexOf(" ");n=e.substr(1,t-1),i=e.substr(t+1)}else i+=" "+e.replace("\\n","\n").replace(fe,"@");return s[n]=i.trim(),delete s[""],s.format="jsdoc",s}getAddonRequire(){const e=this,t=this.originalRequire;return function(s,n){const i=pe.resolve(e.addonFolder,pe.basename(n));if(!ue.existsSync(i)||n!==ue.realpathSync(i))return Reflect.apply(t,this,arguments);let r=ue.readFileSync(n,"utf8");r=ye(r);const o=ue.statSync(n),a=e.extractMeta(r);a.author||(a.author=A.Addons.unknownAuthor),a.version||(a.version="???"),a.description||(a.description=A.Addons.noDescription),a.id=a.name,a.filename=pe.basename(n),a.added=o.atimeMs,a.modified=o.mtimeMs,a.size=o.size,r=e.getFileModification(s,r,a),s._compile(r,n)}}loadAddon(e,t=!1){if(void 0===e)return;try{require(pe.resolve(this.addonFolder,e))}catch(n){return new $(e,e,A.Addons.compileError,{message:n.message,stack:n.stack})}const s=require(pe.resolve(this.addonFolder,e));if(this.addonList.find(e=>e.id==s.id))return new $(s.name,e,A.Addons.alreadyExists.format({type:this.prefix,name:s.name}));const n=this.initializeAddon(s);return n||(this.addonList.push(s),t&&H.success(`${s.name} v${s.version} was loaded.`),this.emit("loaded",s.id),this.state[s.id]?this.startAddon(s):this.state[s.id]=!1)}unloadAddon(e,t=!0,s=!1){const n="string"==typeof e?this.addonList.find(t=>t.id==e||t.filename==e):e;return!!n&&(this.state[n.id]&&(s?this.stopAddon(n):this.disableAddon(n)),delete require.cache[require.resolve(pe.resolve(this.addonFolder,n.filename))],this.addonList.splice(this.addonList.indexOf(n),1),this.emit("unloaded",n.id),t&&H.success(n.name+" was unloaded."),!0)}reloadAddon(e,t=!0){const s="string"==typeof e?this.addonList.find(t=>t.id==e||t.filename==e):e,n=this.unloadAddon(s,t,!0);return s&&!n?n:this.loadAddon(s?s.filename:e,t)}isLoaded(e){return!!this.addonList.find(t=>t.id==e||t.filename==e)}isEnabled(e){const t=this.addonList.find(t=>t.id==e||t.filename==e);return!!t&&this.state[t.id]}getAddon(e){return this.addonList.find(t=>t.id==e||t.filename==e)}enableAddon(e){const t="string"==typeof e?this.addonList.find(t=>t.id==e):e;t&&(this.state[t.id]||(this.state[t.id]=!0,this.startAddon(t),this.saveState()))}disableAddon(e){const t="string"==typeof e?this.addonList.find(t=>t.id==e):e;t&&this.state[t.id]&&(this.state[t.id]=!1,this.stopAddon(t),this.saveState())}toggleAddon(e){this.state[e]?this.disableAddon(e):this.enableAddon(e)}loadNewAddons(){const e=ue.readdirSync(this.addonFolder),t=this.addonList.filter(t=>!e.includes(t.filename)).map(e=>e.id);return{added:e.filter(e=>!this.addonList.find(t=>t.filename==e)&&e.endsWith(this.extension)&&ue.statSync(pe.resolve(this.addonFolder,e)).isFile()),removed:t}}updateList(){const e=this.loadNewAddons();for(const t of e.added)this.loadAddon(t);for(const t of e.removed)this.unloadAddon(t)}loadAllAddons(){this.loadState();const e=[],t=ue.readdirSync(this.addonFolder);for(const s of t){const t=pe.resolve(this.addonFolder,s),n=ue.statSync(t);if(!n||!n.isFile())continue;if(this.timeCache[s]=n.mtime.getTime(),!s.endsWith(this.extension)){const e=s.match(this.duplicatePattern);if(!e)continue;const n=e[0],i=s.replace(n,"")+this.extension;if(ue.existsSync(i)){c.warn("AddonManager",`Duplicate files found: ${s} and ${i}`);continue}ue.renameSync(t,pe.resolve(this.addonFolder,i))}const i=this.loadAddon(s,!1);i instanceof $&&e.push(i)}return this.saveState(),L.get(this.collection,this.category,this.id)&&this.watchAddons(),e}deleteAddon(e){const t="string"==typeof e?this.addonList.find(t=>t.id==e||t.filename==e):e;return ue.unlinkSync(pe.resolve(this.addonFolder,t.filename))}saveAddon(e,t){const s="string"==typeof e?this.addonList.find(t=>t.id==e||t.filename==e):e;return ue.writeFileSync(pe.resolve(this.addonFolder,s.filename),t)}editAddon(e,t){const n="string"==typeof e?this.addonList.find(t=>t.id==e||t.filename==e):e,i=pe.resolve(this.addonFolder,n.filename);return void 0===t&&(t="system"==L.get("settings","addons","editAction")),t?s(0).shell.openItem(""+i):this.openDetached(n)}openDetached(e){const t=pe.resolve(this.addonFolder,e.filename),s=ue.readFileSync(t).toString();if(this.windows.has(t))return;this.windows.add(t);const n=he.createRef(),i=he.createElement(te,{id:"bd-floating-editor-"+e.id,ref:n,content:s,save:this.saveAddon.bind(this,e),openNative:this.editAddon.bind(this,e,!0),language:this.language});ce.open({onClose:()=>{this.windows.delete(t)},onResize:()=>{n&&n.current&&n.current.resize&&n.current.resize()},title:e.name,id:"bd-floating-window-"+e.id,className:"floating-addon-window",height:470,width:410,center:!0,resizable:!0,children:i,confirmClose:()=>!(!n||!n.current)&&n.current.hasUnsavedChanges,confirmationText:A.Addons.confirmationText.format({name:e.name})})}}class ve extends O.Component{render(){const e=this.props.isGroup?"bd-settings-title bd-settings-group-title h5-18_1nd title-3sZWYQ size12-3R0845 height16-2Lv3qA weightSemiBold-NJexzi da-h5 da-title da-size12 da-height16 da-weightSemiBold marginBottom4-2qk4Hy da-marginBottom4 marginTop8-1DLZ1n da-marginTop8":"bd-settings-title h2-2gWE-o title-3sZWYQ size16-14cGz5 height20-mO2eIN weightSemiBold-NJexzi defaultColor-1_ajX0 defaultMarginh2-2LTaUL marginBottom20-32qID7",t=this.props.className?`${e} ${this.props.className}`:e;return O.createElement("h2",{className:t,onClick:()=>{this.props.onClick&&this.props.onClick()}},this.props.text,this.props.button&&O.createElement("button",{className:"bd-button bd-button-title",onClick:this.props.button.onClick},this.props.button.title),this.props.otherChildren)}}class we extends O.Component{render(){const e=this.props.size||"24px";return O.createElement("svg",{className:this.props.className||"",onClick:this.props.onClick,fill:"#dcddde",viewBox:"0 0 24 24",style:{width:e,height:e}},O.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),O.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}))}}class Ce extends O.Component{render(){const e=this.props.size||"24px";return O.createElement("svg",{className:this.props.className||"",fill:"#FFFFFF",viewBox:"0 0 24 24",style:{width:e,height:e},onClick:this.props.onClick},O.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),O.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),O.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}))}}class Se extends O.Component{render(){const e=this.props.size||"20px";return O.createElement("svg",{viewBox:"0 0 20 20",style:{width:e,height:e}},O.createElement("path",{fill:"none",d:"M0 0h20v20H0V0z"}),O.createElement("path",{d:"M15.95 10.78c.03-.25.05-.51.05-.78s-.02-.53-.06-.78l1.69-1.32c.15-.12.19-.34.1-.51l-1.6-2.77c-.1-.18-.31-.24-.49-.18l-1.99.8c-.42-.32-.86-.58-1.35-.78L12 2.34c-.03-.2-.2-.34-.4-.34H8.4c-.2 0-.36.14-.39.34l-.3 2.12c-.49.2-.94.47-1.35.78l-1.99-.8c-.18-.07-.39 0-.49.18l-1.6 2.77c-.1.18-.06.39.1.51l1.69 1.32c-.04.25-.07.52-.07.78s.02.53.06.78L2.37 12.1c-.15.12-.19.34-.1.51l1.6 2.77c.1.18.31.24.49.18l1.99-.8c.42.32.86.58 1.35.78l.3 2.12c.04.2.2.34.4.34h3.2c.2 0 .37-.14.39-.34l.3-2.12c.49-.2.94-.47 1.35-.78l1.99.8c.18.07.39 0 .49-.18l1.6-2.77c.1-.18.06-.39-.1-.51l-1.67-1.32zM10 13c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3z"}))}}class Ee extends O.Component{constructor(e){super(e),this.state={checked:this.props.checked},this.onChange=this.onChange.bind(this)}onChange(){this.props.disabled||(this.props.onChange(!this.state.checked),this.setState({checked:!this.state.checked}))}render(){const e=this.props.disabled?" bd-switch-disabled":"",t=this.state.checked?" bd-switch-checked":"";return O.createElement("div",{className:"bd-switch"+e+t},O.createElement("input",{type:"checkbox",id:this.props.id,className:"bd-checkbox",disabled:this.props.disabled,checked:this.state.checked,onChange:this.onChange}))}}class Pe extends O.Component{render(){const e=this.props.size||"18px";return O.createElement("svg",{viewBox:"0 0 24 24",fill:"#FFFFFF",style:{width:e,height:e},onClick:this.props.onClick},O.createElement("path",{d:"m12 .5c-6.63 0-12 5.28-12 11.792 0 5.211 3.438 9.63 8.205 11.188.6.111.82-.254.82-.567 0-.28-.01-1.022-.015-2.005-3.338.711-4.042-1.582-4.042-1.582-.546-1.361-1.335-1.725-1.335-1.725-1.087-.731.084-.716.084-.716 1.205.082 1.838 1.215 1.838 1.215 1.07 1.803 2.809 1.282 3.495.981.108-.763.417-1.282.76-1.577-2.665-.295-5.466-1.309-5.466-5.827 0-1.287.465-2.339 1.235-3.164-.135-.298-.54-1.497.105-3.121 0 0 1.005-.316 3.3 1.209.96-.262 1.98-.392 3-.398 1.02.006 2.04.136 3 .398 2.28-1.525 3.285-1.209 3.285-1.209.645 1.624.24 2.823.12 3.121.765.825 1.23 1.877 1.23 3.164 0 4.53-2.805 5.527-5.475 5.817.42.354.81 1.077.81 2.182 0 1.578-.015 2.846-.015 3.229 0 .309.21.678.825.56 4.801-1.548 8.236-5.97 8.236-11.173 0-6.512-5.373-11.792-12-11.792z"}))}}class xe extends O.Component{render(){const e=this.props.size||"18px";return O.createElement("svg",{viewBox:"2 2 20 20",fill:"#FFFFFF",style:{width:e,height:e},onClick:this.props.onClick},O.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),O.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"}))}}class Me extends O.Component{render(){const e=this.props.size||"18px";return O.createElement("svg",{viewBox:"2 2 20 20",fill:"#FFFFFF",style:{width:e,height:e},onClick:this.props.onClick},O.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),O.createElement("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"}))}}class ke extends O.Component{render(){const e=this.props.size||"18px";return O.createElement("svg",{viewBox:"0 0 24 24",fill:"#FFFFFF",style:{width:e,height:e},onClick:this.props.onClick},O.createElement("path",{d:"m0 .5h4.219v23h-4.219z"}),O.createElement("path",{d:"m15.384.5c-4.767 0-8.644 3.873-8.644 8.633 0 4.75 3.877 8.61 8.644 8.61 4.754 0 8.616-3.865 8.616-8.61 0-4.759-3.863-8.633-8.616-8.633z"}))}}class De extends O.Component{render(){const e=this.props.size||"18px";return O.createElement("svg",{viewBox:"2 2 20 20",fill:"#FFFFFF",style:{width:e,height:e},onClick:this.props.onClick},O.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),O.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"}))}}function Ne(){return(Ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e}).apply(this,arguments)}const Ae={website:Me,source:Pe,invite:De,donate:xe,patreon:ke},Le=g.getByDisplayName("Tooltip"),Be=g.getByProps("markdownToReact");class Te extends O.Component{constructor(e){super(e),this.state={settingsOpen:!1},this.settingsPanel="",this.panelRef=O.createRef(),this.onChange=this.onChange.bind(this),this.reload=this.reload.bind(this),this.showSettings=this.showSettings.bind(this)}showSettings(){if(!this.props.hasSettings||!this.props.enabled)return;const e=this.getString(this.props.addon.name);try{G.showAddonSettingsModal(e,this.props.getSettingsPanel())}catch(t){H.show(A.Addons.settingsError.format({name:e}),{type:"error"}),c.stacktrace("Addon Settings","Unable to get settings panel for "+e+".",t)}}reload(){this.props.reload&&(this.props.addon=this.props.reload(this.props.addon.id),this.forceUpdate())}getString(e){return"string"==typeof e?e:e.toString()}onChange(){this.props.onChange&&this.props.onChange(this.props.addon.id),this.props.enabled=!this.props.enabled,this.forceUpdate()}buildTitle(e,t,s){const n=A.Addons.title.split(/({{[A-Za-z]+}})/),i=n.findIndex(e=>"{{name}}"==e);i&&(n[i]=O.createElement("span",{className:"bd-name"},e));const r=n.findIndex(e=>"{{version}}"==e);i&&(n[r]=O.createElement("span",{className:"bd-version"},t));const o=n.findIndex(e=>"{{author}}"==e);return i&&(n[o]=O.createElement("span",{className:"bd-author"},s)),n.flat()}buildLink(e){const t=this.props.addon[e];if(!t)return null;const s=O.createElement(Ae[e]),n=O.createElement("a",{className:"bd-link bd-link-website",href:t,target:"_blank",rel:"noopener noreferrer"},s);return"invite"==e&&(n.props.onClick=function(e){e.preventDefault(),e.stopPropagation();let s=t;const n=/\.gg\/(.*)$/;n.test(s)&&(s=s.match(n)[1]),f.LayerStack.popLayer(),f.InviteActions.acceptInviteAndTransitionToInviteChannel(s)}),this.makeButton(A.Addons[e],n)}get controls(){return O.createElement("div",{className:"bd-controls"},this.props.hasSettings&&this.makeControlButton(A.Addons.addonSettings,O.createElement(Se,{size:"20px"}),this.showSettings,{disabled:!this.props.enabled}),this.props.showReloadIcon&&this.makeControlButton(A.Addons.reload,O.createElement(we,{size:"20px"}),this.reload),this.props.editAddon&&this.makeControlButton(A.Addons.editAddon,O.createElement(ee,{size:"20px"}),this.props.editAddon),this.props.deleteAddon&&this.makeControlButton(A.Addons.deleteAddon,O.createElement(Ce,{size:"20px"}),this.props.deleteAddon,{danger:!0}))}get footer(){const e=["website","source","invite","donate","patreon"].map(this.buildLink.bind(this)).filter(e=>e);return O.createElement("div",{className:"bd-footer"},O.createElement("span",{className:"bd-links"},e),this.controls)}makeButton(e,t,s){return O.createElement(Le,{color:"black",position:"top",text:e},e=>O.createElement("div",Ne({},e,{className:"bd-addon-button",onClick:s}),t))}makeControlButton(e,t,s,{danger:n=!1,disabled:i=!1}={}){return O.createElement(Le,{color:"black",position:"top",text:e},e=>O.createElement("button",Ne({},e,{className:"bd-button bd-addon-button"+(n?" bd-button-danger":"")+(i?" bd-button-disabled":""),onClick:s}),t))}render(){const e=this.props.addon,t=this.getString(e.name),s=this.getString(e.author),n=this.getString(e.description),i=this.getString(e.version);return O.createElement("div",{id:e.id+"-card",className:"bd-addon-card settings-closed"},O.createElement("div",{className:"bd-addon-header"},O.createElement("span",{className:"bd-title"},this.buildTitle(t,i,s)),O.createElement(Ee,{checked:this.props.enabled,onChange:this.onChange})),O.createElement("div",{className:"bd-description-wrap scroller-wrap fade"},O.createElement("div",{className:"bd-description scroller"},Be.markdownToReact(n))),this.footer)}}const je=Te.prototype.render;Object.defineProperty(Te.prototype,"render",{enumerable:!1,configurable:!1,set:function(){c.warn("AddonCard","Addon policy for plugins #5 https://github.com/rauenzi/BetterDiscordApp/wiki/Addon-Policies#plugins")},get:()=>je});class Fe extends O.Component{render(){const e=this.props.size||"16px";return O.createElement("svg",{className:this.props.className||"",fill:"#FFFFFF",viewBox:"0 0 24 24",style:{width:e,height:e}},O.createElement("path",{d:"M8.12 9.29L12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41 0L6.7 10.7c-.39-.39-.39-1.02 0-1.41.39-.38 1.03-.39 1.42 0z"}))}}class ze extends O.Component{constructor(e){super(e),this.state={open:!1,value:this.props.value||this.props.options[0].value},this.dropdown=O.createRef(),this.onChange=this.onChange.bind(this),this.showMenu=this.showMenu.bind(this),this.hideMenu=this.hideMenu.bind(this)}showMenu(e){e.preventDefault(),this.setState({open:!0},()=>{document.addEventListener("click",this.hideMenu)})}hideMenu(){this.setState({open:!1},()=>{document.removeEventListener("click",this.hideMenu)})}onChange(e){this.setState({value:e}),this.props.onChange&&this.props.onChange(e)}get selected(){return this.props.options.find(e=>e.value==this.state.value)}get options(){const e=this.selected;return O.createElement("div",{className:"bd-select-options"},this.props.options.map(t=>O.createElement("div",{className:"bd-select-option"+(e.value==t.value?" selected":""),onClick:this.onChange.bind(this,t.value)},t.label)))}render(){const e="transparent"==this.props.style?" bd-select-transparent":"",t=this.state.open?" menu-open":"";return O.createElement("div",{className:`bd-select${e}${t}`,onClick:this.showMenu,ref:this.dropdown},O.createElement("div",{className:"bd-select-value"},this.selected.label),O.createElement(Fe,{className:"bd-select-arrow"}),this.state.open&&this.options)}}class Ie extends O.Component{render(){const e=this.props.size||"16px";return O.createElement("svg",{className:this.props.className||"",fill:"#FFFFFF",viewBox:"0 0 24 24",style:{width:e,height:e}},O.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),O.createElement("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}))}}class Oe extends O.Component{constructor(e){super(e),this.state={value:this.props.value},this.onChange=this.onChange.bind(this)}onChange(e){this.setState({value:e.target.value}),this.props.onChange&&this.props.onChange(e)}render(){return O.createElement("div",{className:"bd-search-wrapper"+(this.props.className?" "+this.props.className:"")},O.createElement("input",{onChange:this.onChange,onKeyDown:this.props.onKeyDown,type:"text",className:"bd-search",placeholder:this.props.placeholder,maxLength:"50",value:this.state.value}),O.createElement(Ie,null))}}class Re extends O.Component{render(){const e=this.props.size||"20px";return O.createElement("svg",{viewBox:"2 2 20 20",fill:"#FFFFFF",style:{width:e,height:e}},O.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),O.createElement("path",{d:"M4 18h17v-6H4v6zM4 5v6h17V5H4z"}))}}class He extends O.Component{render(){const e=this.props.size||"20px";return O.createElement("svg",{viewBox:"2 2 20 20",fill:"#FFFFFF",style:{width:e,height:e}},O.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),O.createElement("path",{d:"M4 11h5V5H4v6zm0 7h5v-6H4v6zm6 0h5v-6h-5v6zm6 0h5v-6h-5v6zm-6-7h5V5h-5v6zm6-6v6h5V5h-5z"}))}}class Ue extends O.Component{render(){const e=this.props.size||"160px";return O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",style:{width:e,height:e},viewBox:"0 0 160 160"},O.createElement("g",{fill:"none",fillRule:"evenodd"},O.createElement("g",{transform:"translate(9 9)"},O.createElement("path",{fill:"rgba(0,0,0,0.1)",d:"M42.1262,100.7598 C25.1382,83.7718 25.1382,56.2288 42.1262,39.2408 C59.1142,22.2538 86.6572,22.2538 103.6452,39.2408 C120.6322,56.2288 120.6322,83.7718 103.6452,100.7598 C86.6572,117.7478 59.1142,117.7478 42.1262,100.7598"}),O.createElement("path",{stroke:"#1E2126",strokeWidth:"2",d:"M121.8938,119.4976 C94.5578,146.8346 50.2358,146.8346 22.8988,119.4976 C-4.4382,92.1616 -4.4382,47.8396 22.8988,20.5026 C50.2358,-6.8334 94.5578,-6.8344 121.8938,20.5026 C149.2308,47.8396 149.2308,92.1616 121.8938,119.4976 Z",strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"4 5"}),O.createElement("path",{fill:"#C9D2F0",d:"M1.8313,140.566 L1.8313,140.566 C-0.6097,138.125 -0.6097,134.166 1.8313,131.725 L38.6023,94.954 L47.4433,103.795 L10.6723,140.566 C8.2303,143.007 4.2723,143.007 1.8313,140.566"}),O.createElement("path",{stroke:"#1E2126",strokeWidth:"2",d:"M1.8313,140.566 L1.8313,140.566 C-0.6097,138.125 -0.6097,134.166 1.8313,131.725 L38.6023,94.954 L47.4433,103.795 L10.6723,140.566 C8.2303,143.007 4.2723,143.007 1.8313,140.566 Z",strokeLinecap:"round",strokeLinejoin:"round"}),O.createElement("path",{fill:"#9F7373",d:"M12.1457,139.0923 L3.3047,130.2513 C1.6767,128.6233 1.6767,125.9853 3.3047,124.3573 L20.7417,106.9203 C22.3687,105.2923 25.0077,105.2923 26.6357,106.9203 L35.4767,115.7613 C37.1037,117.3893 37.1037,120.0283 35.4767,121.6553 L18.0397,139.0923 C16.4127,140.7193 13.7727,140.7193 12.1457,139.0923"}),O.createElement("path",{stroke:"#1E2126",strokeWidth:"2",d:"M12.1457,139.0923 L3.3047,130.2513 C1.6767,128.6233 1.6767,125.9853 3.3047,124.3573 L20.7417,106.9203 C22.3687,105.2923 25.0077,105.2923 26.6357,106.9203 L35.4767,115.7613 C37.1037,117.3893 37.1037,120.0283 35.4767,121.6553 L18.0397,139.0923 C16.4127,140.7193 13.7727,140.7193 12.1457,139.0923 Z",strokeLinecap:"round",strokeLinejoin:"round"}),O.createElement("path",{fill:"#F3F9FF",d:"M44.112,98.2847 C28.491,82.6637 28.491,57.3377 44.112,41.7167 C59.733,26.0957 85.06,26.0957 100.681,41.7157 C116.302,57.3367 116.302,82.6637 100.681,98.2847 C85.06,113.9057 59.733,113.9057 44.112,98.2847 M108.007,34.3897 C88.34,14.7227 56.453,14.7227 36.786,34.3897 C17.119,54.0567 17.119,85.9437 36.786,105.6107 C56.453,125.2777 88.34,125.2777 108.007,105.6107 C127.674,85.9437 127.674,54.0567 108.007,34.3897"}),O.createElement("path",{stroke:"#1E2126",strokeWidth:"2",d:"M116.386 94.545C115.853 95.498 115.287 96.438 114.688 97.362M108.0071 105.6109C88.3401 125.2779 56.4531 125.2779 36.7861 105.6109 17.1191 85.9439 17.1191 54.0569 36.7861 34.3899 56.4531 14.7229 88.3401 14.7229 108.0071 34.3899 122.7701 49.1529 126.4511 70.7999 119.0511 88.9969",strokeLinecap:"round",strokeLinejoin:"round"}),O.createElement("path",{stroke:"#1E2126",strokeWidth:"2",d:"M44.112,98.2847 C28.491,82.6637 28.491,57.3377 44.112,41.7167 C59.733,26.0957 85.06,26.0957 100.681,41.7157 C116.302,57.3367 116.302,82.6637 100.681,98.2847 C85.06,113.9057 59.733,113.9057 44.112,98.2847 Z",strokeLinecap:"round",strokeLinejoin:"round"})),O.createElement("rect",{width:"160",height:"160",y:"-1"})))}}class _e extends O.Component{render(){return O.createElement("div",{className:"bd-empty-results"+(this.props.className?" "+this.props.className:"")},O.createElement(Ue,null),f.Strings.SEARCH_NO_RESULTS||"")}}const qe=g.getByProps("emptyImage")||{},Ge=g.getByProps("markdownToReact");class $e extends O.Component{render(){return O.createElement("div",{className:"bd-empty-image-container "+qe.emptyContainer+(this.props.className?" "+this.props.className:"")},O.createElement("div",{className:"bd-empty-image "+qe.emptyImage}),O.createElement("div",{className:"bd-empty-image-header "+qe.emptyHeader},this.props.title||"You don't have anything!"),O.createElement("div",{className:"bd-empty-image-message"},Ge.markdownToReact(this.props.message||"You should probably get something.")),this.props.children)}}function We(){return(We=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e}).apply(this,arguments)}const Ve=g.getByDisplayName("Tooltip");class Ye extends O.Component{constructor(e){super(e),this.state={sort:"name",ascending:!0,query:"",view:"list"},this.sort=this.sort.bind(this),this.reverse=this.reverse.bind(this),this.search=this.search.bind(this),this.update=this.update.bind(this),this.listView=this.listView.bind(this),this.gridView=this.gridView.bind(this),this.openFolder=this.openFolder.bind(this)}componentDidMount(){E.on(this.props.prefix+"-loaded",this.update),E.on(this.props.prefix+"-unloaded",this.update)}componentWillUnmount(){E.off(this.props.prefix+"-loaded",this.update),E.off(this.props.prefix+"-unloaded",this.update)}update(){this.forceUpdate()}listView(){this.setState({view:"list"})}gridView(){this.setState({view:"grid"})}reload(){this.props.refreshList&&this.props.refreshList(),this.forceUpdate()}reverse(e){this.setState({ascending:e})}sort(e){this.setState({sort:e})}search(e){this.setState({query:e.target.value.toLocaleLowerCase()})}openFolder(){const e=s(0).shell;(e.openItem||e.openPath)(this.props.folder)}get sortOptions(){return[{label:A.Addons.name,value:"name"},{label:A.Addons.author,value:"author"},{label:A.Addons.version,value:"version"},{label:A.Addons.added,value:"added"},{label:A.Addons.modified,value:"modified"}]}get directions(){return[{label:A.Sorting.ascending,value:!0},{label:A.Sorting.descending,value:!1}]}get emptyImage(){return O.createElement($e,{title:A.Addons.blankSlateHeader.format({type:this.props.title}),message:A.Addons.blankSlateMessage.format({link:"https://betterdiscordlibrary.com/themes",type:this.props.title}).toString()},O.createElement("button",{className:"bd-button",onClick:this.openFolder},A.Addons.openFolder.format({type:this.props.title})))}makeControlButton(e,t,s,n=!1){return O.createElement(Ve,{color:"black",position:"top",text:e},e=>O.createElement("button",We({},e,{className:"bd-button bd-view-button"+(n?" selected":""),onClick:s}),t))}render(){const{title:e,folder:t,addonList:s,addonState:n,onChange:i,reload:r}=this.props,o=!L.get("settings","addons","autoReload"),a=t?{title:A.Addons.openFolder.format({type:e}),onClick:this.openFolder}:null;let l=s.sort((e,t)=>{const s=e[this.state.sort],n=t[this.state.sort];return"string"==typeof s?s.toLocaleLowerCase().localeCompare(n.toLocaleLowerCase()):s>n?1:n>s?-1:0});return this.state.ascending||l.reverse(),this.state.query&&(l=l.filter(e=>{let t=e.name.toLocaleLowerCase().includes(this.state.query);return t=t||e.author.toLocaleLowerCase().includes(this.state.query),t=t||e.description.toLocaleLowerCase().includes(this.state.query),!!t})),[O.createElement(ve,{key:"title",text:e,button:a,otherChildren:o&&O.createElement(we,{className:"bd-reload",onClick:this.reload.bind(this)})}),O.createElement("div",{className:"bd-controls bd-addon-controls"},O.createElement(Oe,{onChange:this.search,placeholder:A.Addons.search.format({type:this.props.title})+"..."}),O.createElement("div",{className:"bd-controls-advanced"},O.createElement("div",{className:"bd-addon-dropdowns"},O.createElement("div",{className:"bd-select-wrapper"},O.createElement("label",{className:"bd-label"},A.Sorting.sortBy,":"),O.createElement(ze,{options:this.sortOptions,onChange:this.sort,style:"transparent"})),O.createElement("div",{className:"bd-select-wrapper"},O.createElement("label",{className:"bd-label"},A.Sorting.order,":"),O.createElement(ze,{options:this.directions,onChange:this.reverse,style:"transparent"}))),O.createElement("div",{className:"bd-addon-views"},this.makeControlButton("List View",O.createElement(Re,null),this.listView,"list"===this.state.view),this.makeControlButton("Grid View",O.createElement(He,null),this.gridView,"grid"===this.state.view)))),O.createElement("div",{key:"addonList",className:"bd-addon-list"+("grid"==this.state.view?" bd-grid-view":"")},l.map(e=>{const t=e.instance&&"function"==typeof e.instance.getSettingsPanel,s=t&&e.instance.getSettingsPanel.bind(e.instance);return O.createElement(_,null,O.createElement(Te,{editAddon:this.editAddon.bind(this,e.id),deleteAddon:this.deleteAddon.bind(this,e.id),showReloadIcon:o,key:e.id,enabled:n[e.id],addon:e,onChange:i,reload:r,hasSettings:t,getSettingsPanel:s}))}),0===this.props.addonList.length&&this.emptyImage,this.state.query&&0==l.length&&0!==this.props.addonList.length&&O.createElement(_e,null))]}editAddon(e){this.props.editAddon&&this.props.editAddon(e)}async deleteAddon(e){const t=this.props.addonList.find(t=>t.id==e);await this.confirmDelete(t)&&this.props.deleteAddon&&this.props.deleteAddon(t)}confirmDelete(e){return new Promise(t=>{G.showConfirmationModal(A.Modals.confirmAction,A.Addons.confirmDelete.format({name:e.name}),{danger:!0,confirmText:A.Addons.deleteAddon,onConfirm:()=>{t(!0)},onCancel:()=>{t(!1)}})})}}const Je=Ye.prototype.render;Object.defineProperty(Ye.prototype,"render",{enumerable:!1,configurable:!1,set:function(){c.warn("AddonList","Addon policy for plugins #5 https://github.com/rauenzi/BetterDiscordApp/wiki/Addon-Policies#plugins")},get:()=>Je});class Ze extends O.Component{render(){return O.createElement("div",{className:"bd-divider divider-3573oO marginTop8-1DLZ1n marginBottom40-2vIwTv"})}}class Qe extends O.Component{render(){return O.createElement("div",{className:"bd-setting-item"},O.createElement("div",{className:"bd-setting-header"},O.createElement("label",{htmlFor:this.props.id,className:"bd-setting-title"},this.props.name),this.props.children),O.createElement("div",{className:"bd-setting-note"},this.props.note),O.createElement("div",{className:"bd-setting-divider"}))}}class Xe extends O.Component{constructor(e){if(super(e),this.props.button&&this.props.collapsible){const e=this.props.button.onClick;this.props.button.onClick=t=>{t.stopPropagation(),e(...arguments)}}this.props.hasOwnProperty("shown")||(this.props.shown=!0),this.container=O.createRef(),this.state={collapsed:this.props.collapsible&&!this.props.shown},this.onChange=this.onChange.bind(this),this.toggleCollapse=this.toggleCollapse.bind(this)}toggleCollapse(){const e=this.container.current,t=this.state.collapsed?300:1;e.style.setProperty("height",e.scrollHeight+"px"),e.classList.add("animating"),this.setState({collapsed:!this.state.collapsed},()=>setTimeout(()=>{e.style.setProperty("height",""),e.classList.remove("animating")},t)),this.props.onDrawerToggle&&this.props.onDrawerToggle(this.state.collapsed)}onChange(e,t){this.props.onChange&&(this.props.id?this.props.onChange(this.props.id,e,t):this.props.onChange(e,t),this.forceUpdate())}render(){const{settings:e}=this.props,t="bd-settings-group "+(this.props.collapsible?"collapsible "+(this.state.collapsed?"collapsed":"expanded"):"");return O.createElement("div",{className:t},O.createElement(ve,{text:this.props.name,collapsible:this.props.collapsible,onClick:this.toggleCollapse,button:this.props.button,isGroup:!0}),O.createElement("div",{className:"bd-settings-container",ref:this.container},e.filter(e=>!e.hidden).map(e=>{let t=null;return"dropdown"==e.type&&(t=O.createElement(ze,{disabled:e.disabled,id:e.id,options:e.options,value:e.value,onChange:this.onChange.bind(this,e.id)})),"switch"==e.type&&(t=O.createElement(Ee,{disabled:e.disabled,id:e.id,checked:e.value,onChange:this.onChange.bind(this,e.id)})),t?O.createElement(Qe,{id:e.id,key:e.id,name:e.name,note:e.note},t):null})),this.props.showDivider&&O.createElement(Ze,null))}}const Ke=Xe.prototype.render;Object.defineProperty(Xe.prototype,"render",{enumerable:!1,configurable:!1,set:function(){c.warn("Group","Addon policy for plugins #5 https://github.com/rauenzi/BetterDiscordApp/wiki/Addon-Policies#plugins")},get:()=>Ke});class et extends O.Component{render(){const e=this.props.size||"18px";return O.createElement("svg",{viewBox:"0 0 24 24",fill:"#FFFFFF",className:this.props.className||"",style:{width:e,height:e},onClick:this.props.onClick},O.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),O.createElement("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"}))}}function tt(){return(tt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e}).apply(this,arguments)}const st=g.getModule(e=>e.Header&&e.Separator&&e.Item),nt=g.getByDisplayName("Tooltip");class it extends O.Component{render(){return O.createElement("div",{className:"bd-sidebar-header"},O.createElement(st.Header,null,"BetterDiscord"),O.createElement(nt,{color:"black",position:"top",text:"Changelog"},e=>O.createElement("div",tt({},e,{className:"bd-changelog-button",onClick:()=>G.showChangelogModal(l)}),O.createElement(et,{className:"bd-icon",size:"16px"}))))}}var rt=new class{constructor(){this.patchSections(),E.on("strings-updated",this.forceUpdate)}onDrawerToggle(e,t,s){const n=w.getBDData("drawerStates")||{};n[e]||(n[e]={}),n[e][t]=s,w.setBDData("drawerStates",n)}getDrawerState(e,t,s){const n=w.getBDData("drawerStates")||{};return n[e]&&n[e].hasOwnProperty(t)?n[e][t]:s}onChange(e){return(t,s,n)=>{const i=L.collections.length+L.panels.length;e(t,s,n);i!=L.collections.length+L.panels.length&&setTimeout(this.forceUpdate.bind(this),50)}}buildSettingsPanel(e,t,s,n,i,r=null){return s.forEach(e=>{e.settings.forEach(t=>t.value=n[e.id][t.id])}),this.getSettingsPanel(e,t,s,this.onChange(i),r)}getSettingsPanel(e,t,s,n,i=null){return[O.createElement(ve,{text:t,button:i}),s.map(t=>O.createElement(Xe,Object.assign({},t,{onChange:n,onDrawerToggle:s=>this.onDrawerToggle(e,t.id,s),shown:this.getDrawerState(e,t.id,!t.hasOwnProperty("shown")||t.shown)})))]}getAddonPanel(e,t,s,n={}){return O.createElement(Ye,Object.assign({},{title:e,addonList:t,addonState:s},n))}async patchSections(){const e=await I.get("UserSettings",e=>e.prototype&&e.prototype.generateSections);B.after("SettingsManager",e.prototype,"render",e=>{e._reactInternalFiber.return.return.return.return.return.return.return.memoizedProps.id="user-settings"}),B.after("SettingsManager",e.prototype,"generateSections",(e,t,s)=>{let n=s.findIndex(e=>"linux"==e.section.toLowerCase())+1;const i=e=>{s.splice(n,0,e),n++};i({section:"DIVIDER"}),i({section:"CUSTOM",element:it});for(const e of L.collections)e.disabled||i({section:e.name,label:e.name,element:()=>this.buildSettingsPanel(e.id,e.name,e.settings,L.state[e.id],L.onSettingChange.bind(L,e.id),e.button?e.button:null)});for(const t of L.panels.sort((e,t)=>e.order>t.order))t.clickListener&&(t.onClick=n=>t.clickListener(e,n,s)),i(t)}),this.forceUpdate()}forceUpdate(){const e=g.getByProps("standardSidebarView").standardSidebarView.split(" ")[0],t=document.querySelector("."+e);if(!t)return;const s=p.findInReactTree(p.getReactInstance(t),e=>e&&e.generateSections,{walkable:["return","stateNode"]});s&&s.forceUpdate()}};const ot=s(1),at=s(0).remote;var lt=new class extends be{get name(){return"PluginManager"}get moduleExtension(){return".js"}get extension(){return".plugin.js"}get duplicatePattern(){return/\.plugin\([0-9]+\)\.js/}get addonFolder(){return ot.resolve(i.dataPath,"plugins")}get prefix(){return"plugin"}get language(){return"javascript"}constructor(){super(),this.onSwitch=this.onSwitch.bind(this),this.observer=new MutationObserver(e=>{for(let t=0,s=e.length;t<s;t++)this.onMutation(e[t])})}initialize(){const e=super.initialize();return this.setupFunctions(),L.registerPanel("plugins",A.Panels.plugins,{element:()=>rt.getAddonPanel(A.Panels.plugins,this.addonList,this.state,{folder:this.addonFolder,onChange:this.togglePlugin.bind(this),reload:this.reloadPlugin.bind(this),refreshList:this.updatePluginList.bind(this),saveAddon:this.saveAddon.bind(this),editAddon:this.editAddon.bind(this),deleteAddon:this.deleteAddon.bind(this),prefix:this.prefix})}),e}updatePluginList(){return this.updateList()}loadAllPlugins(){return this.loadAllAddons()}enablePlugin(e){return this.enableAddon(e)}disablePlugin(e){return this.disableAddon(e)}togglePlugin(e){return this.toggleAddon(e)}unloadPlugin(e){return this.unloadAddon(e)}loadPlugin(e){return this.loadAddon(e)}loadAddon(e){const t=super.loadAddon(e);t&&G.showAddonErrors({plugins:[t]})}reloadPlugin(e){const t=this.reloadAddon(e);return t&&G.showAddonErrors({plugins:[t]}),"string"==typeof e?this.addonList.find(t=>t.id==e||t.filename==e):e}initializeAddon(e){if(!e.exports)return new $(e.name,e.filename,"Plugin had no exports",{message:"Plugin had no exports or no name property.",stack:""});try{const t=new(0,e.exports);e.instance=t,e.name=t.getName()||e.name,e.author=t.getAuthor()||e.author||"No author",e.description=t.getDescription()||e.description||"No description",e.version=t.getVersion()||e.version||"No version";try{"function"==typeof e.instance.load&&e.instance.load()}catch(t){return this.state[e.id]=!1,new $(e.name,e.filename,"load() could not be fired.",{message:t.message,stack:t.stack})}}catch(t){return new $(e.name,e.filename,"Could not be constructed.",{message:t.message,stack:t.stack})}}getFileModification(e,t,s){return t+=`\nif (module.exports.default) {module.exports = module.exports.default;}\nif (!module.exports.prototype || !module.exports.prototype.start) {module.exports = ${s.exports||s.name};}`,e._compile(t,e.filename),s.exports=e.exports,e.exports=s,""}startAddon(e){return this.startPlugin(e)}stopAddon(e){return this.stopPlugin(e)}getAddon(e){return this.getPlugin(e)}startPlugin(e){const t="string"==typeof e?this.addonList.find(t=>t.id==e):e;if(!t)return;const s=t.instance;try{s.start()}catch(e){return this.state[t.id]=!1,H.error(A.Addons.couldNotStart.format({name:t.name,version:t.version})),c.stacktrace(this.name,t.name+" could not be started.",e),new $(t.name,t.filename,A.Addons.enabled.format({method:"start()"}),{message:e.message,stack:e.stack})}this.emit("started",t.id),H.show(A.Addons.enabled.format({name:t.name,version:t.version}))}stopPlugin(e){const t="string"==typeof e?this.addonList.find(t=>t.id==e):e;if(!t)return;const s=t.instance;try{s.stop()}catch(e){return this.state[t.id]=!1,H.error(A.Addons.couldNotStop.format({name:t.name,version:t.version})),c.stacktrace(this.name,t.name+" could not be stopped.",e),new $(t.name,t.filename,A.Addons.enabled.format({method:"stop()"}),{message:e.message,stack:e.stack})}this.emit("stopped",t.id),H.show(A.Addons.disabled.format({name:t.name,version:t.version}))}getPlugin(e){const t=this.addonList.find(t=>t.id==e||t.filename==e);if(t)return t.instance}setupFunctions(){at.getCurrentWebContents().on("did-navigate-in-page",this.onSwitch.bind(this)),this.observer.observe(document,{childList:!0,subtree:!0})}onSwitch(){this.emit("page-switch");for(let e=0;e<this.addonList.length;e++){const t=this.addonList[e].instance;if(this.state[this.addonList[e].id]&&"function"==typeof t.onSwitch)try{t.onSwitch()}catch(t){c.stacktrace(this.name,"Unable to fire onSwitch for "+this.addonList[e].name+".",t)}}}onMutation(e){for(let t=0;t<this.addonList.length;t++){const s=this.addonList[t].instance;if(this.state[this.addonList[t].id]&&"function"==typeof s.observer)try{s.observer(e)}catch(e){c.stacktrace(this.name,"Unable to fire observer for "+this.addonList[t].name+".",e)}}}};const dt=s(1);var ct=new class extends be{get name(){return"ThemeManager"}get moduleExtension(){return".css"}get extension(){return".theme.css"}get duplicatePattern(){return/\.theme\([0-9]+\)\.css/}get addonFolder(){return dt.resolve(i.dataPath,"themes")}get prefix(){return"theme"}get language(){return"css"}initialize(){const e=super.initialize();return L.registerPanel("themes",A.Panels.themes,{element:()=>rt.getAddonPanel(A.Panels.themes,this.addonList,this.state,{folder:this.addonFolder,onChange:this.toggleTheme.bind(this),reload:this.reloadTheme.bind(this),refreshList:this.updateThemeList.bind(this),saveAddon:this.saveAddon.bind(this),editAddon:this.editAddon.bind(this),deleteAddon:this.deleteAddon.bind(this),prefix:this.prefix})}),e}updateThemeList(){return this.updateList()}loadAllThemes(){return this.loadAllAddons()}enableTheme(e){return this.enableAddon(e)}disableTheme(e){return this.disableAddon(e)}toggleTheme(e){return this.toggleAddon(e)}unloadTheme(e){return this.unloadAddon(e)}loadTheme(e){return this.loadAddon(e)}reloadTheme(e){return this.reloadAddon(e)}loadAddon(e){const t=super.loadAddon(e);t&&G.showAddonErrors({themes:[t]})}getFileModification(e,t,s){return s.css=t,`module.exports = ${JSON.stringify(s)};`}startAddon(e){return this.addTheme(e)}stopAddon(e){return this.removeTheme(e)}addTheme(e){const t="string"==typeof e?this.addonList.find(t=>t.id==e):e;t&&(C.injectTheme(t.id,t.css),H.show(A.Addons.enabled.format({name:t.name,version:t.version})))}removeTheme(e){const t="string"==typeof e?this.addonList.find(t=>t.id==e):e;t&&(C.removeTheme(t.id),H.show(A.Addons.disabled.format({name:t.name,version:t.version})))}};class ht{get name(){return"Unnamed Builtin"}get collection(){return"settings"}get category(){return"general"}get id(){return"None"}async initialize(){L.get(this.collection,this.category,this.id)&&await this.enable(),E.on("setting-updated",(e,t,s,n)=>{e==this.collection&&t===this.category&&s===this.id&&(n?this.enable():this.disable())}),this.initialized=!0}registerSetting(e,t,s,n,i){return 4==arguments.length?(e=this.collection,t=arguments[0],s=arguments[1],n=arguments[2],i=arguments[3]):3==arguments.length&&(e=this.collection,t=this.category,s=arguments[0],n=arguments[1],i=arguments[2]),L.on(e,t,s,e=>{e?n():i()})}get(e,t,s){return 2==arguments.length?(e=this.collection,t=arguments[0],s=arguments[1]):1==arguments.length&&(e=this.collection,t=this.category,s=arguments[0]),L.get(e,t,s)}async enable(){this.log("Enabled");try{await this.enabled()}catch(e){this.stacktrace("Could not be enabled",e)}}async disable(){this.log("Disabled");try{await this.disabled()}catch(e){this.stacktrace("Could not be disabled",e)}}async enabled(){}async disabled(){}log(...e){c.log(this.name,...e)}warn(...e){c.warn(this.name,...e)}error(...e){c.err(this.name,...e)}stacktrace(e,t){c.stacktrace(this.name,e,t)}before(e,t,s){return B.before(this.name,e,t,s)}after(e,t,s){return B.after(this.name,e,t,s)}unpatchAll(){return B.unpatchAll(this.name)}}const pt=g.getByDisplayName("Tooltip");class ut extends O.Component{constructor(e){super(e),this.state={shouldAnimate:!this.animateOnHover,isFavorite:this.props.isFavorite},this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onClick=this.onClick.bind(this),this.toggleFavorite=this.toggleFavorite.bind(this)}get animateOnHover(){return L.get("emotes","general","animateOnHover")}get label(){return this.props.modifier?`${this.props.name}:${this.props.modifier}`:this.props.name}get modifierClass(){return this.props.modifier?" emote"+this.props.modifier:""}onMouseEnter(){!this.state.shouldAnimate&&this.animateOnHover&&this.setState({shouldAnimate:!0})}onMouseLeave(){this.state.shouldAnimate&&this.animateOnHover&&this.setState({shouldAnimate:!1})}onClick(e){this.props.onClick&&this.props.onClick(e)}toggleFavorite(e){e.preventDefault(),e.stopPropagation(),this.state.isFavorite?E.emit("emotes-favorite-removed",this.label):E.emit("emotes-favorite-added",this.label,this.props.url),this.setState({isFavorite:!this.state.isFavorite})}render(){return O.createElement(pt,{color:"black",position:"top",text:this.label,delay:750},e=>O.createElement("div",Object.assign({className:"emotewrapper"+(this.props.jumboable?" jumboable":""),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onClick},e),O.createElement("img",{draggable:!1,className:"emote"+this.modifierClass+(this.props.jumboable?" jumboable":"")+(this.state.shouldAnimate?"":" stop-animation"),dataModifier:this.props.modifier,alt:this.label,src:this.props.url}),O.createElement("input",{className:"fav"+(this.state.isFavorite?" active":""),title:A.Emotes.favoriteAction,type:"button",onClick:this.toggleFavorite})))}}const mt=s(3),gt={TwitchGlobal:new N("https://static-cdn.jtvnw.net/emoticons/v1/{{id}}/1.0"),TwitchSubscriber:new N("https://static-cdn.jtvnw.net/emoticons/v1/{{id}}/1.0"),FrankerFaceZ:new N("https://cdn.frankerfacez.com/emoticon/{{id}}/1"),BTTV:new N("https://cdn.betterttv.net/emote/{{id}}/1x")},ft={TwitchGlobal:{},TwitchSubscriber:{},BTTV:{},FrankerFaceZ:{}},yt=[],bt=["twitch","subscriber","bttv","ffz"],vt=["flip","spin","pulse","spin2","spin3","1spin","2spin","3spin","tr","bl","br","shake","shake2","shake3","flap"];var wt=new class extends ht{get name(){return"Emotes"}get collection(){return"settings"}get category(){return"general"}get id(){return"emotes"}get categories(){return Object.keys(ft).filter(e=>this.isCategoryEnabled(e))}get shouldDownload(){return L.get("emotes",this.category,"download")}isCategoryEnabled(e){return super.get("emotes","categories",e.toLowerCase())}get(e){return super.get("emotes","general",e)}get MessageComponent(){return g.find(e=>e.default&&e.default.displayName&&"Message"==e.default.displayName)}get Emotes(){return ft}get TwitchGlobal(){return ft.TwitchGlobal}get TwitchSubscriber(){return ft.TwitchSubscriber}get BTTV(){return ft.BTTV}get FrankerFaceZ(){return ft.FrankerFaceZ}get blocklist(){return yt}get favorites(){return this.favoriteEmotes}getUrl(e,t){return gt[e].format({id:ft[e][t]})}getCategory(e){return ft[e]}getRemoteFile(e){return p.repoUrl(`assets/emotes/${e.toLowerCase()}.json`)}initialize(){super.initialize();const e=w.getBDData("favoriteEmotes");this.favoriteEmotes=e||{},this.addFavorite=this.addFavorite.bind(this),this.removeFavorite=this.removeFavorite.bind(this),this.onCategoryToggle=this.onCategoryToggle.bind(this),this.resetEmotes=this.resetEmotes.bind(this)}async enabled(){L.registerCollection("emotes","Emotes",r,{title:A.Emotes.clearEmotes,onClick:this.resetEmotes}),await this.getBlocklist(),await this.loadEmoteData(),E.on("emotes-favorite-added",this.addFavorite),E.on("emotes-favorite-removed",this.removeFavorite),E.on("setting-updated",this.onCategoryToggle),this.patchMessageContent()}disabled(){E.off("setting-updated",this.onCategoryToggle),E.off("emotes-favorite-added",this.addFavorite),E.off("emotes-favorite-removed",this.removeFavorite),L.removeCollection("emotes"),this.emptyEmotes(),this.cancelEmoteRender&&(this.cancelEmoteRender(),delete this.cancelEmoteRender)}onCategoryToggle(e,t,s,n){if("emotes"==e&&"categories"==t)return n?this.loadEmoteData(s):this.unloadEmoteData(s)}addFavorite(e,t){this.favoriteEmotes.hasOwnProperty(e)||(this.favoriteEmotes[e]=t),this.saveFavorites()}removeFavorite(e){this.favoriteEmotes.hasOwnProperty(e)&&(delete this.favoriteEmotes[e],this.saveFavorites())}isFavorite(e){return this.favoriteEmotes.hasOwnProperty(e)}saveFavorites(){w.setBDData("favoriteEmotes",this.favoriteEmotes)}emptyEmotes(){for(const e in ft)Object.assign(ft,{[e]:{}})}patchMessageContent(){this.cancelEmoteRender||(this.cancelEmoteRender=this.before(this.MessageComponent,"default",(e,t)=>{const s=t[0].childrenMessageContent.props.content;if(!s||!s.length)return;for(let e=0;e<s.length;e++){const t=s[e];if("string"!=typeof t)continue;const n=t.split(/([^\s]+)([\s]|$)/g);for(let t=0,i=this.categories.length;t<i;t++)for(let i=0,r=n.length;i<r;i++){const r=n[i].split(":"),o=r[0];let a=r[1]?r[1]:"",l=a.slice(0);if(o.length<4||yt.includes(o))continue;vt.includes(a)&&L.get("emotes","general","modifiers")||(a=""),bt.includes(l)?a=l:l="";let d=this.categories[t];if("twitch"===l?ft.TwitchGlobal[o]?d="TwitchGlobal":ft.TwitchSubscriber[o]&&(d="TwitchSubscriber"):"subscriber"===l?ft.TwitchSubscriber[o]&&(d="TwitchSubscriber"):"bttv"===l?ft.BTTV[o]&&(d="BTTV"):"ffz"===l&&ft.FrankerFaceZ[o]&&(d="FrankerFaceZ"),!ft[d][o])continue;const c=s[e].match(new RegExp(`([\\s]|^)${p.escape(a?o+":"+a:o)}([\\s]|$)`));if(!c)continue;const h=s[e].substring(0,c.index+c[1].length),u=s[e].substring(c.index+c[0].length-c[2].length);s[e]=h;const m=f.React.createElement(ut,{name:o,url:gt[d].format({id:ft[d][o]}),modifier:a,isFavorite:this.isFavorite(o)});s.splice(e+1,0,u),s.splice(e+1,0,m)}}if(s.every(e=>"string"==typeof e&&""==e.replace(/\s*/,"")||(!(!e.type||"BDEmote"!=e.type.name)||!!(e.props&&e.props.children&&e.props.children.props&&e.props.children.props.emojiName))))for(const e of s)"object"==typeof e&&("BDEmote"==e.type.name?e.props.jumboable=!0:e.props&&e.props.children&&e.props.children.props&&e.props.children.props.emojiName&&(e.props.children.props.jumboable=!0))}))}async getBlocklist(){try{const e="Blocklist",t=w.emotesExist(e),s=await this.isCacheValid(e),n=s||!s&&t&&!this.shouldDownload?w.getEmoteData(e):await this.downloadEmotes(e);yt.push(...n)}catch(e){}}isCacheValid(e){return new Promise(t=>{const s=w.getCacheHash("emotes",e);if(!s)return t(!1);mt.head({url:this.getRemoteFile(e),headers:{"If-None-Match":s}},(e,s)=>{t(!e&&304==s.statusCode)})})}async loadEmoteData(e){e||(e=this.categories),Array.isArray(e)||(e=[e]);const t=Object.keys(ft);e=e.map(e=>t.find(t=>t.toLowerCase()==e.toLowerCase())),H.show(A.Emotes.loading,{type:"info"}),this.emotesLoaded=!1;for(const t of e){const e=w.emotesExist(t),s=await this.isCacheValid(t);let n=null;if(s||!s&&e&&!this.shouldDownload){this.log(`Loading ${t} emotes from local cache.`);const e=w.getEmoteData(t);Object.keys(e).length>0&&(n=e)}n||(n=await this.downloadEmotes(t)),Object.assign(ft[t],n),await new Promise(e=>setTimeout(e,1e3))}this.emotesLoaded=!0,E.dispatch("emotes-loaded"),H.show(A.Emotes.loaded,{type:"success"})}unloadEmoteData(e){e||(e=this.categories),Array.isArray(e)||(e=[e]);const t=Object.keys(ft);e=e.map(e=>t.find(t=>t.toLowerCase()==e.toLowerCase()));for(const t of e)delete ft[t],ft[t]={}}downloadEmotes(e){const t=this.getRemoteFile(e);this.log(`Downloading ${e} from ${t}`);const s={url:t,timeout:1e4,json:!0};return new Promise(t=>{mt.get(s,(s,n,i)=>{if(s||200!=n.statusCode)return this.stacktrace(`Could not download ${e} emotes.`,s),t({});for(const e in i)(e.length<4||yt.includes(e)||!i[e])&&delete i[e];w.saveEmoteData(e,i),w.setCacheHash("emotes",e,n.headers.etag),t(i),this.log("Downloaded "+e)})})}resetEmotes(){const e=Object.keys(ft);this.unloadEmoteData(e);for(const t of e)w.invalidateCache("emotes",t);this.loadEmoteData()}};const Ct={get React(){return f.React},get ReactDOM(){return f.ReactDOM},get WindowConfigFile(){return""},get settings(){return L.collections},get emotes(){return new Proxy(wt.Emotes,{get:()=>wt.Emotes,set(){c.warn("BdApi.emotes","Addon policy for plugins #5 https://github.com/rauenzi/BetterDiscordApp/wiki/Addon-Policies#plugins")}})},get version(){return i.version},getAllWindowPreferences:function(){return w.getData("windowprefs")||{}},getWindowPreference:function(e){return this.getAllWindowPreferences()[e]},setWindowPreference:function(e,t){const s=this.getAllWindowPreferences();return s[e]=t,w.setData("windowprefs",s)},injectCSS:function(e,t){C.injectStyle(e,t)},clearCSS:function(e){C.removeStyle(e)},linkJS:function(e,t){return C.injectScript(e,t)},unlinkJS:function(e){C.removeScript(e)},alert:function(e,t){G.alert(e,t)},showConfirmationModal:function(e,t,s={}){return G.showConfirmationModal(e,t,s)},showToast:function(e,t={}){H.show(e,t)},findModule:function(e){return g.getModule(e)},findAllModules:function(e){return g.getModule(e,!1)},findModuleByProps:function(...e){return g.getByProps(...e)},findModuleByPrototypes:function(...e){return g.getByPrototypes(...e)},findModuleByDisplayName:function(e){return g.getByDisplayName(e)},getInternalInstance:function(e){if(e instanceof window.jQuery||e instanceof Element)return e instanceof jQuery&&(e=e[0]),p.getReactInstance(e)},loadData:function(e,t){return w.getPluginData(e,t)}};Ct.getData=Ct.loadData,Ct.saveData=function(e,t,s){return w.setPluginData(e,t,s)},Ct.setData=Ct.saveData,Ct.deleteData=function(e,t){return w.deletePluginData(e,t)},Ct.monkeyPatch=function(e,t,s){const{before:n,after:i,instead:r,once:o=!1,callerId:a="BdApi"}=s,l=n?"before":i?"after":r?"instead":"";if(!l)return c.err("BdApi","Must provide one of: after, before, instead");const d={originalMethod:e[t],callOriginalMethod:()=>d.originalMethod.apply(d.thisObject,d.methodArguments)};return d.cancelPatch=B[l](a,e,t,(e,n,i)=>{d.thisObject=e,d.methodArguments=n,d.returnValue=i;try{Reflect.apply(s[l],null,[d]),o&&d.cancelPatch()}catch(e){c.err(a+":monkeyPatch",`Error in the ${l} of ${t}`)}}),d.cancelPatch},Ct.onRemoved=function(e,t){return p.onRemoved(e,t)},Ct.suppressErrors=function(e,t){return p.suppressErrors(e,t)},Ct.testJSON=function(e){return p.testJSON(e)},Ct.getPlugin=function(e){return c.warn("BdApi","getPlugin is deprecated. Please make use of the addon api (BdApi.Plugins)"),lt.addonList.find(t=>t.name==e)},Ct.isPluginEnabled=function(e){c.warn("BdApi","isPluginEnabled is deprecated. Please make use of the addon api (BdApi.Plugins)");const t=this.getPlugin(e);return!!t&&lt.isEnabled(t.id)},Ct.isThemeEnabled=function(e){c.warn("BdApi","isThemeEnabled is deprecated. Please make use of the addon api (BdApi.Themes)");const t=ct.addonList.find(t=>t.name==e);return!!t&&ct.isEnabled(t.id)},Ct.isSettingEnabled=function(e,t,s){return L.get(e,t,s)},Ct.enableSetting=function(e,t,s){return L.set(e,t,s,!0)},Ct.disableSetting=function(e,t,s){return L.set(e,t,s,!1)},Ct.toggleSetting=function(e,t,s){return L.set(e,t,s,!L.get(e,t,s))},Ct.getBDData=function(e){return w.getBDData(e)},Ct.setBDData=function(e,t){return w.setBDData(e,t)};const St=e=>new class{get folder(){return e.addonFolder}isEnabled(t){return e.isEnabled(t)}enable(t){return e.enableAddon(t)}disable(t){return e.disableAddon(t)}toggle(t){return e.toggleAddon(t)}reload(t){return e.reloadAddon(t)}get(t){return e.getAddon(t)}getAll(){return e.addonList.map(t=>e.getAddon(t.id))}};Ct.Plugins=St(lt),Ct.Themes=St(ct),Ct.Patcher={patch:(e,t,s,n,i={})=>"string"!=typeof e?c.err("BdApi.Patcher","Parameter 0 of patch must be a string representing the caller"):"before"!==i.type&&"instead"!==i.type&&"after"!==i.type?c.err("BdApi.Patcher","options.type must be one of: before, instead, after"):B.pushChildPatch(e,t,s,n,i),before:(e,t,s,n,i={})=>Ct.Patcher.patch(e,t,s,n,Object.assign(i,{type:"before"})),instead:(e,t,s,n,i={})=>Ct.Patcher.patch(e,t,s,n,Object.assign(i,{type:"instead"})),after:(e,t,s,n,i={})=>Ct.Patcher.patch(e,t,s,n,Object.assign(i,{type:"after"})),unpatchAll:e=>"string"!=typeof e?c.err("BdApi.Patcher","Parameter 0 of unpatchAll must be a string representing the caller"):B.unpatchAll(e)},Object.freeze(Ct),Object.freeze(Ct.Plugins),Object.freeze(Ct.Themes),Object.freeze(Ct.Patcher);var Et=Ct;const Pt=document.createElement("style");Pt.textContent="/* BEGIN V2 LOADER */\n/* =============== */\n\n#bd-loading-icon {\n  background-image: url(data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMjAwMCAyMDAwIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAyMDAwIDIwMDAiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxwYXRoIGZpbGw9IiMzRTgyRTUiIGQ9Ik0xNDAyLjIsNjMxLjdjLTkuNy0zNTMuNC0yODYuMi00OTYtNjQyLjYtNDk2SDY4LjR2NzE0LjFsNDQyLDM5OFY0OTAuN2gyNTdjMjc0LjUsMCwyNzQuNSwzNDQuOSwwLDM0NC45SDU5Ny42djMyOS41aDE2OS44YzI3NC41LDAsMjc0LjUsMzQ0LjgsMCwzNDQuOGgtNjk5djM1NC45aDY5MS4yYzM1Ni4zLDAsNjMyLjgtMTQyLjYsNjQyLjYtNDk2YzAtMTYyLjYtNDQuNS0yODQuMS0xMjIuOS0zNjguNkMxMzU3LjcsOTE1LjgsMTQwMi4yLDc5NC4zLDE0MDIuMiw2MzEuN3oiLz48cGF0aCBmaWxsPSIjRkZGRkZGIiBkPSJNMTI2Mi41LDEzNS4yTDEyNjIuNSwxMzUuMmwtNzYuOCwwYzI2LjYsMTMuMyw1MS43LDI4LjEsNzUsNDQuM2M3MC43LDQ5LjEsMTI2LjEsMTExLjUsMTY0LjYsMTg1LjNjMzkuOSw3Ni42LDYxLjUsMTY1LjYsNjQuMywyNjQuNmwwLDEuMnYxLjJjMCwxNDEuMSwwLDU5Ni4xLDAsNzM3LjF2MS4ybDAsMS4yYy0yLjcsOTktMjQuMywxODgtNjQuMywyNjQuNmMtMzguNSw3My44LTkzLjgsMTM2LjItMTY0LjYsMTg1LjNjLTIyLjYsMTUuNy00Ni45LDMwLjEtNzIuNiw0My4xaDcyLjVjMzQ2LjIsMS45LDY3MS0xNzEuMiw2NzEtNTY3LjlWNzE2LjdDMTkzMy41LDMxMi4yLDE2MDguNywxMzUuMiwxMjYyLjUsMTM1LjJ6Ii8+PC9nPjwvc3ZnPg==);\n}\n#bd-loading-icon {\n  position: fixed;\n  bottom:5px;\n  right:5px;\n  z-index: 2147483647;\n  display: block;\n  width: 20px;\n  height: 20px;\n  background-size: 100% 100%;\n  animation: bd-loading-animation 1.5s ease-in-out infinite;\n}\n\n@keyframes bd-loading-animation {\n  0% { opacity: 0.05; }\n  50% { opacity: 0.6; }\n  100% { opacity: 0.05; }\n}\n/* =============== */\n/*  END V2 LOADER  */";const xt=document.createElement("div");xt.id="bd-loading-icon",xt.className="bd-loaderv2",xt.title="BetterDiscord is loading...";var Mt=class{static show(){document.body.appendChild(Pt),document.body.appendChild(xt)}static hide(){Pt&&Pt.remove(),xt&&xt.remove()}};class kt extends O.Component{render(){const e=this.props.size||"24px";return O.createElement("svg",{viewBox:"0 0 24 24",style:{width:e,height:e}},O.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),O.createElement("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"}))}}class Dt extends O.Component{constructor(e){super(e),this.hasUnsavedChanges=!1,this.onChange=this.onChange.bind(this),this.toggleLiveUpdate=this.toggleLiveUpdate.bind(this),this.updateCss=this.updateCss.bind(this),this.saveCss=this.saveCss.bind(this),this.openDetached=this.props.openDetached?this.openDetached.bind(this):null,this.openNative=this.openNative.bind(this),this.updateEditor=this.updateEditor.bind(this),this.controls=[{label:O.createElement(we,{size:"18px"}),tooltip:A.CustomCSS.update,onClick:this.updateCss},{label:O.createElement(K,{size:"18px"}),tooltip:A.CustomCSS.save,onClick:this.saveCss},{label:O.createElement(ee,{size:"18px"}),tooltip:A.CustomCSS.openNative,onClick:this.openNative},{label:A.Collections.settings.customcss.liveUpdate.name,type:"checkbox",onChange:this.toggleLiveUpdate,checked:L.get("settings","customcss","liveUpdate"),side:"right"}],this.openDetached&&this.controls.push({label:O.createElement(kt,{size:"18px"}),tooltip:A.CustomCSS.openDetached,onClick:this.openDetached,side:"right"})}componentDidMount(){E.on("customcss-updated",this.updateEditor)}componentWillUnmount(){E.off("customcss-updated",this.updateEditor)}updateEditor(e){this.editor&&(this.editor.value=e)}get value(){return this.editor.session.getValue()}set value(e){this.editor.setValue(e)}showSettings(){return this.editor.keyBinding.$defaultHandler.commands.showSettingsMenu.exec(this.editor)}resize(){return this.editor.resize()}setEditorRef(e){this.editor=e,this.props.editorRef&&void 0!==this.props.editorRef.current?this.props.editorRef.current=e:this.props.editorRef&&(this.props.editorRef=e)}onChange(){this.hasUnsavedChanges=!0,this.props.onChange&&this.props.onChange(...arguments)}render(){return O.createElement(X,{ref:this.setEditorRef.bind(this),readOnly:this.props.readOnly,id:this.props.id||"bd-customcss-editor",onChange:this.onChange,controls:this.controls,value:this.props.css})}toggleLiveUpdate(e){L.set("settings","customcss","liveUpdate",e)}updateCss(e,t){this.props.update&&this.props.update(t)}saveCss(e,t){this.hasUnsavedChanges=!1,this.props.save&&this.props.save(t)}openDetached(e,t){this.props.openDetached&&this.props.openDetached(t)}openNative(){this.props.openNative&&this.props.openNative()}}const Nt=s(2),At=s(0),Lt=g.getByProps("updateAccount"),Bt=g.getByProps("dirtyDispatch"),Tt=g.getByProps("ActionTypes").ActionTypes;var jt=new class extends ht{get name(){return"Custom CSS"}get category(){return"customcss"}get id(){return"customcss"}get startDetached(){return"detached"==L.get(this.collection,this.category,"openAction")}get nativeOpen(){return"system"==L.get(this.collection,this.category,"openAction")}constructor(){super(),this.savedCss="",this.insertedCss="",this.isDetached=!1}async enabled(){Object.defineProperty(window,"MonacoEnvironment",{value:{getWorkerUrl:function(){return"data:text/javascript;charset=utf-8,"+encodeURIComponent("\n                        self.MonacoEnvironment = {\n                            baseUrl: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min'\n                        };\n                        importScripts('https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/base/worker/workerMain.min.js');")}}});const e=window.require;delete window.module,C.linkStyle("monaco-style","https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/editor/editor.main.min.css",{documentHead:!0}),C.injectScript("monaco-script","https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/loader.min.js").then(()=>{const t=window.require;window.require=e,t.config({paths:{vs:"https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs"}}),t(["vs/editor/editor.main"],()=>{})}),L.registerPanel(this.id,A.Panels.customcss,{order:2,element:()=>[O.createElement(ve,{text:A.CustomCSS.editorTitle}),O.createElement(Dt,{css:this.savedCss,save:this.saveCSS.bind(this),update:this.insertCSS.bind(this),openNative:this.openNative.bind(this),openDetached:this.openDetached.bind(this),onChange:this.onChange.bind(this)})],onClick:e=>{if(this.isDetached)return;if(this.nativeOpen)return this.openNative();if(this.startDetached)return this.openDetached();const t=p.findInRenderTree(e._reactInternalFiber,e=>e&&e.onSetSection,{walkable:["child","memoizedProps","props","children"]});t&&t.onSetSection&&t.onSetSection(this.id)}}),this.loadCSS(),this.insertCSS(this.savedCss),this.watchContent()}disabled(){L.removePanel(this.id),this.unwatchContent()}watchContent(){if(this.watcher)return this.error("Already watching content.");const e={};this.log("Starting to watch content."),this.watcher=Nt.watch(w.customCSS,{persistent:!1},async(t,s)=>{if(!t||!s)return;await new Promise(e=>setTimeout(e,50));try{Nt.statSync(w.customCSS)}catch(t){if("ENOENT"!==t.code)return;delete e[s],this.saveCSS("")}const n=Nt.statSync(w.customCSS);if(n&&n.mtime&&n.mtime.getTime()&&"number"==typeof n.mtime.getTime()&&e[s]!=n.mtime.getTime()&&(e[s]=n.mtime.getTime(),"change"==t)){const e=w.loadCustomCSS();if(e==this.savedCss)return;this.savedCss=e,this.insertCSS(this.savedCss),E.emit("customcss-updated",this.savedCss)}})}unwatchContent(){if(!this.watcher)return this.error("Was not watching content.");this.watcher.close(),delete this.watcher,this.log("No longer watching content.")}onChange(e){L.get("settings","customcss","liveUpdate")&&(this.insertCSS(e),this.saveCSS(e))}loadCSS(){this.savedCss=w.loadCustomCSS()}insertCSS(e){void 0===e?e=this.insertedCss:this.insertedCss=e,C.updateCustomCSS(e)}saveCSS(e){void 0!==e&&(this.savedCss=e),w.saveCustomCSS(this.savedCss)}openNative(){At.shell.openExternal("file://"+w.customCSS)}openDetached(e){const t=O.createRef(),s=O.createElement(Dt,{id:"bd-floating-editor",ref:t,css:e,save:this.saveCSS.bind(this),update:this.insertCSS.bind(this),openNative:this.openNative.bind(this),onChange:this.onChange.bind(this)});ce.open({onClose:()=>{this.isDetached=!1},onResize:()=>{t&&t.current&&t.current.resize&&t.current.resize()},title:A.CustomCSS.editorTitle,id:"floating-editor-window",height:470,width:410,center:!0,resizable:!0,children:s,confirmClose:()=>!(!t||!t.current)&&(!L.get("settings","customcss","liveUpdate")&&t.current.hasUnsavedChanges),confirmationText:A.CustomCSS.confirmationText}),this.isDetached=!0,Lt.close(),Bt.dirtyDispatch({type:Tt.LAYER_POP})}},Ft=new class extends ht{get name(){return"WindowPrefs"}get category(){return"window"}get id(){return"transparency"}enabled(){this.setWindowPreference("transparent",!0),this.setWindowPreference("backgroundColor","#00000000"),this.showModal(A.WindowPrefs.enabledInfo)}disabled(){this.deleteWindowPreference("transparent"),this.deleteWindowPreference("backgroundColor"),this.showModal(A.WindowPrefs.disabledInfo)}showModal(e){this.initialized&&G.showConfirmationModal(A.Modals.additionalInfo,e,{confirmText:A.Modals.restartNow,cancelText:A.Modals.restartLater,onConfirm:()=>{const e=s(0).remote.app;e.relaunch(),e.exit()}})}getWindowPreference(e){return(w.getData("windowprefs")||{})[e]}setWindowPreference(e,t){const s=w.getData("windowprefs")||{};s[e]=t,w.setData("windowprefs",s)}deleteWindowPreference(e){const t=w.getData("windowprefs")||{};delete t[e],w.setData("windowprefs",t)}};const zt=new RegExp("^(?!da-)((?:[A-Za-z]|[0-9]|-)+)-(?:[A-Za-z]|[0-9]|-|_){6}$");var It=new class extends ht{get id(){return"classNormalizer"}get category(){return"general"}get name(){return"ClassNormalizer"}enabled(){this.hasPatched||(this.patchClassModules(g.getModules(this.moduleFilter.bind(this))),this.normalizeElement(document.querySelector("#app-mount")),this.hasPatched=!0,this.patchDOMMethods())}disabled(){this.hasPatched&&(this.unpatchClassModules(g.getModules(this.moduleFilter.bind(this))),this.revertElement(document.querySelector("#app-mount")),this.hasPatched=!1)}patchClassModules(e){for(const t of e)this.patchClassModule("da",t)}unpatchClassModules(e){for(const t of e)this.unpatchClassModule("da",t)}shouldIgnore(e){return!isNaN(e)||(!!(e.endsWith("px")||e.endsWith("ch")||e.endsWith("em")||e.endsWith("ms"))||(!!e.startsWith("layerContainer-")||(!(!e.startsWith("#")||7!=e.length&&4!=e.length)||!(!e.includes("calc(")&&!e.includes("rgba")))))}moduleFilter(e){if("object"!=typeof e||Array.isArray(e))return!1;if(e.__esModule)return!1;if(!Object.keys(e).length)return!1;for(const t in e){const s=e[t];if("string"!=typeof s)return!1;if(!this.shouldIgnore(s)){if(1===s.split("-").length)return!1;if(!zt.test(s.split(" ")[0]))return!1}}return!0}patchClassModule(e,t){for(const s in t){const n=t[s];if(this.shouldIgnore(n))continue;const i=n.split(" ");for(const n of i){const i=n.match(zt);if(!i||!i.length||i.length<2)continue;const r=i[1].split("-").map((e,t)=>t?e[0].toUpperCase()+e.slice(1):e).join("");t[s]+=` ${e}-${r}`}}}unpatchClassModule(e,t){for(const s in t){const n=t[s];if(this.shouldIgnore(n))continue;let i="";const r=n.split(" ");for(const t of r)t.startsWith(e+"-")||(i+=" "+t);t[s]=i.trim()}}normalizeElement(e){if(!(e instanceof Element))return;const t=e.classList;for(let s=0,n=t.length;s<n;s++){if(!zt.test(t[s]))continue;const n=t[s].match(zt)[1].split("-").map((e,t)=>t?e[0].toUpperCase()+e.slice(1):e).join("");e.classList.add("da-"+n)}for(const t of e.children)this.normalizeElement(t)}revertElement(e){if(!(e instanceof Element))return;e.children&&e.children.length&&this.revertElement(e.children[0]),e.nextElementSibling&&this.revertElement(e.nextElementSibling);const t=e.classList,s=[];for(let e=0;e<t.length;e++)t[e].startsWith("da-")&&s.push(t[e]);e.classList.remove(...s)}patchDOMMethods(){const e=DOMTokenList.prototype.contains;DOMTokenList.prototype.contains=function(t){return Reflect.apply(e,this,[t.split(" ")[0]])};const t=DOMTokenList.prototype.add;DOMTokenList.prototype.add=function(...e){for(let t=0;t<e.length;t++)e[t]=e[t].split(" ")[0];return Reflect.apply(t,this,e)};const s=DOMTokenList.prototype.remove;DOMTokenList.prototype.remove=function(...e){for(let t=0;t<e.length;t++)e[t]=e[t].split(" ")[0];return Reflect.apply(s,this,e)}}};const Ot=O.createElement("div",{className:"flowerStarContainer-3zDVtj verified-1eC5dy background-2uufRq guildBadge-RlDbED",style:{width:"16px",height:"16px"}},O.createElement("svg",{"aria-label":"Verified & Partnered",className:"flowerStar-1GeTsn","aria-hidden":"false",width:"16",height:"16",viewBox:"0 0 16 15.2"},O.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"m16 7.6c0 .79-1.28 1.38-1.52 2.09s.44 2 0 2.59-1.84.35-2.46.8-.79 1.84-1.54 2.09-1.67-.8-2.47-.8-1.75 1-2.47.8-.92-1.64-1.54-2.09-2-.18-2.46-.8.23-1.84 0-2.59-1.54-1.3-1.54-2.09 1.28-1.38 1.52-2.09-.44-2 0-2.59 1.85-.35 2.48-.8.78-1.84 1.53-2.12 1.67.83 2.47.83 1.75-1 2.47-.8.91 1.64 1.53 2.09 2 .18 2.46.8-.23 1.84 0 2.59 1.54 1.3 1.54 2.09z"})),O.createElement("div",{className:"childContainer-1wxZNh"},O.createElement("svg",{className:"icon-1ihkOt","aria-hidden":"false",width:"16",height:"16",viewBox:"0 0 16 15.2"},O.createElement("path",{d:"M7.4,11.17,4,8.62,5,7.26l2,1.53L10.64,4l1.36,1Z",fill:"currentColor"}))));class Rt extends O.Component{constructor(e){super(e),this.props.server.iconUrl||(this.props.server.iconUrl=this.props.defaultAvatar()),this.state={imageError:!1,joined:this.props.joined},this.join=this.join.bind(this),this.handleError=this.handleError.bind(this)}render(){const{server:e}=this.props,t=new Date(1e3*e.insertDate),s="string"==typeof this.state.joined?A.PublicServers.joining+"...":this.state.joined?A.PublicServers.joined:A.PublicServers.join;return O.createElement("div",{className:"bd-server-card",role:"button",tabIndex:"0",onClick:this.join},O.createElement("div",{className:"bd-server-header"},O.createElement("div",{className:"bd-server-splash-container"},O.createElement("img",{src:e.iconUrl,onError:this.handleError,className:"bd-server-splash"})),O.createElement("img",{src:e.iconUrl,onError:this.handleError,className:"bd-server-icon"})),O.createElement("div",{className:"bd-server-info"},O.createElement("div",{className:"bd-server-title"},e.pinned&&Ot,O.createElement("div",{className:"bd-server-name"},e.name),this.state.joined&&O.createElement("div",{className:"bd-server-tag"},s)),O.createElement("div",{className:"bd-server-description"},e.description),O.createElement("div",{className:"bd-server-footer"},O.createElement("div",{className:"bd-server-count"},O.createElement("div",{className:"bd-server-count-dot"}),O.createElement("div",{className:"bd-server-count-text"},e.members.toLocaleString()," Members")),O.createElement("div",{className:"bd-server-count"},O.createElement("div",{className:"bd-server-count-dot"}),O.createElement("div",{className:"bd-server-count-text"},"Added ",t.toLocaleDateString())))))}handleError(){this.props.server.iconUrl=this.props.defaultAvatar(),this.setState({imageError:!0})}async join(){if(this.state.joined)return this.props.navigateTo(this.props.server.identifier);this.setState({joined:"joining"});const e=await this.props.join(this.props.server.identifier,this.props.server.nativejoin);this.setState({joined:e})}}const Ht=g.getByProps("getSortedGuilds"),Ut=g.getByProps("getUserAvatarURL","DEFAULT_AVATARS"),_t=g.getByProps("acceptInvite"),qt=s(0).remote.BrowserWindow,Gt={name:"BetterDiscord",members:55e3,categories:["community","programming","support"],description:"Official BetterDiscord server for plugins, themes, support, etc",identifier:"86004744966914048",iconUrl:"https://cdn.discordapp.com/icons/86004744966914048/292e7f6bfff2b71dfd13e508a859aedd.webp",nativejoin:!0,invite_code:"BJD2yvJ",pinned:!0,insertDate:1517806800};var $t=new class{constructor(){this.cache=new Map,this.cache.set("featured",[Gt]),this.cache.set("popular",[]),this.cache.set("keywords",[]),this.cache.set("accessToken",""),window.debugPS=this}get endPoint(){return"https://search.discordservers.com"}get joinEndPoint(){return"https://j.discordservers.com"}get connectEndPoint(){return"https://auth.discordservers.com/info"}getDefaultAvatar(){return Ut.DEFAULT_AVATARS[Math.floor(5*Math.random())]}hasJoined(e){return Ht.getFlattenedGuildIds().includes(e)}async search({term:e="",keyword:t="",page:s=1}={}){if(this.cache.has(e+t+s))return this.cache.get(e+t+s);const n=50*(s-1),i=[];t&&i.push("keyword="+t.replace(/ /g,"%20").toLowerCase()),e&&i.push("term="+e.replace(/ /g,"%20")),n&&i.push("from="+n);const r="?"+i.join("&");try{const i=await fetch(`${this.endPoint}${r}`,{method:"GET"}),o=await i.json(),a={servers:o.results,size:o.size,total:o.total,page:Math.ceil(n/50)+1,numPages:Math.ceil(o.total/50)};return this.cache.set(e+t+s,a),a}catch(e){c.stacktrace("PublicServers","Could not reach search endpoint.",e)}}async getDashboard(){const e=this.cache.get("keywords");if(e&&e.length)return{featured:this.cache.get("featured"),popular:this.cache.get("popular"),keywords:e};try{const e=await fetch(this.endPoint+"/dashboard",{method:"GET"}),t=await e.json(),s="featured"===t.results[0].key,n=t.results[s?0:1].response.hits,i=t.results[s?1:0].response.hits,r=t.mainKeywords.map(e=>e.charAt(0).toUpperCase()+e.slice(1)).sort();return n.unshift(Gt),this.cache.set("featured",n),this.cache.set("popular",i),this.cache.set("keywords",r),{featured:this.cache.get("featured"),popular:this.cache.get("popular"),keywords:this.cache.get("keywords")}}catch(e){return c.stacktrace("PublicServers","Could not download dashboard.",e),{featured:this.cache.get("featured"),popular:this.cache.get("popular"),keywords:this.cache.get("keywords")}}}async join(e,t=!1){if(t)return _t.acceptInvite(e);try{return await fetch(`${this.joinEndPoint}/${e}`,{method:"GET",credentials:"include",mode:"cors",headers:{Accept:"application/json","Content-Type":"application/json"}}),!0}catch(e){return c.warn("PublicServers","Could not join server."),!1}}async checkConnection(){try{const e=await fetch(this.connectEndPoint,{method:"GET",credentials:"include",mode:"cors",headers:{Accept:"application/json","Content-Type":"application/json"}}),t=await e.json();return this._accessToken=t.access_token,t}catch(e){return c.warn("PublicServers","Could not verify connection."),!1}}connect(){return new Promise(e=>{const t=new qt(this.windowOptions),s="https://auth.discordservers.com/connect?scopes=guilds.join&previousUrl="+this.connectEndPoint;t.webContents.on("did-navigate",(s,n)=>{n==this.connectEndPoint&&(t.close(),e())}),t.loadURL(s)})}get windowOptions(){return{width:490,height:500,backgroundColor:"#282b30",show:!0,resizable:!0,maximizable:!1,minimizable:!1,alwaysOnTop:!0,frame:!1,center:!0,webPreferences:{nodeIntegration:!1}}}};class Wt extends O.Component{render(){const e=this.props.size||"24px";return O.createElement("svg",{viewBox:"0 0 24 24",style:{width:e,height:e}},O.createElement("path",{d:"M14 7l-5 5 5 5V7z"}),O.createElement("path",{d:"M24 0v24H0V0h24z",fill:"none"}))}}class Vt extends O.Component{render(){const e=this.props.size||"24px";return O.createElement("svg",{viewBox:"0 0 24 24",style:{width:e,height:e}},O.createElement("path",{d:"M10 17l5-5-5-5v10z"}),O.createElement("path",{d:"M0 24V0h24v24H0z",fill:"none"}))}}const Yt=g.getByDisplayName("SettingsView"),Jt=g.getByProps("transitionToGuildSync"),Zt=g.getByProps("popLayer"),Qt={servers:[],size:0,total:0,page:0,numPages:0};class Xt extends O.Component{constructor(e){super(e),this.state={tab:"Featured",query:"",loading:!0,user:null,results:Object.assign({},Qt)},this.featured=[],this.popular=[],this.keywords=[],this.changeTab=this.changeTab.bind(this),this.searchKeyDown=this.searchKeyDown.bind(this),this.connect=this.connect.bind(this),this.loadPreviousPage=this.loadPreviousPage.bind(this),this.loadNextPage=this.loadNextPage.bind(this),this.join=this.join.bind(this),this.navigateTo=this.navigateTo.bind(this)}componentDidMount(){this.getDashboard(),this.checkConnection()}async checkConnection(){const e=await $t.checkConnection();if(!e)return this.setState({user:null});this.setState({user:e})}async getDashboard(){const e=await $t.getDashboard();this.featured=e.featured,this.popular=e.popular,this.keywords=e.keywords,this.setState({loading:!1}),this.changeTab(this.state.tab),this.keywords&&this.keywords.length||G.showConfirmationModal(A.PublicServers.connectionError,A.PublicServers.connectionErrorMessage)}async connect(){await $t.connect(),this.checkConnection()}searchKeyDown(e){if(this.state.loading||13!==e.which)return;const t=e.target.value;"Featured"==this.state.tab||"Popular"==this.state.tab?this.setState({tab:"All"},()=>this.search(t)):this.search(t)}async search(e="",t=1){this.setState({query:e,loading:!0});const s=await $t.search({term:e,keyword:"All"==this.state.tab||"Featured"==this.state.tab||"Popular"==this.state.tab?"":this.state.tab,page:t});if(!s)return this.setState({results:Object.assign({},Qt)});this.setState({loading:!1,results:s})}async changeTab(e){if(!this.state.loading){if(await new Promise(t=>this.setState({tab:e},t)),"Featured"===this.state.tab||"Popular"==this.state.tab)return this.setState({results:{servers:this[this.state.tab.toLowerCase()],size:this[this.state.tab.toLowerCase()].length,total:this[this.state.tab.toLowerCase()].length,page:1,numPages:1}});this.search()}}get hasPrevious(){return this.state.results.page>1}get hasNext(){return this.state.results.page<this.state.results.numPages}loadPreviousPage(){!this.state.loading&&this.hasPrevious&&this.search(this.state.query,this.state.results.page-1)}loadNextPage(){!this.state.loading&&this.hasNext&&this.search(this.state.query,this.state.results.page+1)}async join(e,t=!1){return this.state.user||t?await $t.join(e,t):G.showConfirmationModal(A.PublicServers.notConnected,A.PublicServers.connectionRequired,{cancelText:A.Modals.nevermind,confirmText:A.Modals.okay,onConfirm:()=>{this.connect().then(()=>$t.join(e,t))}})}navigateTo(e){Jt&&Jt.transitionToGuildSync(e),Zt&&Zt.popLayer()}get searchBox(){return O.createElement(Oe,{onKeyDown:this.searchKeyDown,className:"bd-server-search",placeholder:A.PublicServers.search+"...",value:this.state.query})}get title(){if(this.state.loading)return A.PublicServers.loading+"...";if(this.state.query){const e=(this.state.results.page-1)*this.state.results.size+1,t=this.state.results.total,s=this.hasNext?e-1+this.state.results.size:t;let n=A.PublicServers.results.format({start:e,end:s,total:t,category:this.state.tab});return this.state.query&&(n+=" "+A.PublicServers.query.format({query:this.state.query})),n}return this.state.tab}get content(){const e=this.state.user?null:{title:A.PublicServers.connect,onClick:this.connect},t=this.state.results.servers.map(e=>O.createElement(Rt,{key:e.identifier,server:e,joined:$t.hasJoined(e.identifier),join:this.join,navigateTo:this.navigateTo,defaultAvatar:$t.getDefaultAvatar}));let s=O.createElement(_e);return this.state.loading?s=this.loadingIndicator:this.state.results.total&&(s=O.createElement("div",{className:"bd-card-list"},t)),[O.createElement(ve,{text:this.title,button:e}),this.state.results.numPages>1&&this.pagination,s,this.state.results.numPages>1&&this.pagination,this.state.results.numPages>1&&this.state.query&&O.createElement(ve,{text:this.title})]}get loadingIndicator(){return O.createElement("div",{className:"bd-loading"},O.createElement("div",{className:"bd-spinner"},O.createElement("div",{className:"bd-cube1"}),O.createElement("div",{className:"bd-cube2"})))}get pagination(){return O.createElement("div",{className:"bd-pagination"},O.createElement("button",{type:"button",className:"bd-button bd-pagination-previous",disabled:!this.hasPrevious,onClick:this.loadPreviousPage},O.createElement(Wt,null)),O.createElement("span",{className:"bd-pagination-info"},A.PublicServers.pagination.format({page:this.state.results.page,count:this.state.results.numPages})),O.createElement("button",{type:"button",className:"bd-button bd-pagination-next",disabled:!this.hasNext,onClick:this.loadNextPage},O.createElement(Vt,null)))}get connection(){const{user:e}=this.state;return e?O.createElement("div",{id:"bd-connection"},O.createElement("div",{className:"bd-footnote"},A.PublicServers.connection.format(e)),O.createElement("button",{type:"button",className:"bd-button bd-button-reconnect",onClick:this.connect},A.PublicServers.reconnect)):O.createElement("div",{id:"bd-connection"})}render(){const e=this.keywords.map(e=>({section:e,label:e,element:()=>this.content}));return O.createElement(Yt,{onClose:this.props.close,onSetSection:this.changeTab,section:this.state.tab,sections:[{section:"HEADER",label:A.PublicServers.search},{section:"CUSTOM",element:()=>this.searchBox},{section:"DIVIDER"},{section:"HEADER",label:A.PublicServers.categories},{section:"All",label:"All",element:()=>this.content},{section:"Featured",label:"Featured",element:()=>this.content},{section:"Popular",label:"Popular",element:()=>this.content},{section:"DIVIDER"},{section:"HEADER",label:A.PublicServers.keywords},...e,{section:"DIVIDER"},{section:"HEADER",label:O.createElement("a",{href:"https://discordservers.com",target:"_blank"},"DiscordServers.com")},{section:"DIVIDER"},{section:"CUSTOM",element:()=>this.connection}],theme:"dark"})}}const Kt=g.getByProps("pushLayer");var es=new class extends ht{get name(){return"PublicServers"}get category(){return"general"}get id(){return"publicServers"}enabled(){const e=g.find(e=>e.default&&"NavigableGuilds"==e.default.displayName),t=g.findByDisplayName("Guilds");e||t||this.warn("Can't find GuildList component"),this.guildPatch=this.after(e||t.prototype,e?"default":"render",this._appendButton),this._appendButton()}disabled(){this.unpatchAll(),h.query("#bd-pub-li").remove()}_appendButton(){const e=f.GuildClasses.wrapper.split(" ")[0],t=h.query(`.${e} .scroller-2TZvBN >:first-child`);h.after(t,this.button)}openPublicServers(){Kt.pushLayer(()=>f.React.createElement(Xt,{close:Kt.popLayer}))}get button(){const e=h.createElement(`<div id="bd-pub-li" class="${f.GuildClasses.listItem}">`),t=h.createElement(`<div id="bd-pub-button" class="${"wrapper-25eVIn "+f.GuildClasses.circleButtonMask}">${A.PublicServers.button}</div>`);return t.addEventListener("click",()=>{this.openPublicServers()}),e.append(t),e}},ts=new class extends ht{get name(){return"VoiceDisconnect"}get category(){return"general"}get id(){return"voiceDisconnect"}constructor(){super(),this.beforeUnload=this.beforeUnload.bind(this)}enabled(){window.addEventListener("beforeunload",this.beforeUnload)}disabled(){window.removeEventListener("beforeunload",this.beforeUnload)}beforeUnload(){f.ChannelActions.selectVoiceChannel(null,null)}},ss=new class extends ht{get name(){return"24Hour"}get category(){return"appearance"}get id(){return"twentyFourHour"}enabled(){this.inject24Hour()}disabled(){this.unpatchAll()}inject24Hour(){const e=new RegExp("([0-9]{1,2}):([0-9]{1,2})\\s(AM|PM)"),t=(t,s,n)=>{const i=n.match(e);if(i&&4===i.length)return"AM"===i[3]?n.replace(i[0],`${"12"===i[1]?"00":i[1].padStart(2,"0")}:${i[2]}`):n.replace(i[0],`${"12"===i[1]?"12":parseInt(i[1])+12}:${i[2]}`)};this.after(f.TimeFormatter,"calendarFormat",t),this.after(f.TimeFormatter,"dateFormat",t)}},ns=new class extends ht{get name(){return"ColoredText"}get category(){return"appearance"}get id(){return"coloredText"}enabled(){this.injectColoredText()}disabled(){this.removeColoredText(),this.unpatchAll()}injectColoredText(){const e=g.getModule(e=>e.default&&e.default.displayName&&"Message"==e.default.displayName);this.before(e,"default",(e,[t])=>{if(!t||!t.childrenMessageContent)return;const s=t.childrenMessageContent;if(!s.type||!s.type.type||"MessageContent"!=s.type.type.displayName)return;const n=s.type.type;n.__originalMethod||(s.type.type=function(e){const t=n(e),s=e.message.colorString||"";return t.props.style={color:s},t},s.type.type.__originalMethod=n,Object.assign(s.type.type,n))})}removeColoredText(){document.querySelectorAll(".markup-2BOw-j").forEach(e=>{e.style.setProperty("color","")})}},is=new class extends ht{get name(){return"DarkMode"}get category(){return"appearance"}get id(){return"darkMode"}enabled(){document.getElementById("app-mount").classList.add("bda-dark","bd-dark")}disabled(){document.getElementById("app-mount").classList.remove("bda-dark","bd-dark")}},rs=new class extends ht{get name(){return"HideGIFButton"}get category(){return"appearance"}get id(){return"hideGIFButton"}enabled(){this.after(g.find(e=>e.type&&e.type.render&&"ChannelTextAreaContainer"===e.type.render.displayName).type,"render",(e,t,s)=>{const n=p.getNestedProp(s,"props.children.props.children.props.children.1.props.children.props.children.2.props.children");if(Array.isArray(n))for(const e of n){if(!e)continue;const t=p.getNestedProp(e,"type.type.render");if(t&&"ChannelGIFPickerButton"===t.displayName){e.props.disabled=!0;break}}})}disabled(){this.unpatchAll()}},os=new class extends ht{get name(){return"HideGiftButton"}get category(){return"appearance"}get id(){return"hideGiftButton"}enabled(){this.after(g.find(e=>e.type&&e.type.render&&"ChannelTextAreaContainer"===e.type.render.displayName).type,"render",(e,t,s)=>{const n=p.getNestedProp(s,"props.children.props.children.props.children.1.props.children.props.children.2.props.children");if(Array.isArray(n))for(const e of n)if(e&&e.props&&e.props.hasOwnProperty("shouldRenderPremiumGiftButton")){e.props.shouldRenderPremiumGiftButton=!1,e.props.disabled=!0;break}})}disabled(){this.unpatchAll()}},as=new class extends ht{get name(){return"MinimalMode"}get category(){return"appearance"}get id(){return"minimalMode"}get hideChannelsID(){return"hideChannels"}get hideChannels(){return this.get(this.hideChannelsID)}constructor(){super(),this.enableHideChannels=this.enableHideChannels.bind(this),this.disableHideChannels=this.disableHideChannels.bind(this)}enabled(){document.body.classList.add("bd-minimal"),this.hideChannels&&this.enableHideChannels(),this.hideChannelCancel=this.registerSetting(this.hideChannelsID,this.enableHideChannels,this.disableHideChannels)}disabled(){document.body.classList.remove("bd-minimal"),this.hideChannels&&this.disableHideChannels(),this.hideChannelCancel&&this.hideChannelCancel()}enableHideChannels(){document.body.classList.add("bd-minimal-chan")}disableHideChannels(){document.body.classList.remove("bd-minimal-chan")}},ls=new class extends ht{get name(){return"VoiceMode"}get category(){return"appearance"}get id(){return"voiceMode"}enabled(){document.querySelector(".chat-3bRxxu").style.setProperty("visibility","hidden"),document.querySelector(".chat-3bRxxu").style.setProperty("min-width","0px"),document.querySelector(".channels-Ie2l6A").style.setProperty("flex-grow","100000")}disabled(){document.querySelector(".chat-3bRxxu").style.setProperty("visibility",""),document.querySelector(".chat-3bRxxu").style.setProperty("min-width",""),document.querySelector(".channels-Ie2l6A").style.setProperty("flex-grow","")}};const ds=g.getByDisplayName("VerticalScroller");class cs extends O.Component{render(){return O.createElement("div",{className:`bd-qem-${this.props.type}-container`},O.createElement(ds,{className:"bd-em-scroller"},O.createElement("div",{className:"emote-menu-inner"},this.props.children)))}}const hs=g.getByProps("openContextMenu"),{MenuItem:ps,MenuGroup:us}=g.find(e=>e.MenuRadioItem&&!e.default),ms=g.getByProps("default","MenuStyle").default,{ComponentDispatch:gs}=g.getByProps("ComponentDispatch");class fs extends O.Component{render(){return O.createElement("div",{className:"emote-container",onClick:this.handleOnClick.bind(this),onContextMenu:this.handleOnContextMenu.bind(this)},O.createElement("img",{src:this.props.url,alt:this.props.emote,title:this.props.emote}))}handleOnClick(){this.insertText(this.props.emote)}handleOnContextMenu(e){hs.openContextMenu(e,()=>O.createElement(ms,{navId:"EmoteContextMenu",onClose:hs.closeContextMenu},O.createElement(us,null,O.createElement(ps,{label:wt.isFavorite(this.props.emote)?"Remove Favorite":"Add Favorite",id:"favorite",action:this.handlefavorite.bind(this),onClose:hs.closeContextMenu}))))}handlefavorite(){hs.closeContextMenu(),wt.isFavorite(this.props.emote)?wt.removeFavorite(this.props.emote):wt.addFavorite(this.props.emote,this.props.url)}insertText(e){gs.dispatchToLastSubscribed("INSERT_TEXT",{content:e})}}var ys=[{id:"twitchEmotes",label:"Twitch Emotes",element:()=>O.createElement(cs,{type:"twitch"},Object.keys(wt.getCategory("TwitchGlobal")).map(e=>{const t=wt.getUrl("TwitchGlobal",e);return O.createElement(fs,{emote:e,url:t})}))},{id:"favoriteEmotes",label:"Favorite Emotes",element:()=>O.createElement(cs,{type:"favourite"},Object.entries(wt.favorites).map(([e,t])=>O.createElement(fs,{emote:e,url:t})))}];const bs=g.find(e=>e.type&&"ExpressionPicker"==e.type.displayName);var vs=new class extends ht{get name(){return"EmoteMenu"}get collection(){return"emotes"}get category(){return"general"}get id(){return"emoteMenu"}get hideEmojisID(){return"hideEmojiMenu"}get hideEmojis(){return this.get(this.hideEmojisID)}enabled(){this.before(bs,"type",(e,[t])=>{"emoji"==t.expressionPickerView&&this.hideEmojis&&(t.expressionPickerView="gif")}),this.after(bs,"type",(e,[t],s)=>{const n=p.getNestedProp(s,"props.children.props.children.props.children.1.props.children.0.props.children.props.children"),i=p.getNestedProp(s,"props.children.props.children.props.children.1.props.children");if(!n||!i)return s;const r=t.expressionPickerView,o=ys.find(e=>e.id===r),a=n[0].props;n.push(...ys.map(e=>O.createElement("div",{id:e.id+"-tab",role:"tab","aria-selected":r==e.id,className:a.className},O.createElement(a.children.type,{viewType:e.id,isActive:r==e.id,setActiveView:a.children.props.setActiveView},e.label)))),o&&(i[2]=o.element()),this.hideEmojis&&n.splice(n.findIndex(e=>e&&e.props&&"emoji-picker-tab"==e.props.id),1)})}disabled(){this.unpatchAll()}},ws=new class extends ht{get name(){return"DeveloperMode"}get category(){return"developer"}get id(){return"developerMode"}get selectorModeID(){return"copySelector"}get selectorMode(){return this.get(this.selectorModeID)}constructor(){super(),this.copySelectorListener=this.copySelectorListener.bind(this)}enabled(){document.addEventListener("contextmenu",this.copySelectorListener)}disabled(){document.removeEventListener("contextmenu",this.copySelectorListener)}copySelectorListener(e){e.stopPropagation();const t=this.getSelector(e.target);setImmediate((function(){let s=h.query(".contextMenu-HLZMGh");if(!s){const t=h.query("#app-mount"),n=h.createElement('<div class="layer-v9HyYc da-layer">');s=h.createElement('<div class="contextMenu-HLZMGh da-contextMenu bd-context-menu"></div>'),n.append(s),t.append(n),n.style.top=e.clientY+"px",n.style.left=e.clientX+"px",n.style.zIndex="1002";const i=function(e){e.keyCode&&27!==e.keyCode||(n.remove(),document.removeEventListener("click",i),document.removeEventListener("contextmenu",i),document.removeEventListener("keyup",i))};document.addEventListener("click",i),document.addEventListener("contextmenu",i),document.addEventListener("keyup",i)}const n=h.createElement('<div class="itemGroup-1tL0uz da-itemGroup">'),i=h.createElement('<div class="item-1Yvehc itemBase-tz5SeC da-item da-itemBase clickable-11uBi- da-clickable">');i.append(h.createElement(`<div class="label-JWQiNe da-label">${A.Developer.copySelector}</div>`)),i.addEventListener("click",()=>{f.ElectronModule.copy(t),s.style.display="none"}),n.append(i),s.append(n)}))}getSelector(e){if(e.id)return"#"+e.id;const t=this.getRules(e),s=t[t.length-1];return s?s.selectorText:e.classList.length?"."+Array.from(e.classList).join("."):"."+Array.from(e.parentElement.classList).join(".")}getRules(e,t=e.ownerDocument.styleSheets){return[...t].filter(e=>!e.href||!e.href.includes("BetterDiscordApp")).map(e=>[...e.cssRules||[]]).flat().filter(t=>t&&t.selectorText&&e.matches(t.selectorText)&&t.style.length&&t.selectorText.split(", ").length<8&&!t.selectorText.split(", ").includes("*"))}},Cs=new class extends ht{get name(){return"Debugger"}get category(){return"developer"}get id(){return"debuggerHotkey"}enabled(){document.addEventListener("keydown",this.debugListener)}disabled(){document.removeEventListener("keydown",this.debugListener)}debugListener(e){if(119===e.which||118==e.which){debugger;e.preventDefault(),e.stopImmediatePropagation()}}};const Ss=s(0),Es=s(2),Ps=s(1),xs=Ss.remote.BrowserWindow;var Ms=new class extends ht{get name(){return"ReactDevTools"}get category(){return"developer"}get id(){return"reactDevTools"}initialize(){super.initialize(),this.findExtension()}findExtension(){let e="";if(e="win32"===process.platform?Ps.resolve(process.env.LOCALAPPDATA,"Google/Chrome/User Data"):"linux"===process.platform?Ps.resolve(process.env.HOME,".config/google-chrome"):"darwin"===process.platform?Ps.resolve(process.env.HOME,"Library/Application Support/Google/Chrome"):Ps.resolve(process.env.HOME,".config/chromium"),e+="/Default/Extensions/fmkadmapgofadopljbjfkapdkoienihi/",Es.existsSync(e)){const t=Es.readdirSync(e);e=Ps.resolve(e,t[t.length-1])}this.extensionPath=e,this.isExtensionInstalled=Es.existsSync(e)}enabled(){if(this.isExtensionInstalled||this.findExtension(),!this.isExtensionInstalled)return G.alert(A.ReactDevTools.notFound,A.ReactDevTools.notFoundDetails);try{xs.addDevToolsExtension(this.extensionPath)?this.log("Successfully installed react devtools."):this.error("Couldn't find react devtools in chrome extensions!")}catch(e){this.error("Couldn't add the extension!")}}disabled(){this.isExtensionInstalled&&xs.removeDevToolsExtension("React Developer Tools")}};class ks extends O.Component{render(){return O.createElement("svg",{className:"bd-logo "+this.props.className,height:"100%",width:this.props.size||"16px",viewBox:"0 0 2000 2000"},O.createElement("g",null,O.createElement("path",{fill:"#3E82E5",d:"M1402.2,631.7c-9.7-353.4-286.2-496-642.6-496H68.4v714.1l442,398V490.7h257c274.5,0,274.5,344.9,0,344.9H597.6v329.5h169.8c274.5,0,274.5,344.8,0,344.8h-699v354.9h691.2c356.3,0,632.8-142.6,642.6-496c0-162.6-44.5-284.1-122.9-368.6C1357.7,915.8,1402.2,794.3,1402.2,631.7z"}),O.createElement("path",{fill:"#FFFFFF",d:"M1262.5,135.2L1262.5,135.2l-76.8,0c26.6,13.3,51.7,28.1,75,44.3c70.7,49.1,126.1,111.5,164.6,185.3c39.9,76.6,61.5,165.6,64.3,264.6l0,1.2v1.2c0,141.1,0,596.1,0,737.1v1.2l0,1.2c-2.7,99-24.3,188-64.3,264.6c-38.5,73.8-93.8,136.2-164.6,185.3c-22.6,15.7-46.9,30.1-72.6,43.1h72.5c346.2,1.9,671-171.2,671-567.9V716.7C1933.5,312.2,1608.7,135.2,1262.5,135.2z"})))}}const Ds=f.React,Ns=g.getByDisplayName("Tooltip");var As=new class{initialize(){p.suppressErrors(this.patchSocial.bind(this),"BD Social Patch")(),p.suppressErrors(this.patchGuildPills.bind(this),"BD Guild Pills Patch")(),p.suppressErrors(this.patchGuildListItems.bind(this),"BD Guild List Items Patch")(),p.suppressErrors(this.patchGuildSeparator.bind(this),"BD Guild Separator Patch")(),p.suppressErrors(this.patchMessageHeader.bind(this),"BD Message Header Patch")(),p.suppressErrors(this.patchMemberList.bind(this),"BD Member List Patch")()}patchSocial(){if(this.socialPatch)return;const e=g.getByDisplayName("TabBar"),t=g.getByDisplayName("Anchor");e&&(this.socialPatch=B.after("ComponentPatcher",e.prototype,"render",(e,s,n)=>{const r=n.props.children;if(!r||!r.length||r.length<3)return;if("Separator"!==r[r.length-3].type.displayName)return;if(!r[r.length-2].type.toString().includes("socialLinks"))return;if(t){const e=r[r.length-2].type,s=function(){const s=e(...arguments);return s.props.children.push(f.React.createElement(t,{className:"bd-social-link",href:"https://twitter.com/BandagedBD",title:"BetterDiscord",target:"_blank"},f.React.createElement(ks,{size:"16px",className:"bd-social-logo"}))),s};r[r.length-2].type=s}const o=f.React.createElement("div",{className:"colorMuted-HdFt4q size12-3cLvbJ"},"Injector "+i.version),a=`(${i.hash?i.hash.substring(0,7):i.branch})`,l=f.React.createElement("div",{className:"colorMuted-HdFt4q size12-3cLvbJ"},`BD ${i.bdVersion} `,f.React.createElement("span",{className:"versionHash-2gXjIB da-versionHash"},a)),d=r[r.length-1].type;r[r.length-1].type=function(){const e=d(...arguments);return e.props.children.splice(e.props.children.length-1,0,o),e.props.children.splice(1,0,l),e}}))}patchGuildListItems(){if(this.guildListItemsPatch)return;const e=f.GuildClasses.listItem.split(" ")[0],t=f.GuildClasses.blobContainer.split(" ")[0],s=p.getReactInstance(document.querySelector(`.${e} .${t}`).parentElement).return.type;s&&(this.guildListItemsPatch=B.after("ComponentPatcher",s.prototype,"render",(e,t,s)=>{if(!s||!e)return;const n=e.props;return s.props.className+=" bd-guild",n.unread&&(s.props.className+=" bd-unread"),n.selected&&(s.props.className+=" bd-selected"),n.audio&&(s.props.className+=" bd-audio"),n.video&&(s.props.className+=" bd-video"),n.badge&&(s.props.className+=" bd-badge"),n.animatable&&(s.props.className+=" bd-animatable"),s}))}patchGuildPills(){if(this.guildPillPatch)return;const e=g.getModule(e=>e.default&&!e.default.displayName&&e.default.toString&&e.default.toString().includes("translate3d"));e&&(this.guildPillPatch=B.after("ComponentPatcher",e,"default",(e,t,s)=>{const n=t[0];return n.unread&&(s.props.className+=" bd-unread"),n.selected&&(s.props.className+=" bd-selected"),n.hovered&&(s.props.className+=" bd-hovered"),s}))}patchGuildSeparator(){if(this.guildSeparatorPatch)return;const e=g.getByDisplayName("Guilds"),t=g.getByProps("renderListItem");if(!t||!e)return;const s=function(){const e=t.Separator(...arguments);return e.props.className+=" bd-guild-separator",e};this.guildSeparatorPatch=B.after("ComponentPatcher",e.prototype,"render",(e,t,n)=>{const i=p.findInReactTree(n,e=>e.type&&!e.type.displayName&&"function"==typeof e.type&&p.isEmpty(e.props));i&&(i.type=s)})}patchMessageHeader(){if(this.messageHeaderPatch)return;const e=g.getByProps("MessageTimestamp"),t=g.find(e=>"Anchor"==e.displayName);t&&e&&e.default&&(this.messageHeaderPatch=B.after("ComponentPatcher",e,"default",(e,s,n)=>{const i=p.getNestedProp(s[0],"message.author"),r=p.getNestedProp(n,"props.children.1.props.children.1.props.children");r&&i&&i.id&&"249746236008169473"===i.id&&Array.isArray(r)&&r.push(Ds.createElement(Ns,{color:"black",position:"top",text:"BetterDiscord Developer"},e=>Ds.createElement(t,Object.assign({className:"bd-chat-badge",href:"https://github.com/rauenzi/BetterDiscordApp",title:"BetterDiscord",target:"_blank"},e),Ds.createElement(ks,{size:"16px",className:"bd-logo"}))))}))}patchMemberList(){if(this.memberListPatch)return;const e=g.findByDisplayName("MemberListItem"),t=g.find(e=>"Anchor"==e.displayName);t&&e&&e.prototype&&e.prototype.renderDecorators&&(this.memberListPatch=B.after("ComponentPatcher",e.prototype,"renderDecorators",(e,s,n)=>{const i=p.getNestedProp(e,"props.user"),r=p.getNestedProp(n,"props.children");r&&i&&i.id&&"249746236008169473"===i.id&&Array.isArray(r)&&r.push(Ds.createElement(Ns,{color:"black",position:"top",text:"BetterDiscord Developer"},e=>Ds.createElement(t,Object.assign({className:"bd-member-badge",href:"https://github.com/rauenzi/BetterDiscordApp",title:"BetterDiscord",target:"_blank"},e),Ds.createElement(ks,{size:"16px",className:"bd-logo"}))))}))}};const Ls=s(2),Bs=s(1),{ipcRenderer:Ts}=s(0),js=f.GuildClasses;var Fs=new class{startup(){Ts.invoke("bd-config","get").then(e=>{this.hasStarted||(Object.assign(i,e),this.init())}),Ts.invoke("bd-injector-info").then(e=>{i.version=e.version,this.checkInjectorUpdate()})}get dependencies(){return[{name:"jquery",type:"script",url:"https://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js",backup:"https://cdn.jsdelivr.net/gh/jquery/jquery@2.0.0/jquery.min.js"},{name:"bd-stylesheet",type:"style",url:"//cdn.staticaly.com/gh/rauenzi/BetterDiscordApp/{{hash}}/dist/style.css",backup:"https://rauenzi.github.io/BetterDiscordApp/dist/style.css",localPath:"style.css"}]}setConfig(e){this.hasStarted||Object.assign(i,e)}async init(){if(this.hasStarted)return;this.hasStarted=!0;let e=new Promise(e=>e());if(window.$&&window.jQuery||(e=this.loadDependencies()),w.initialize(),await D.initialize(),i.version<i.minSupportedVersion)return G.alert(A.Startup.notSupported,A.Startup.versionMismatch.format({injector:i.version,remote:i.bdVersion}));if(window.ED)return G.alert(A.Startup.notSupported,A.Startup.incompatibleApp.format({app:"EnhancedDiscord"}));if(window.WebSocket&&window.WebSocket.name&&window.WebSocket.name.includes("Patched"))return G.alert(A.Startup.notSupported,A.Startup.incompatibleApp.format({app:"Powercord"}));c.log("Startup","Initializing Settings"),L.initialize(),await this.waitForGuilds(),I.initialize(),As.initialize();for(const e in n)n[e].initialize();await e,c.log("Startup","Loading Plugins");const t=lt.initialize();c.log("Startup","Loading Themes");const s=ct.initialize();c.log("Startup","Removing Loading Icon"),Mt.hide(),c.log("Startup","Collecting Startup Errors"),G.showAddonErrors({plugins:t,themes:s});const r=w.getBDData("version");i.bdVersion>r&&(G.showChangelogModal(l),w.setBDData("version",i.bdVersion))}waitForGuilds(){let e=0;return new Promise(t=>{const s=function(){e++,"complete"!=document.readyState&&setTimeout(s,100);const n=js.wrapper.split(" ")[0],r=js.listItem.split(" ")[0],o=js.blobContainer.split(" ")[0];return document.querySelectorAll(`.${n} .${r} .${o}`).length>0||e>=50?t(i.deferLoaded=!0):void setTimeout(s,100)};s()})}async loadDependencies(){for(const e of this.dependencies){if(i.local&&i.localPath&&e.localPath&&Ls.existsSync(Bs.resolve(i.localPath,e.localPath))){const t=Ls.readFileSync(Bs.resolve(i.localPath,e.localPath)).toString();C.injectStyle(e.name,t);continue}const t=p.formatString(e.url,{hash:i.hash});c.log("Startup",`Loading Resource (${t})`);const s=("script"==e.type?C.injectScript:C.linkStyle).bind(C);try{await s(e.name,t)}catch(n){const i=p.formatString(e.backup);c.stacktrace("Startup",`Could not load ${t}. Using backup ${i}`,n);try{await s(e.name,i)}catch(s){c.stacktrace("Startup",`Could not load ${t}. Using backup ${i}`,n),"jquery"===e.name&&G.alert(A.Startup.jqueryFailed,A.Startup.jqueryFailedDetails)}}}}async checkInjectorUpdate(){const e=s(3),t=await new Promise(t=>{e.get({url:"https://gitcdn.xyz/repo/rauenzi/BetterDiscordApp/injector/package.json",json:!0},(e,s,n)=>{let i="0.6.1";return e||200!=s.statusCode||(i=n.version||i),t(i)})});t>i.version&&G.showConfirmationModal(A.Startup.updateAvailable,A.Startup.updateInfo.format({version:t}),{confirmText:A.Startup.updateNow,cancelText:A.Startup.maybeLater,onConfirm:async()=>{const e=()=>{G.alert(A.Startup.updateFailed,A.Startup.manualUpdate)};try{if(!await this.updateInjector())return e();const t=s(0).remote.app;t.relaunch(),t.exit()}catch(t){e()}}})}async updateInjector(){const e=w.injectionPath;if(!e)return!1;const t=s(6),n=s(7),i=s(8),r=s(3),o=Bs.resolve(e,".."),a=Bs.basename(e),l="https://github.com/rauenzi/BetterDiscordApp/archive/injector.zip",d=Bs.resolve(o,"injector.zip"),h=Bs.resolve(o,"BetterDiscordApp-injector");c.log("InjectorUpdate","Downloading "+l);let p=await new Promise(e=>{r.get({url:l,encoding:null},async(t,s,n)=>{if(t||200!==s.statusCode)return e(!1);await new Promise(e=>Ls.exists(d,e))&&await new Promise(e=>Ls.rename(d,`${d}.bak${Math.round(performance.now())}`,e)),c.log("InjectorUpdate","Writing "+d),Ls.writeFile(d,n,t=>e(!t))})});if(!p)return p;await new Promise(e=>Ls.exists(h,e))&&await new Promise(e=>Ls.rename(h,`${h}.bak${Math.round(performance.now())}`,e));const u=await new Promise((e,t)=>n.open(d,{lazyEntries:!0},(s,n)=>{if(s)return t(s);e(n)}));u.on("entry",(function(e){if(e.fileName.endsWith("/"))return u.readEntry();c.log("InjectorUpdate","Extracting "+e.fileName);const t=Bs.resolve(o,e.fileName);i.sync(Bs.dirname(t)),u.openReadStream(e,(function(e,s){if(e)return p=!1;s.on("end",(function(){u.readEntry()})),s.pipe(Ls.createWriteStream(t))}))})),u.readEntry(),await new Promise(e=>u.once("end",e));const m=Bs.resolve(o,`${a}.bak${Math.round(performance.now())}`);return await new Promise(t=>Ls.rename(e,m,t)),c.log("InjectorUpdate",`Renaming ${Bs.basename(h)} to ${a}`),p=await new Promise(t=>Ls.rename(h,e,e=>t(!e))),p?p?(await new Promise(e=>t(m,e)),await new Promise(e=>Ls.unlink(d,e)),c.log("InjectorUpdate","Injector Updated!"),p):(c.err("InjectorUpdate","Something went wrong... restoring backups."),await new Promise(e=>t(h,e)),await new Promise(t=>Ls.rename(m,e,t)),p):(c.err("InjectorUpdate","Failed to rename the final directory"),p)}};!function(){const e=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,"contentWindow").get;Object.defineProperty(HTMLIFrameElement.prototype,"contentWindow",{get:function(){const t=Reflect.apply(e,this,arguments);return new Proxy(t,{getOwnPropertyDescriptor:function(e,t){if("localStorage"!==t)return Object.getOwnPropertyDescriptor(e,t)},get:function(e,t){if("localStorage"===t)return null;const s=e[t];return"function"==typeof s?s.bind(e):s}})}}),Object.defineProperty(Reflect,"apply",{value:Reflect.apply,writable:!1,configurable:!1}),Object.defineProperty(Function.prototype,"bind",{value:Function.prototype.bind,writable:!1,configurable:!1});const t=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){const e=arguments[1];return e.toLowerCase().includes("api/webhooks")?null:Reflect.apply(t,this,arguments)}}(),function(){const e="betterdiscord/",t=s(4),n=t._load;t._load=function(t){if("betterdiscord"===t||t.startsWith(e)){if("bdapi"==t.substr(e.length))return Et}return n.apply(this,arguments)}}(),window.BdApi=Et,Mt.show(),Fs.startup()}]);